{"ast":null,"code":"import \"core-js/modules/es.string.replace\";\n\nfunction _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  }\n\n  return _assertThisInitialized(self);\n}\n\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nfunction _get(target, property, receiver) {\n  if (typeof Reflect !== \"undefined\" && Reflect.get) {\n    _get = Reflect.get;\n  } else {\n    _get = function _get(target, property, receiver) {\n      var base = _superPropBase(target, property);\n\n      if (!base) return;\n      var desc = Object.getOwnPropertyDescriptor(base, property);\n\n      if (desc.get) {\n        return desc.get.call(receiver);\n      }\n\n      return desc.value;\n    };\n  }\n\n  return _get(target, property, receiver || target);\n}\n\nfunction _superPropBase(object, property) {\n  while (!Object.prototype.hasOwnProperty.call(object, property)) {\n    object = _getPrototypeOf(object);\n    if (object === null) break;\n  }\n\n  return object;\n}\n\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) _setPrototypeOf(subClass, superClass);\n}\n\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nimport { KEY_CODES, isPrintableChar } from './../helpers/unicode';\nimport { stringify, isDefined } from './../helpers/mixed';\nimport { stripTags } from './../helpers/string';\nimport { pivot, arrayMap } from './../helpers/array';\nimport { addClass, getCaretPosition, getScrollbarWidth, getSelectionEndPosition, outerWidth, outerHeight, offset, getTrimmingContainer, setCaretPosition } from './../helpers/dom/element';\nimport HandsontableEditor from './handsontableEditor';\nvar privatePool = new WeakMap();\n/**\n * @private\n * @editor AutocompleteEditor\n * @class AutocompleteEditor\n * @dependencies HandsontableEditor\n */\n\nvar AutocompleteEditor = /*#__PURE__*/function (_HandsontableEditor) {\n  _inherits(AutocompleteEditor, _HandsontableEditor);\n\n  function AutocompleteEditor(instance) {\n    var _this;\n\n    _classCallCheck(this, AutocompleteEditor);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(AutocompleteEditor).call(this, instance));\n    /**\n     * Query string to turn available values over.\n     *\n     * @type {String}\n     */\n\n    _this.query = null;\n    /**\n     * Contains stripped choices.\n     *\n     * @type {String[]}\n     */\n\n    _this.strippedChoices = [];\n    /**\n     * Contains raw choices.\n     *\n     * @type {Array}\n     */\n\n    _this.rawChoices = [];\n    privatePool.set(_assertThisInitialized(_this), {\n      skipOne: false\n    });\n    return _this;\n  }\n  /**\n   * Gets current value from editable element.\n   *\n   * @returns {String}\n   */\n\n\n  _createClass(AutocompleteEditor, [{\n    key: \"getValue\",\n    value: function getValue() {\n      var _this2 = this;\n\n      var selectedValue = this.rawChoices.find(function (value) {\n        var strippedValue = _this2.stripValueIfNeeded(value);\n\n        return strippedValue === _this2.TEXTAREA.value;\n      });\n\n      if (isDefined(selectedValue)) {\n        return selectedValue;\n      }\n\n      return this.TEXTAREA.value;\n    }\n    /**\n     * Creates an editor's elements and adds necessary CSS classnames.\n     */\n\n  }, {\n    key: \"createElements\",\n    value: function createElements() {\n      _get(_getPrototypeOf(AutocompleteEditor.prototype), \"createElements\", this).call(this);\n\n      addClass(this.htContainer, 'autocompleteEditor');\n      addClass(this.htContainer, this.hot.rootWindow.navigator.platform.indexOf('Mac') === -1 ? '' : 'htMacScroll');\n    }\n    /**\n     * Opens the editor and adjust its size and internal Handsontable's instance.\n     */\n\n  }, {\n    key: \"open\",\n    value: function open() {\n      var _this3 = this;\n\n      var priv = privatePool.get(this); // this.addHook('beforeKeyDown', event => this.onBeforeKeyDown(event));\n      // Ugly fix for handsontable which grab window object for autocomplete scroll listener instead table element.\n\n      this.TEXTAREA_PARENT.style.overflow = 'auto';\n\n      _get(_getPrototypeOf(AutocompleteEditor.prototype), \"open\", this).call(this);\n\n      this.TEXTAREA_PARENT.style.overflow = '';\n      var choicesListHot = this.htEditor.getInstance();\n      var trimDropdown = this.cellProperties.trimDropdown === void 0 ? true : this.cellProperties.trimDropdown;\n      this.showEditableElement();\n      this.focus();\n      var scrollbarWidth = getScrollbarWidth(this.hot.rootDocument);\n      choicesListHot.updateSettings({\n        colWidths: trimDropdown ? [outerWidth(this.TEXTAREA) - 2] : void 0,\n        width: trimDropdown ? outerWidth(this.TEXTAREA) + scrollbarWidth + 2 : void 0,\n        afterRenderer: function afterRenderer(TD, row, col, prop, value) {\n          var _this3$cellProperties = _this3.cellProperties,\n              filteringCaseSensitive = _this3$cellProperties.filteringCaseSensitive,\n              allowHtml = _this3$cellProperties.allowHtml;\n          var query = _this3.query;\n          var cellValue = stringify(value);\n          var indexOfMatch;\n          var match;\n\n          if (cellValue && !allowHtml) {\n            indexOfMatch = filteringCaseSensitive === true ? cellValue.indexOf(query) : cellValue.toLowerCase().indexOf(query.toLowerCase());\n\n            if (indexOfMatch !== -1) {\n              match = cellValue.substr(indexOfMatch, query.length);\n              cellValue = cellValue.replace(match, \"<strong>\".concat(match, \"</strong>\"));\n            }\n          }\n\n          TD.innerHTML = cellValue;\n        },\n        autoColumnSize: true,\n        modifyColWidth: function modifyColWidth(width, col) {\n          // workaround for <strong> text overlapping the dropdown, not really accurate\n          var autoColumnSize = this.getPlugin('autoColumnSize');\n          var columnWidth = width;\n\n          if (autoColumnSize) {\n            var autoWidths = autoColumnSize.widths;\n\n            if (autoWidths[col]) {\n              columnWidth = autoWidths[col];\n            }\n          }\n\n          return trimDropdown ? columnWidth : columnWidth + 15;\n        }\n      }); // Add additional space for autocomplete holder\n\n      this.htEditor.view.wt.wtTable.holder.parentNode.style['padding-right'] = \"\".concat(scrollbarWidth + 2, \"px\");\n\n      if (priv.skipOne) {\n        priv.skipOne = false;\n      }\n\n      this.hot._registerTimeout(function () {\n        _this3.queryChoices(_this3.TEXTAREA.value);\n      });\n    }\n    /**\n     * Closes the editor.\n     */\n\n  }, {\n    key: \"close\",\n    value: function close() {\n      this.removeHooksByKey('beforeKeyDown');\n\n      _get(_getPrototypeOf(AutocompleteEditor.prototype), \"close\", this).call(this);\n    }\n    /**\n     * Verifies result of validation or closes editor if user's cancelled changes. Re-renders WalkOnTable.\n     *\n     * @param {Boolean|undefined} result\n     */\n\n  }, {\n    key: \"discardEditor\",\n    value: function discardEditor(result) {\n      _get(_getPrototypeOf(AutocompleteEditor.prototype), \"discardEditor\", this).call(this, result);\n\n      this.hot.view.render();\n    }\n    /**\n     * Prepares choices list based on applied argument.\n     *\n     * @private\n     * @param {String} query\n     */\n\n  }, {\n    key: \"queryChoices\",\n    value: function queryChoices(query) {\n      var _this4 = this;\n\n      var source = this.cellProperties.source;\n      this.query = query;\n\n      if (typeof source === 'function') {\n        source.call(this.cellProperties, query, function (choices) {\n          _this4.rawChoices = choices;\n\n          _this4.updateChoicesList(_this4.stripValuesIfNeeded(choices));\n        });\n      } else if (Array.isArray(source)) {\n        this.rawChoices = source;\n        this.updateChoicesList(this.stripValuesIfNeeded(source));\n      } else {\n        this.updateChoicesList([]);\n      }\n    }\n    /**\n     * Updates list of the possible completions to choose.\n     *\n     * @private\n     * @param {Array} choicesList\n     */\n\n  }, {\n    key: \"updateChoicesList\",\n    value: function updateChoicesList(choicesList) {\n      var pos = getCaretPosition(this.TEXTAREA);\n      var endPos = getSelectionEndPosition(this.TEXTAREA);\n      var sortByRelevanceSetting = this.cellProperties.sortByRelevance;\n      var filterSetting = this.cellProperties.filter;\n      var orderByRelevance = null;\n      var highlightIndex = null;\n      var choices = choicesList;\n\n      if (sortByRelevanceSetting) {\n        orderByRelevance = AutocompleteEditor.sortByRelevance(this.stripValueIfNeeded(this.getValue()), choices, this.cellProperties.filteringCaseSensitive);\n      }\n\n      var orderByRelevanceLength = Array.isArray(orderByRelevance) ? orderByRelevance.length : 0;\n\n      if (filterSetting === false) {\n        if (orderByRelevanceLength) {\n          highlightIndex = orderByRelevance[0];\n        }\n      } else {\n        var sorted = [];\n\n        for (var i = 0, choicesCount = choices.length; i < choicesCount; i++) {\n          if (sortByRelevanceSetting && orderByRelevanceLength <= i) {\n            break;\n          }\n\n          if (orderByRelevanceLength) {\n            sorted.push(choices[orderByRelevance[i]]);\n          } else {\n            sorted.push(choices[i]);\n          }\n        }\n\n        highlightIndex = 0;\n        choices = sorted;\n      }\n\n      this.strippedChoices = choices;\n      this.htEditor.loadData(pivot([choices]));\n      this.updateDropdownHeight();\n      this.flipDropdownIfNeeded();\n\n      if (this.cellProperties.strict === true) {\n        this.highlightBestMatchingChoice(highlightIndex);\n      }\n\n      this.hot.listen(false);\n      setCaretPosition(this.TEXTAREA, pos, pos === endPos ? void 0 : endPos);\n    }\n    /**\n     * Checks where is enough place to open editor.\n     *\n     * @private\n     * @returns {Boolean}\n     */\n\n  }, {\n    key: \"flipDropdownIfNeeded\",\n    value: function flipDropdownIfNeeded() {\n      var textareaOffset = offset(this.TEXTAREA);\n      var textareaHeight = outerHeight(this.TEXTAREA);\n      var dropdownHeight = this.getDropdownHeight();\n      var trimmingContainer = getTrimmingContainer(this.hot.view.wt.wtTable.TABLE);\n      var trimmingContainerScrollTop = trimmingContainer.scrollTop;\n      var headersHeight = outerHeight(this.hot.view.wt.wtTable.THEAD);\n      var containerOffset = {\n        row: 0,\n        col: 0\n      };\n\n      if (trimmingContainer !== this.hot.rootWindow) {\n        containerOffset = offset(trimmingContainer);\n      }\n\n      var spaceAbove = textareaOffset.top - containerOffset.top - headersHeight + trimmingContainerScrollTop;\n      var spaceBelow = trimmingContainer.scrollHeight - spaceAbove - headersHeight - textareaHeight;\n      var flipNeeded = dropdownHeight > spaceBelow && spaceAbove > spaceBelow;\n\n      if (flipNeeded) {\n        this.flipDropdown(dropdownHeight);\n      } else {\n        this.unflipDropdown();\n      }\n\n      this.limitDropdownIfNeeded(flipNeeded ? spaceAbove : spaceBelow, dropdownHeight);\n      return flipNeeded;\n    }\n    /**\n     * Checks if the internal table should generate scrollbar or could be rendered without it.\n     *\n     * @private\n     * @param {Number} spaceAvailable\n     * @param {Number} dropdownHeight\n     */\n\n  }, {\n    key: \"limitDropdownIfNeeded\",\n    value: function limitDropdownIfNeeded(spaceAvailable, dropdownHeight) {\n      if (dropdownHeight > spaceAvailable) {\n        var tempHeight = 0;\n        var i = 0;\n        var lastRowHeight = 0;\n        var height = null;\n\n        do {\n          lastRowHeight = this.htEditor.getRowHeight(i) || this.htEditor.view.wt.wtSettings.settings.defaultRowHeight;\n          tempHeight += lastRowHeight;\n          i += 1;\n        } while (tempHeight < spaceAvailable);\n\n        height = tempHeight - lastRowHeight;\n\n        if (this.htEditor.flipped) {\n          this.htEditor.rootElement.style.top = \"\".concat(parseInt(this.htEditor.rootElement.style.top, 10) + dropdownHeight - height, \"px\");\n        }\n\n        this.setDropdownHeight(tempHeight - lastRowHeight);\n      }\n    }\n    /**\n     * Configures editor to open it at the top.\n     *\n     * @private\n     * @param {Number} dropdownHeight\n     */\n\n  }, {\n    key: \"flipDropdown\",\n    value: function flipDropdown(dropdownHeight) {\n      var dropdownStyle = this.htEditor.rootElement.style;\n      dropdownStyle.position = 'absolute';\n      dropdownStyle.top = \"\".concat(-dropdownHeight, \"px\");\n      this.htEditor.flipped = true;\n    }\n    /**\n     * Configures editor to open it at the bottom.\n     *\n     * @private\n     */\n\n  }, {\n    key: \"unflipDropdown\",\n    value: function unflipDropdown() {\n      var dropdownStyle = this.htEditor.rootElement.style;\n\n      if (dropdownStyle.position === 'absolute') {\n        dropdownStyle.position = '';\n        dropdownStyle.top = '';\n      }\n\n      this.htEditor.flipped = void 0;\n    }\n    /**\n     * Updates width and height of the internal Handsontable's instance.\n     *\n     * @private\n     */\n\n  }, {\n    key: \"updateDropdownHeight\",\n    value: function updateDropdownHeight() {\n      var currentDropdownWidth = this.htEditor.getColWidth(0) + getScrollbarWidth(this.hot.rootDocument) + 2;\n      var trimDropdown = this.cellProperties.trimDropdown;\n      this.htEditor.updateSettings({\n        height: this.getDropdownHeight(),\n        width: trimDropdown ? void 0 : currentDropdownWidth\n      });\n      this.htEditor.view.wt.wtTable.alignOverlaysWithTrimmingContainer();\n    }\n    /**\n     * Sets new height of the internal Handsontable's instance.\n     *\n     * @private\n     * @param {Number} height\n     */\n\n  }, {\n    key: \"setDropdownHeight\",\n    value: function setDropdownHeight(height) {\n      this.htEditor.updateSettings({\n        height: height\n      });\n    }\n    /**\n     * Creates new selection on specified row index, or deselects selected cells.\n     *\n     * @private\n     * @param {Number|undefined} index\n     */\n\n  }, {\n    key: \"highlightBestMatchingChoice\",\n    value: function highlightBestMatchingChoice(index) {\n      if (typeof index === 'number') {\n        this.htEditor.selectCell(index, 0, void 0, void 0, void 0, false);\n      } else {\n        this.htEditor.deselectCell();\n      }\n    }\n    /**\n     * Calculates and return the internal Handsontable's height.\n     *\n     * @private\n     * @returns {Number}\n     */\n\n  }, {\n    key: \"getDropdownHeight\",\n    value: function getDropdownHeight() {\n      var firstRowHeight = this.htEditor.getInstance().getRowHeight(0) || 23;\n      var visibleRows = this.cellProperties.visibleRows;\n      return this.strippedChoices.length >= visibleRows ? visibleRows * firstRowHeight : this.strippedChoices.length * firstRowHeight + 8;\n    }\n    /**\n     * Sanitizes value from potential dangerous tags.\n     *\n     * @private\n     * @param {String} value\n     * @returns {String}\n     */\n\n  }, {\n    key: \"stripValueIfNeeded\",\n    value: function stripValueIfNeeded(value) {\n      return this.stripValuesIfNeeded([value])[0];\n    }\n    /**\n     * Sanitizes an array of the values from potential dangerous tags.\n     *\n     * @private\n     * @param {String[]} values\n     * @returns {String[]}\n     */\n\n  }, {\n    key: \"stripValuesIfNeeded\",\n    value: function stripValuesIfNeeded(values) {\n      var allowHtml = this.cellProperties.allowHtml;\n      var stringifiedValues = arrayMap(values, function (value) {\n        return stringify(value);\n      });\n      var strippedValues = arrayMap(stringifiedValues, function (value) {\n        return allowHtml ? value : stripTags(value);\n      });\n      return strippedValues;\n    }\n    /**\n     * Captures use of arrow down and up to control their behaviour.\n     *\n     * @private\n     * @param {Number} keyCode\n     * @returns {Boolean}\n     */\n\n  }, {\n    key: \"allowKeyEventPropagation\",\n    value: function allowKeyEventPropagation(keyCode) {\n      var selectedRange = this.htEditor.getSelectedRangeLast();\n      var selected = {\n        row: selectedRange ? selectedRange.from.row : -1\n      };\n      var allowed = false;\n\n      if (keyCode === KEY_CODES.ARROW_DOWN && selected.row > 0 && selected.row < this.htEditor.countRows() - 1) {\n        allowed = true;\n      }\n\n      if (keyCode === KEY_CODES.ARROW_UP && selected.row > -1) {\n        allowed = true;\n      }\n\n      return allowed;\n    }\n    /**\n     * onBeforeKeyDown callback.\n     *\n     * @private\n     * @param {KeyboardEvent} event\n     */\n\n  }, {\n    key: \"onBeforeKeyDown\",\n    value: function onBeforeKeyDown(event) {\n      var _this5 = this;\n\n      var priv = privatePool.get(this);\n      priv.skipOne = false;\n\n      if (isPrintableChar(event.keyCode) || event.keyCode === KEY_CODES.BACKSPACE || event.keyCode === KEY_CODES.DELETE || event.keyCode === KEY_CODES.INSERT) {\n        var timeOffset = 0; // on ctl+c / cmd+c don't update suggestion list\n\n        if (event.keyCode === KEY_CODES.C && (event.ctrlKey || event.metaKey)) {\n          return;\n        }\n\n        if (!this.isOpened()) {\n          timeOffset += 10;\n        }\n\n        if (this.htEditor) {\n          this.hot._registerTimeout(function () {\n            _this5.queryChoices(_this5.TEXTAREA.value);\n\n            priv.skipOne = true;\n          }, timeOffset);\n        }\n      }\n\n      _get(_getPrototypeOf(AutocompleteEditor.prototype), \"onBeforeKeyDown\", this).call(this, event);\n    }\n  }]);\n\n  return AutocompleteEditor;\n}(HandsontableEditor);\n/**\n * Filters and sorts by relevance.\n *\n * @param value\n * @param choices\n * @param caseSensitive\n * @returns {Number[]} array of indexes in original choices array\n */\n\n\nAutocompleteEditor.sortByRelevance = function (value, choices, caseSensitive) {\n  var choicesRelevance = [];\n  var currentItem;\n  var valueLength = value.length;\n  var valueIndex;\n  var charsLeft;\n  var result = [];\n  var i;\n  var choicesCount = choices.length;\n\n  if (valueLength === 0) {\n    for (i = 0; i < choicesCount; i++) {\n      result.push(i);\n    }\n\n    return result;\n  }\n\n  for (i = 0; i < choicesCount; i++) {\n    currentItem = stripTags(stringify(choices[i]));\n\n    if (caseSensitive) {\n      valueIndex = currentItem.indexOf(value);\n    } else {\n      valueIndex = currentItem.toLowerCase().indexOf(value.toLowerCase());\n    }\n\n    if (valueIndex !== -1) {\n      charsLeft = currentItem.length - valueIndex - valueLength;\n      choicesRelevance.push({\n        baseIndex: i,\n        index: valueIndex,\n        charsLeft: charsLeft,\n        value: currentItem\n      });\n    }\n  }\n\n  choicesRelevance.sort(function (a, b) {\n    if (b.index === -1) {\n      return -1;\n    }\n\n    if (a.index === -1) {\n      return 1;\n    }\n\n    if (a.index < b.index) {\n      return -1;\n    } else if (b.index < a.index) {\n      return 1;\n    } else if (a.index === b.index) {\n      if (a.charsLeft < b.charsLeft) {\n        return -1;\n      } else if (a.charsLeft > b.charsLeft) {\n        return 1;\n      }\n    }\n\n    return 0;\n  });\n\n  for (i = 0, choicesCount = choicesRelevance.length; i < choicesCount; i++) {\n    result.push(choicesRelevance[i].baseIndex);\n  }\n\n  return result;\n};\n\nexport default AutocompleteEditor;","map":{"version":3,"sources":["C:/Users/pjk14/Desktop/Gradely/gradely-react/node_modules/handsontable/es/editors/autocompleteEditor.js"],"names":["_typeof","obj","Symbol","iterator","constructor","prototype","_classCallCheck","instance","Constructor","TypeError","_defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","_createClass","protoProps","staticProps","_possibleConstructorReturn","self","call","_assertThisInitialized","ReferenceError","_get","property","receiver","Reflect","get","base","_superPropBase","desc","getOwnPropertyDescriptor","value","object","hasOwnProperty","_getPrototypeOf","o","setPrototypeOf","getPrototypeOf","__proto__","_inherits","subClass","superClass","create","_setPrototypeOf","p","KEY_CODES","isPrintableChar","stringify","isDefined","stripTags","pivot","arrayMap","addClass","getCaretPosition","getScrollbarWidth","getSelectionEndPosition","outerWidth","outerHeight","offset","getTrimmingContainer","setCaretPosition","HandsontableEditor","privatePool","WeakMap","AutocompleteEditor","_HandsontableEditor","_this","query","strippedChoices","rawChoices","set","skipOne","getValue","_this2","selectedValue","find","strippedValue","stripValueIfNeeded","TEXTAREA","createElements","htContainer","hot","rootWindow","navigator","platform","indexOf","open","_this3","priv","TEXTAREA_PARENT","style","overflow","choicesListHot","htEditor","getInstance","trimDropdown","cellProperties","showEditableElement","focus","scrollbarWidth","rootDocument","updateSettings","colWidths","width","afterRenderer","TD","row","col","prop","_this3$cellProperties","filteringCaseSensitive","allowHtml","cellValue","indexOfMatch","match","toLowerCase","substr","replace","concat","innerHTML","autoColumnSize","modifyColWidth","getPlugin","columnWidth","autoWidths","widths","view","wt","wtTable","holder","parentNode","_registerTimeout","queryChoices","close","removeHooksByKey","discardEditor","result","render","_this4","source","choices","updateChoicesList","stripValuesIfNeeded","Array","isArray","choicesList","pos","endPos","sortByRelevanceSetting","sortByRelevance","filterSetting","filter","orderByRelevance","highlightIndex","orderByRelevanceLength","sorted","choicesCount","push","loadData","updateDropdownHeight","flipDropdownIfNeeded","strict","highlightBestMatchingChoice","listen","textareaOffset","textareaHeight","dropdownHeight","getDropdownHeight","trimmingContainer","TABLE","trimmingContainerScrollTop","scrollTop","headersHeight","THEAD","containerOffset","spaceAbove","top","spaceBelow","scrollHeight","flipNeeded","flipDropdown","unflipDropdown","limitDropdownIfNeeded","spaceAvailable","tempHeight","lastRowHeight","height","getRowHeight","wtSettings","settings","defaultRowHeight","flipped","rootElement","parseInt","setDropdownHeight","dropdownStyle","position","currentDropdownWidth","getColWidth","alignOverlaysWithTrimmingContainer","index","selectCell","deselectCell","firstRowHeight","visibleRows","values","stringifiedValues","strippedValues","allowKeyEventPropagation","keyCode","selectedRange","getSelectedRangeLast","selected","from","allowed","ARROW_DOWN","countRows","ARROW_UP","onBeforeKeyDown","event","_this5","BACKSPACE","DELETE","INSERT","timeOffset","C","ctrlKey","metaKey","isOpened","caseSensitive","choicesRelevance","currentItem","valueLength","valueIndex","charsLeft","baseIndex","sort","a","b"],"mappings":"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","sourcesContent":["import \"core-js/modules/es.symbol\";\nimport \"core-js/modules/es.symbol.description\";\nimport \"core-js/modules/es.symbol.iterator\";\nimport \"core-js/modules/es.array.filter\";\nimport \"core-js/modules/es.array.find\";\nimport \"core-js/modules/es.array.index-of\";\nimport \"core-js/modules/es.array.iterator\";\nimport \"core-js/modules/es.array.sort\";\nimport \"core-js/modules/es.object.get-own-property-descriptor\";\nimport \"core-js/modules/es.object.get-prototype-of\";\nimport \"core-js/modules/es.object.set-prototype-of\";\nimport \"core-js/modules/es.object.to-string\";\nimport \"core-js/modules/es.reflect.get\";\nimport \"core-js/modules/es.regexp.exec\";\nimport \"core-js/modules/es.string.iterator\";\nimport \"core-js/modules/es.string.replace\";\nimport \"core-js/modules/es.weak-map\";\nimport \"core-js/modules/web.dom-collections.iterator\";\n\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _get(target, property, receiver) { if (typeof Reflect !== \"undefined\" && Reflect.get) { _get = Reflect.get; } else { _get = function _get(target, property, receiver) { var base = _superPropBase(target, property); if (!base) return; var desc = Object.getOwnPropertyDescriptor(base, property); if (desc.get) { return desc.get.call(receiver); } return desc.value; }; } return _get(target, property, receiver || target); }\n\nfunction _superPropBase(object, property) { while (!Object.prototype.hasOwnProperty.call(object, property)) { object = _getPrototypeOf(object); if (object === null) break; } return object; }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nimport { KEY_CODES, isPrintableChar } from './../helpers/unicode';\nimport { stringify, isDefined } from './../helpers/mixed';\nimport { stripTags } from './../helpers/string';\nimport { pivot, arrayMap } from './../helpers/array';\nimport { addClass, getCaretPosition, getScrollbarWidth, getSelectionEndPosition, outerWidth, outerHeight, offset, getTrimmingContainer, setCaretPosition } from './../helpers/dom/element';\nimport HandsontableEditor from './handsontableEditor';\nvar privatePool = new WeakMap();\n/**\n * @private\n * @editor AutocompleteEditor\n * @class AutocompleteEditor\n * @dependencies HandsontableEditor\n */\n\nvar AutocompleteEditor =\n/*#__PURE__*/\nfunction (_HandsontableEditor) {\n  _inherits(AutocompleteEditor, _HandsontableEditor);\n\n  function AutocompleteEditor(instance) {\n    var _this;\n\n    _classCallCheck(this, AutocompleteEditor);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(AutocompleteEditor).call(this, instance));\n    /**\n     * Query string to turn available values over.\n     *\n     * @type {String}\n     */\n\n    _this.query = null;\n    /**\n     * Contains stripped choices.\n     *\n     * @type {String[]}\n     */\n\n    _this.strippedChoices = [];\n    /**\n     * Contains raw choices.\n     *\n     * @type {Array}\n     */\n\n    _this.rawChoices = [];\n    privatePool.set(_assertThisInitialized(_this), {\n      skipOne: false\n    });\n    return _this;\n  }\n  /**\n   * Gets current value from editable element.\n   *\n   * @returns {String}\n   */\n\n\n  _createClass(AutocompleteEditor, [{\n    key: \"getValue\",\n    value: function getValue() {\n      var _this2 = this;\n\n      var selectedValue = this.rawChoices.find(function (value) {\n        var strippedValue = _this2.stripValueIfNeeded(value);\n\n        return strippedValue === _this2.TEXTAREA.value;\n      });\n\n      if (isDefined(selectedValue)) {\n        return selectedValue;\n      }\n\n      return this.TEXTAREA.value;\n    }\n    /**\n     * Creates an editor's elements and adds necessary CSS classnames.\n     */\n\n  }, {\n    key: \"createElements\",\n    value: function createElements() {\n      _get(_getPrototypeOf(AutocompleteEditor.prototype), \"createElements\", this).call(this);\n\n      addClass(this.htContainer, 'autocompleteEditor');\n      addClass(this.htContainer, this.hot.rootWindow.navigator.platform.indexOf('Mac') === -1 ? '' : 'htMacScroll');\n    }\n    /**\n     * Opens the editor and adjust its size and internal Handsontable's instance.\n     */\n\n  }, {\n    key: \"open\",\n    value: function open() {\n      var _this3 = this;\n\n      var priv = privatePool.get(this); // this.addHook('beforeKeyDown', event => this.onBeforeKeyDown(event));\n      // Ugly fix for handsontable which grab window object for autocomplete scroll listener instead table element.\n\n      this.TEXTAREA_PARENT.style.overflow = 'auto';\n\n      _get(_getPrototypeOf(AutocompleteEditor.prototype), \"open\", this).call(this);\n\n      this.TEXTAREA_PARENT.style.overflow = '';\n      var choicesListHot = this.htEditor.getInstance();\n      var trimDropdown = this.cellProperties.trimDropdown === void 0 ? true : this.cellProperties.trimDropdown;\n      this.showEditableElement();\n      this.focus();\n      var scrollbarWidth = getScrollbarWidth(this.hot.rootDocument);\n      choicesListHot.updateSettings({\n        colWidths: trimDropdown ? [outerWidth(this.TEXTAREA) - 2] : void 0,\n        width: trimDropdown ? outerWidth(this.TEXTAREA) + scrollbarWidth + 2 : void 0,\n        afterRenderer: function afterRenderer(TD, row, col, prop, value) {\n          var _this3$cellProperties = _this3.cellProperties,\n              filteringCaseSensitive = _this3$cellProperties.filteringCaseSensitive,\n              allowHtml = _this3$cellProperties.allowHtml;\n          var query = _this3.query;\n          var cellValue = stringify(value);\n          var indexOfMatch;\n          var match;\n\n          if (cellValue && !allowHtml) {\n            indexOfMatch = filteringCaseSensitive === true ? cellValue.indexOf(query) : cellValue.toLowerCase().indexOf(query.toLowerCase());\n\n            if (indexOfMatch !== -1) {\n              match = cellValue.substr(indexOfMatch, query.length);\n              cellValue = cellValue.replace(match, \"<strong>\".concat(match, \"</strong>\"));\n            }\n          }\n\n          TD.innerHTML = cellValue;\n        },\n        autoColumnSize: true,\n        modifyColWidth: function modifyColWidth(width, col) {\n          // workaround for <strong> text overlapping the dropdown, not really accurate\n          var autoColumnSize = this.getPlugin('autoColumnSize');\n          var columnWidth = width;\n\n          if (autoColumnSize) {\n            var autoWidths = autoColumnSize.widths;\n\n            if (autoWidths[col]) {\n              columnWidth = autoWidths[col];\n            }\n          }\n\n          return trimDropdown ? columnWidth : columnWidth + 15;\n        }\n      }); // Add additional space for autocomplete holder\n\n      this.htEditor.view.wt.wtTable.holder.parentNode.style['padding-right'] = \"\".concat(scrollbarWidth + 2, \"px\");\n\n      if (priv.skipOne) {\n        priv.skipOne = false;\n      }\n\n      this.hot._registerTimeout(function () {\n        _this3.queryChoices(_this3.TEXTAREA.value);\n      });\n    }\n    /**\n     * Closes the editor.\n     */\n\n  }, {\n    key: \"close\",\n    value: function close() {\n      this.removeHooksByKey('beforeKeyDown');\n\n      _get(_getPrototypeOf(AutocompleteEditor.prototype), \"close\", this).call(this);\n    }\n    /**\n     * Verifies result of validation or closes editor if user's cancelled changes. Re-renders WalkOnTable.\n     *\n     * @param {Boolean|undefined} result\n     */\n\n  }, {\n    key: \"discardEditor\",\n    value: function discardEditor(result) {\n      _get(_getPrototypeOf(AutocompleteEditor.prototype), \"discardEditor\", this).call(this, result);\n\n      this.hot.view.render();\n    }\n    /**\n     * Prepares choices list based on applied argument.\n     *\n     * @private\n     * @param {String} query\n     */\n\n  }, {\n    key: \"queryChoices\",\n    value: function queryChoices(query) {\n      var _this4 = this;\n\n      var source = this.cellProperties.source;\n      this.query = query;\n\n      if (typeof source === 'function') {\n        source.call(this.cellProperties, query, function (choices) {\n          _this4.rawChoices = choices;\n\n          _this4.updateChoicesList(_this4.stripValuesIfNeeded(choices));\n        });\n      } else if (Array.isArray(source)) {\n        this.rawChoices = source;\n        this.updateChoicesList(this.stripValuesIfNeeded(source));\n      } else {\n        this.updateChoicesList([]);\n      }\n    }\n    /**\n     * Updates list of the possible completions to choose.\n     *\n     * @private\n     * @param {Array} choicesList\n     */\n\n  }, {\n    key: \"updateChoicesList\",\n    value: function updateChoicesList(choicesList) {\n      var pos = getCaretPosition(this.TEXTAREA);\n      var endPos = getSelectionEndPosition(this.TEXTAREA);\n      var sortByRelevanceSetting = this.cellProperties.sortByRelevance;\n      var filterSetting = this.cellProperties.filter;\n      var orderByRelevance = null;\n      var highlightIndex = null;\n      var choices = choicesList;\n\n      if (sortByRelevanceSetting) {\n        orderByRelevance = AutocompleteEditor.sortByRelevance(this.stripValueIfNeeded(this.getValue()), choices, this.cellProperties.filteringCaseSensitive);\n      }\n\n      var orderByRelevanceLength = Array.isArray(orderByRelevance) ? orderByRelevance.length : 0;\n\n      if (filterSetting === false) {\n        if (orderByRelevanceLength) {\n          highlightIndex = orderByRelevance[0];\n        }\n      } else {\n        var sorted = [];\n\n        for (var i = 0, choicesCount = choices.length; i < choicesCount; i++) {\n          if (sortByRelevanceSetting && orderByRelevanceLength <= i) {\n            break;\n          }\n\n          if (orderByRelevanceLength) {\n            sorted.push(choices[orderByRelevance[i]]);\n          } else {\n            sorted.push(choices[i]);\n          }\n        }\n\n        highlightIndex = 0;\n        choices = sorted;\n      }\n\n      this.strippedChoices = choices;\n      this.htEditor.loadData(pivot([choices]));\n      this.updateDropdownHeight();\n      this.flipDropdownIfNeeded();\n\n      if (this.cellProperties.strict === true) {\n        this.highlightBestMatchingChoice(highlightIndex);\n      }\n\n      this.hot.listen(false);\n      setCaretPosition(this.TEXTAREA, pos, pos === endPos ? void 0 : endPos);\n    }\n    /**\n     * Checks where is enough place to open editor.\n     *\n     * @private\n     * @returns {Boolean}\n     */\n\n  }, {\n    key: \"flipDropdownIfNeeded\",\n    value: function flipDropdownIfNeeded() {\n      var textareaOffset = offset(this.TEXTAREA);\n      var textareaHeight = outerHeight(this.TEXTAREA);\n      var dropdownHeight = this.getDropdownHeight();\n      var trimmingContainer = getTrimmingContainer(this.hot.view.wt.wtTable.TABLE);\n      var trimmingContainerScrollTop = trimmingContainer.scrollTop;\n      var headersHeight = outerHeight(this.hot.view.wt.wtTable.THEAD);\n      var containerOffset = {\n        row: 0,\n        col: 0\n      };\n\n      if (trimmingContainer !== this.hot.rootWindow) {\n        containerOffset = offset(trimmingContainer);\n      }\n\n      var spaceAbove = textareaOffset.top - containerOffset.top - headersHeight + trimmingContainerScrollTop;\n      var spaceBelow = trimmingContainer.scrollHeight - spaceAbove - headersHeight - textareaHeight;\n      var flipNeeded = dropdownHeight > spaceBelow && spaceAbove > spaceBelow;\n\n      if (flipNeeded) {\n        this.flipDropdown(dropdownHeight);\n      } else {\n        this.unflipDropdown();\n      }\n\n      this.limitDropdownIfNeeded(flipNeeded ? spaceAbove : spaceBelow, dropdownHeight);\n      return flipNeeded;\n    }\n    /**\n     * Checks if the internal table should generate scrollbar or could be rendered without it.\n     *\n     * @private\n     * @param {Number} spaceAvailable\n     * @param {Number} dropdownHeight\n     */\n\n  }, {\n    key: \"limitDropdownIfNeeded\",\n    value: function limitDropdownIfNeeded(spaceAvailable, dropdownHeight) {\n      if (dropdownHeight > spaceAvailable) {\n        var tempHeight = 0;\n        var i = 0;\n        var lastRowHeight = 0;\n        var height = null;\n\n        do {\n          lastRowHeight = this.htEditor.getRowHeight(i) || this.htEditor.view.wt.wtSettings.settings.defaultRowHeight;\n          tempHeight += lastRowHeight;\n          i += 1;\n        } while (tempHeight < spaceAvailable);\n\n        height = tempHeight - lastRowHeight;\n\n        if (this.htEditor.flipped) {\n          this.htEditor.rootElement.style.top = \"\".concat(parseInt(this.htEditor.rootElement.style.top, 10) + dropdownHeight - height, \"px\");\n        }\n\n        this.setDropdownHeight(tempHeight - lastRowHeight);\n      }\n    }\n    /**\n     * Configures editor to open it at the top.\n     *\n     * @private\n     * @param {Number} dropdownHeight\n     */\n\n  }, {\n    key: \"flipDropdown\",\n    value: function flipDropdown(dropdownHeight) {\n      var dropdownStyle = this.htEditor.rootElement.style;\n      dropdownStyle.position = 'absolute';\n      dropdownStyle.top = \"\".concat(-dropdownHeight, \"px\");\n      this.htEditor.flipped = true;\n    }\n    /**\n     * Configures editor to open it at the bottom.\n     *\n     * @private\n     */\n\n  }, {\n    key: \"unflipDropdown\",\n    value: function unflipDropdown() {\n      var dropdownStyle = this.htEditor.rootElement.style;\n\n      if (dropdownStyle.position === 'absolute') {\n        dropdownStyle.position = '';\n        dropdownStyle.top = '';\n      }\n\n      this.htEditor.flipped = void 0;\n    }\n    /**\n     * Updates width and height of the internal Handsontable's instance.\n     *\n     * @private\n     */\n\n  }, {\n    key: \"updateDropdownHeight\",\n    value: function updateDropdownHeight() {\n      var currentDropdownWidth = this.htEditor.getColWidth(0) + getScrollbarWidth(this.hot.rootDocument) + 2;\n      var trimDropdown = this.cellProperties.trimDropdown;\n      this.htEditor.updateSettings({\n        height: this.getDropdownHeight(),\n        width: trimDropdown ? void 0 : currentDropdownWidth\n      });\n      this.htEditor.view.wt.wtTable.alignOverlaysWithTrimmingContainer();\n    }\n    /**\n     * Sets new height of the internal Handsontable's instance.\n     *\n     * @private\n     * @param {Number} height\n     */\n\n  }, {\n    key: \"setDropdownHeight\",\n    value: function setDropdownHeight(height) {\n      this.htEditor.updateSettings({\n        height: height\n      });\n    }\n    /**\n     * Creates new selection on specified row index, or deselects selected cells.\n     *\n     * @private\n     * @param {Number|undefined} index\n     */\n\n  }, {\n    key: \"highlightBestMatchingChoice\",\n    value: function highlightBestMatchingChoice(index) {\n      if (typeof index === 'number') {\n        this.htEditor.selectCell(index, 0, void 0, void 0, void 0, false);\n      } else {\n        this.htEditor.deselectCell();\n      }\n    }\n    /**\n     * Calculates and return the internal Handsontable's height.\n     *\n     * @private\n     * @returns {Number}\n     */\n\n  }, {\n    key: \"getDropdownHeight\",\n    value: function getDropdownHeight() {\n      var firstRowHeight = this.htEditor.getInstance().getRowHeight(0) || 23;\n      var visibleRows = this.cellProperties.visibleRows;\n      return this.strippedChoices.length >= visibleRows ? visibleRows * firstRowHeight : this.strippedChoices.length * firstRowHeight + 8;\n    }\n    /**\n     * Sanitizes value from potential dangerous tags.\n     *\n     * @private\n     * @param {String} value\n     * @returns {String}\n     */\n\n  }, {\n    key: \"stripValueIfNeeded\",\n    value: function stripValueIfNeeded(value) {\n      return this.stripValuesIfNeeded([value])[0];\n    }\n    /**\n     * Sanitizes an array of the values from potential dangerous tags.\n     *\n     * @private\n     * @param {String[]} values\n     * @returns {String[]}\n     */\n\n  }, {\n    key: \"stripValuesIfNeeded\",\n    value: function stripValuesIfNeeded(values) {\n      var allowHtml = this.cellProperties.allowHtml;\n      var stringifiedValues = arrayMap(values, function (value) {\n        return stringify(value);\n      });\n      var strippedValues = arrayMap(stringifiedValues, function (value) {\n        return allowHtml ? value : stripTags(value);\n      });\n      return strippedValues;\n    }\n    /**\n     * Captures use of arrow down and up to control their behaviour.\n     *\n     * @private\n     * @param {Number} keyCode\n     * @returns {Boolean}\n     */\n\n  }, {\n    key: \"allowKeyEventPropagation\",\n    value: function allowKeyEventPropagation(keyCode) {\n      var selectedRange = this.htEditor.getSelectedRangeLast();\n      var selected = {\n        row: selectedRange ? selectedRange.from.row : -1\n      };\n      var allowed = false;\n\n      if (keyCode === KEY_CODES.ARROW_DOWN && selected.row > 0 && selected.row < this.htEditor.countRows() - 1) {\n        allowed = true;\n      }\n\n      if (keyCode === KEY_CODES.ARROW_UP && selected.row > -1) {\n        allowed = true;\n      }\n\n      return allowed;\n    }\n    /**\n     * onBeforeKeyDown callback.\n     *\n     * @private\n     * @param {KeyboardEvent} event\n     */\n\n  }, {\n    key: \"onBeforeKeyDown\",\n    value: function onBeforeKeyDown(event) {\n      var _this5 = this;\n\n      var priv = privatePool.get(this);\n      priv.skipOne = false;\n\n      if (isPrintableChar(event.keyCode) || event.keyCode === KEY_CODES.BACKSPACE || event.keyCode === KEY_CODES.DELETE || event.keyCode === KEY_CODES.INSERT) {\n        var timeOffset = 0; // on ctl+c / cmd+c don't update suggestion list\n\n        if (event.keyCode === KEY_CODES.C && (event.ctrlKey || event.metaKey)) {\n          return;\n        }\n\n        if (!this.isOpened()) {\n          timeOffset += 10;\n        }\n\n        if (this.htEditor) {\n          this.hot._registerTimeout(function () {\n            _this5.queryChoices(_this5.TEXTAREA.value);\n\n            priv.skipOne = true;\n          }, timeOffset);\n        }\n      }\n\n      _get(_getPrototypeOf(AutocompleteEditor.prototype), \"onBeforeKeyDown\", this).call(this, event);\n    }\n  }]);\n\n  return AutocompleteEditor;\n}(HandsontableEditor);\n/**\n * Filters and sorts by relevance.\n *\n * @param value\n * @param choices\n * @param caseSensitive\n * @returns {Number[]} array of indexes in original choices array\n */\n\n\nAutocompleteEditor.sortByRelevance = function (value, choices, caseSensitive) {\n  var choicesRelevance = [];\n  var currentItem;\n  var valueLength = value.length;\n  var valueIndex;\n  var charsLeft;\n  var result = [];\n  var i;\n  var choicesCount = choices.length;\n\n  if (valueLength === 0) {\n    for (i = 0; i < choicesCount; i++) {\n      result.push(i);\n    }\n\n    return result;\n  }\n\n  for (i = 0; i < choicesCount; i++) {\n    currentItem = stripTags(stringify(choices[i]));\n\n    if (caseSensitive) {\n      valueIndex = currentItem.indexOf(value);\n    } else {\n      valueIndex = currentItem.toLowerCase().indexOf(value.toLowerCase());\n    }\n\n    if (valueIndex !== -1) {\n      charsLeft = currentItem.length - valueIndex - valueLength;\n      choicesRelevance.push({\n        baseIndex: i,\n        index: valueIndex,\n        charsLeft: charsLeft,\n        value: currentItem\n      });\n    }\n  }\n\n  choicesRelevance.sort(function (a, b) {\n    if (b.index === -1) {\n      return -1;\n    }\n\n    if (a.index === -1) {\n      return 1;\n    }\n\n    if (a.index < b.index) {\n      return -1;\n    } else if (b.index < a.index) {\n      return 1;\n    } else if (a.index === b.index) {\n      if (a.charsLeft < b.charsLeft) {\n        return -1;\n      } else if (a.charsLeft > b.charsLeft) {\n        return 1;\n      }\n    }\n\n    return 0;\n  });\n\n  for (i = 0, choicesCount = choicesRelevance.length; i < choicesCount; i++) {\n    result.push(choicesRelevance[i].baseIndex);\n  }\n\n  return result;\n};\n\nexport default AutocompleteEditor;"]},"metadata":{},"sourceType":"module"}