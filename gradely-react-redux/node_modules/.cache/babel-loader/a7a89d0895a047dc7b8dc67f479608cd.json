{"ast":null,"code":"function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nfunction _slicedToArray(arr, i) {\n  return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest();\n}\n\nfunction _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance\");\n}\n\nfunction _iterableToArrayLimit(arr, i) {\n  if (!(Symbol.iterator in Object(arr) || Object.prototype.toString.call(arr) === \"[object Arguments]\")) {\n    return;\n  }\n\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n  var _e = undefined;\n\n  try {\n    for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}\n\nfunction _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  }\n\n  return _assertThisInitialized(self);\n}\n\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nfunction _get(target, property, receiver) {\n  if (typeof Reflect !== \"undefined\" && Reflect.get) {\n    _get = Reflect.get;\n  } else {\n    _get = function _get(target, property, receiver) {\n      var base = _superPropBase(target, property);\n\n      if (!base) return;\n      var desc = Object.getOwnPropertyDescriptor(base, property);\n\n      if (desc.get) {\n        return desc.get.call(receiver);\n      }\n\n      return desc.value;\n    };\n  }\n\n  return _get(target, property, receiver || target);\n}\n\nfunction _superPropBase(object, property) {\n  while (!Object.prototype.hasOwnProperty.call(object, property)) {\n    object = _getPrototypeOf(object);\n    if (object === null) break;\n  }\n\n  return object;\n}\n\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) _setPrototypeOf(subClass, superClass);\n}\n\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nimport BasePlugin from '../_base';\nimport { arrayEach } from '../../helpers/array';\nimport { isObject, objectEach } from '../../helpers/object';\nimport EventManager from '../../eventManager';\nimport { registerPlugin } from '../../plugins';\nimport { isFormulaExpression, toUpperCaseFormula, isFormulaExpressionEscaped, unescapeFormulaExpression } from './utils';\nimport Sheet from './sheet';\nimport DataProvider from './dataProvider';\nimport UndoRedoSnapshot from './undoRedoSnapshot';\n/**\n * The formulas plugin.\n *\n * @plugin Formulas\n * @experimental\n */\n\nvar Formulas = /*#__PURE__*/function (_BasePlugin) {\n  _inherits(Formulas, _BasePlugin);\n\n  function Formulas(hotInstance) {\n    var _this;\n\n    _classCallCheck(this, Formulas);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Formulas).call(this, hotInstance));\n    /**\n     * Instance of {@link EventManager}.\n     *\n     * @private\n     * @type {EventManager}\n     */\n\n    _this.eventManager = new EventManager(_assertThisInitialized(_this));\n    /**\n     * Instance of {@link DataProvider}.\n     *\n     * @private\n     * @type {DataProvider}\n     */\n\n    _this.dataProvider = new DataProvider(_this.hot);\n    /**\n     * Instance of {@link Sheet}.\n     *\n     * @private\n     * @type {Sheet}\n     */\n\n    _this.sheet = new Sheet(_this.hot, _this.dataProvider);\n    /**\n     * Instance of {@link UndoRedoSnapshot}.\n     *\n     * @private\n     * @type {UndoRedoSnapshot}\n     */\n\n    _this.undoRedoSnapshot = new UndoRedoSnapshot(_this.sheet);\n    /**\n     * Flag which indicates if table should be re-render after sheet recalculations.\n     *\n     * @type {Boolean}\n     * @default false\n     * @private\n     */\n\n    _this._skipRendering = false;\n    return _this;\n  }\n  /**\n   * Checks if the plugin is enabled in the handsontable settings. This method is executed in {@link Hooks#beforeInit}\n   * hook and if it returns `true` than the {@link Formulas#enablePlugin} method is called.\n   *\n   * @returns {Boolean}\n   */\n\n\n  _createClass(Formulas, [{\n    key: \"isEnabled\",\n    value: function isEnabled() {\n      /* eslint-disable no-unneeded-ternary */\n      return this.hot.getSettings().formulas ? true : false;\n    }\n    /**\n     * Enables the plugin functionality for this Handsontable instance.\n     */\n\n  }, {\n    key: \"enablePlugin\",\n    value: function enablePlugin() {\n      var _this2 = this;\n\n      if (this.enabled) {\n        return;\n      }\n\n      var settings = this.hot.getSettings().formulas;\n\n      if (isObject(settings)) {\n        if (isObject(settings.variables)) {\n          objectEach(settings.variables, function (value, name) {\n            return _this2.setVariable(name, value);\n          });\n        }\n      }\n\n      this.addHook('afterColumnSort', function () {\n        return _this2.onAfterColumnSort.apply(_this2, arguments);\n      });\n      this.addHook('afterCreateCol', function () {\n        return _this2.onAfterCreateCol.apply(_this2, arguments);\n      });\n      this.addHook('afterCreateRow', function () {\n        return _this2.onAfterCreateRow.apply(_this2, arguments);\n      });\n      this.addHook('afterLoadData', function () {\n        return _this2.onAfterLoadData();\n      });\n      this.addHook('afterRemoveCol', function () {\n        return _this2.onAfterRemoveCol.apply(_this2, arguments);\n      });\n      this.addHook('afterRemoveRow', function () {\n        return _this2.onAfterRemoveRow.apply(_this2, arguments);\n      });\n      this.addHook('afterSetDataAtCell', function () {\n        return _this2.onAfterSetDataAtCell.apply(_this2, arguments);\n      });\n      this.addHook('afterSetDataAtRowProp', function () {\n        return _this2.onAfterSetDataAtCell.apply(_this2, arguments);\n      });\n      this.addHook('beforeColumnSort', function () {\n        return _this2.onBeforeColumnSort.apply(_this2, arguments);\n      });\n      this.addHook('beforeCreateCol', function () {\n        return _this2.onBeforeCreateCol.apply(_this2, arguments);\n      });\n      this.addHook('beforeCreateRow', function () {\n        return _this2.onBeforeCreateRow.apply(_this2, arguments);\n      });\n      this.addHook('beforeRemoveCol', function () {\n        return _this2.onBeforeRemoveCol.apply(_this2, arguments);\n      });\n      this.addHook('beforeRemoveRow', function () {\n        return _this2.onBeforeRemoveRow.apply(_this2, arguments);\n      });\n      this.addHook('beforeValidate', function () {\n        return _this2.onBeforeValidate.apply(_this2, arguments);\n      });\n      this.addHook('beforeValueRender', function () {\n        return _this2.onBeforeValueRender.apply(_this2, arguments);\n      });\n      this.addHook('modifyData', function () {\n        return _this2.onModifyData.apply(_this2, arguments);\n      });\n      this.sheet.addLocalHook('afterRecalculate', function () {\n        return _this2.onSheetAfterRecalculate.apply(_this2, arguments);\n      });\n\n      _get(_getPrototypeOf(Formulas.prototype), \"enablePlugin\", this).call(this);\n    }\n    /**\n     * Disables the plugin functionality for this Handsontable instance.\n     */\n\n  }, {\n    key: \"disablePlugin\",\n    value: function disablePlugin() {\n      _get(_getPrototypeOf(Formulas.prototype), \"disablePlugin\", this).call(this);\n    }\n    /**\n     * Returns cell value (evaluated from formula expression) at specified cell coords.\n     *\n     * @param {Number} row Row index.\n     * @param {Number} column Column index.\n     * @returns {*}\n     */\n\n  }, {\n    key: \"getCellValue\",\n    value: function getCellValue(row, column) {\n      var cell = this.sheet.getCellAt(row, column);\n      return cell ? cell.getError() || cell.getValue() : void 0;\n    }\n    /**\n     * Checks if there are any formula evaluations made under specific cell coords.\n     *\n     * @param {Number} row Row index.\n     * @param {Number} column Column index.\n     * @returns {Boolean}\n     */\n\n  }, {\n    key: \"hasComputedCellValue\",\n    value: function hasComputedCellValue(row, column) {\n      return this.sheet.getCellAt(row, column) !== null;\n    }\n    /**\n     * Recalculates all formulas (an algorithm will choose the best method of calculation).\n     */\n\n  }, {\n    key: \"recalculate\",\n    value: function recalculate() {\n      this.sheet.recalculate();\n    }\n    /**\n     * Recalculates all formulas (rebuild dependencies from scratch - slow approach).\n     */\n\n  }, {\n    key: \"recalculateFull\",\n    value: function recalculateFull() {\n      this.sheet.recalculateFull();\n    }\n    /**\n     * Recalculates all formulas (recalculate only changed cells - fast approach).\n     */\n\n  }, {\n    key: \"recalculateOptimized\",\n    value: function recalculateOptimized() {\n      this.sheet.recalculateOptimized();\n    }\n    /**\n     * Sets predefined variable name which can be visible while parsing formula expression.\n     *\n     * @param {String} name Variable name.\n     * @param {*} value Variable value.\n     */\n\n  }, {\n    key: \"setVariable\",\n    value: function setVariable(name, value) {\n      this.sheet.setVariable(name, value);\n    }\n    /**\n     * Returns variable name.\n     *\n     * @param {String} name Variable name.\n     * @returns {*}\n     */\n\n  }, {\n    key: \"getVariable\",\n    value: function getVariable(name) {\n      return this.sheet.getVariable(name);\n    }\n    /**\n     * Local hook listener for after sheet recalculation.\n     *\n     * @private\n     * @param {Array} cells An array of recalculated/changed cells.\n     */\n\n  }, {\n    key: \"onSheetAfterRecalculate\",\n    value: function onSheetAfterRecalculate(cells) {\n      if (this._skipRendering) {\n        this._skipRendering = false;\n        return;\n      }\n\n      var hot = this.hot;\n      arrayEach(cells, function (_ref) {\n        var row = _ref.row,\n            column = _ref.column;\n        hot.validateCell(hot.getDataAtCell(row, column), hot.getCellMeta(row, column), function () {});\n      });\n      hot.render();\n    }\n    /**\n     * On modify row data listener. It overwrites raw values into calculated ones and force upper case all formula expressions.\n     *\n     * @private\n     * @param {Number} row Row index.\n     * @param {Number} column Column index.\n     * @param {Object} valueHolder Value holder as an object to change value by reference.\n     * @param {String} ioMode IO operation (`get` or `set`).\n     * @returns {Array|undefined} Returns modified row data.\n     */\n\n  }, {\n    key: \"onModifyData\",\n    value: function onModifyData(row, column, valueHolder, ioMode) {\n      if (ioMode === 'get' && this.hasComputedCellValue(row, column)) {\n        valueHolder.value = this.getCellValue(row, column);\n      } else if (ioMode === 'set' && isFormulaExpression(valueHolder.value)) {\n        valueHolder.value = toUpperCaseFormula(valueHolder.value);\n      }\n    }\n    /**\n     * On before value render listener.\n     *\n     * @private\n     * @param {*} value Value to render.\n     * @returns {*}\n     */\n\n  }, {\n    key: \"onBeforeValueRender\",\n    value: function onBeforeValueRender(value) {\n      var renderValue = value;\n\n      if (isFormulaExpressionEscaped(renderValue)) {\n        renderValue = unescapeFormulaExpression(renderValue);\n      }\n\n      return renderValue;\n    }\n    /**\n     * On before validate listener.\n     *\n     * @private\n     * @param {*} value Value to validate.\n     * @param {Number} row Row index.\n     * @param {Number} prop Column property.\n     */\n\n  }, {\n    key: \"onBeforeValidate\",\n    value: function onBeforeValidate(value, row, prop) {\n      var column = this.hot.propToCol(prop);\n      var validateValue = value;\n\n      if (this.hasComputedCellValue(row, column)) {\n        validateValue = this.getCellValue(row, column);\n      }\n\n      return validateValue;\n    }\n    /**\n     * `afterSetDataAtCell` listener.\n     *\n     * @private\n     * @param {Array} changes Array of changes.\n     * @param {String} [source] Source of changes.\n     */\n\n  }, {\n    key: \"onAfterSetDataAtCell\",\n    value: function onAfterSetDataAtCell(changes, source) {\n      var _this3 = this;\n\n      if (source === 'loadData') {\n        return;\n      }\n\n      this.dataProvider.clearChanges();\n      arrayEach(changes, function (_ref2) {\n        var _ref3 = _slicedToArray(_ref2, 4),\n            row = _ref3[0],\n            column = _ref3[1],\n            oldValue = _ref3[2],\n            newValue = _ref3[3];\n\n        var physicalColumn = _this3.hot.propToCol(column);\n\n        var physicalRow = _this3.t.toPhysicalRow(row);\n\n        var value = newValue;\n\n        if (isFormulaExpression(value)) {\n          value = toUpperCaseFormula(value);\n        }\n\n        _this3.dataProvider.collectChanges(physicalRow, physicalColumn, value);\n\n        if (oldValue !== value) {\n          _this3.sheet.applyChanges(physicalRow, physicalColumn, value);\n        }\n      });\n      this.recalculate();\n    }\n    /**\n     * On before create row listener.\n     *\n     * @private\n     * @param {Number} row Row index.\n     * @param {Number} amount An amount of removed rows.\n     * @param {String} source Source of method call.\n     */\n\n  }, {\n    key: \"onBeforeCreateRow\",\n    value: function onBeforeCreateRow(row, amount, source) {\n      if (source === 'UndoRedo.undo') {\n        this.undoRedoSnapshot.restore();\n      }\n    }\n    /**\n     * On after create row listener.\n     *\n     * @private\n     * @param {Number} row Row index.\n     * @param {Number} amount An amount of created rows.\n     * @param {String} source Source of method call.\n     */\n\n  }, {\n    key: \"onAfterCreateRow\",\n    value: function onAfterCreateRow(row, amount, source) {\n      this.sheet.alterManager.triggerAlter('insert_row', row, amount, source !== 'UndoRedo.undo');\n    }\n    /**\n     * On before remove row listener.\n     *\n     * @private\n     * @param {Number} row Row index.\n     * @param {Number} amount An amount of removed rows.\n     */\n\n  }, {\n    key: \"onBeforeRemoveRow\",\n    value: function onBeforeRemoveRow(row, amount) {\n      this.undoRedoSnapshot.save('row', row, amount);\n    }\n    /**\n     * On after remove row listener.\n     *\n     * @private\n     * @param {Number} row Row index.\n     * @param {Number} amount An amount of removed rows.\n     */\n\n  }, {\n    key: \"onAfterRemoveRow\",\n    value: function onAfterRemoveRow(row, amount) {\n      this.sheet.alterManager.triggerAlter('remove_row', row, amount);\n    }\n    /**\n     * On before create column listener.\n     *\n     * @private\n     * @param {Number} column Column index.\n     * @param {Number} amount An amount of removed columns.\n     * @param {String} source Source of method call.\n     */\n\n  }, {\n    key: \"onBeforeCreateCol\",\n    value: function onBeforeCreateCol(column, amount, source) {\n      if (source === 'UndoRedo.undo') {\n        this.undoRedoSnapshot.restore();\n      }\n    }\n    /**\n     * On after create column listener.\n     *\n     * @private\n     * @param {Number} column Column index.\n     * @param {Number} amount An amount of created columns.\n     * @param {String} source Source of method call.\n     */\n\n  }, {\n    key: \"onAfterCreateCol\",\n    value: function onAfterCreateCol(column, amount, source) {\n      this.sheet.alterManager.triggerAlter('insert_column', column, amount, source !== 'UndoRedo.undo');\n    }\n    /**\n     * On before remove column listener.\n     *\n     * @private\n     * @param {Number} column Column index.\n     * @param {Number} amount An amount of removed columns.\n     */\n\n  }, {\n    key: \"onBeforeRemoveCol\",\n    value: function onBeforeRemoveCol(column, amount) {\n      this.undoRedoSnapshot.save('column', column, amount);\n    }\n    /**\n     * On after remove column listener.\n     *\n     * @private\n     * @param {Number} column Column index.\n     * @param {Number} amount An amount of created columns.\n     */\n\n  }, {\n    key: \"onAfterRemoveCol\",\n    value: function onAfterRemoveCol(column, amount) {\n      this.sheet.alterManager.triggerAlter('remove_column', column, amount);\n    }\n    /**\n     * On before column sorting listener.\n     *\n     * @private\n     * @param {Number} column Sorted column index.\n     * @param {Boolean} order Order type.\n     */\n\n  }, {\n    key: \"onBeforeColumnSort\",\n    value: function onBeforeColumnSort(column, order) {\n      this.sheet.alterManager.prepareAlter('column_sorting', column, order);\n    }\n    /**\n     * On after column sorting listener.\n     *\n     * @private\n     * @param {Number} column Sorted column index.\n     * @param {Boolean} order Order type.\n     */\n\n  }, {\n    key: \"onAfterColumnSort\",\n    value: function onAfterColumnSort(column, order) {\n      this.sheet.alterManager.triggerAlter('column_sorting', column, order);\n    }\n    /**\n     * On after load data listener.\n     *\n     * @private\n     */\n\n  }, {\n    key: \"onAfterLoadData\",\n    value: function onAfterLoadData() {\n      this._skipRendering = true;\n      this.recalculateFull();\n    }\n    /**\n     * Destroys the plugin instance.\n     */\n\n  }, {\n    key: \"destroy\",\n    value: function destroy() {\n      this.dataProvider.destroy();\n      this.dataProvider = null;\n      this.sheet.destroy();\n      this.sheet = null;\n\n      _get(_getPrototypeOf(Formulas.prototype), \"destroy\", this).call(this);\n    }\n  }]);\n\n  return Formulas;\n}(BasePlugin);\n\nregisterPlugin('formulas', Formulas);\nexport default Formulas;","map":{"version":3,"sources":["C:/Users/pjk14/Desktop/Gradely/gradely-react-redux/node_modules/handsontable/es/plugins/formulas/formulas.js"],"names":["_typeof","obj","Symbol","iterator","constructor","prototype","_slicedToArray","arr","i","_arrayWithHoles","_iterableToArrayLimit","_nonIterableRest","TypeError","Object","toString","call","_arr","_n","_d","_e","undefined","_i","_s","next","done","push","value","length","err","Array","isArray","_classCallCheck","instance","Constructor","_defineProperties","target","props","descriptor","enumerable","configurable","writable","defineProperty","key","_createClass","protoProps","staticProps","_possibleConstructorReturn","self","_assertThisInitialized","ReferenceError","_get","property","receiver","Reflect","get","base","_superPropBase","desc","getOwnPropertyDescriptor","object","hasOwnProperty","_getPrototypeOf","o","setPrototypeOf","getPrototypeOf","__proto__","_inherits","subClass","superClass","create","_setPrototypeOf","p","BasePlugin","arrayEach","isObject","objectEach","EventManager","registerPlugin","isFormulaExpression","toUpperCaseFormula","isFormulaExpressionEscaped","unescapeFormulaExpression","Sheet","DataProvider","UndoRedoSnapshot","Formulas","_BasePlugin","hotInstance","_this","eventManager","dataProvider","hot","sheet","undoRedoSnapshot","_skipRendering","isEnabled","getSettings","formulas","enablePlugin","_this2","enabled","settings","variables","name","setVariable","addHook","onAfterColumnSort","apply","arguments","onAfterCreateCol","onAfterCreateRow","onAfterLoadData","onAfterRemoveCol","onAfterRemoveRow","onAfterSetDataAtCell","onBeforeColumnSort","onBeforeCreateCol","onBeforeCreateRow","onBeforeRemoveCol","onBeforeRemoveRow","onBeforeValidate","onBeforeValueRender","onModifyData","addLocalHook","onSheetAfterRecalculate","disablePlugin","getCellValue","row","column","cell","getCellAt","getError","getValue","hasComputedCellValue","recalculate","recalculateFull","recalculateOptimized","getVariable","cells","_ref","validateCell","getDataAtCell","getCellMeta","render","valueHolder","ioMode","renderValue","prop","propToCol","validateValue","changes","source","_this3","clearChanges","_ref2","_ref3","oldValue","newValue","physicalColumn","physicalRow","t","toPhysicalRow","collectChanges","applyChanges","amount","restore","alterManager","triggerAlter","save","order","prepareAlter","destroy"],"mappings":"AAaA,SAASA,OAAT,CAAiBC,GAAjB,EAAsB;AAAE;;AAA2B,MAAI,OAAOC,MAAP,KAAkB,UAAlB,IAAgC,OAAOA,MAAM,CAACC,QAAd,KAA2B,QAA/D,EAAyE;AAAEH,IAAAA,OAAO,GAAG,SAASA,OAAT,CAAiBC,GAAjB,EAAsB;AAAE,aAAO,OAAOA,GAAd;AAAoB,KAAtD;AAAyD,GAApI,MAA0I;AAAED,IAAAA,OAAO,GAAG,SAASA,OAAT,CAAiBC,GAAjB,EAAsB;AAAE,aAAOA,GAAG,IAAI,OAAOC,MAAP,KAAkB,UAAzB,IAAuCD,GAAG,CAACG,WAAJ,KAAoBF,MAA3D,IAAqED,GAAG,KAAKC,MAAM,CAACG,SAApF,GAAgG,QAAhG,GAA2G,OAAOJ,GAAzH;AAA+H,KAAjK;AAAoK;;AAAC,SAAOD,OAAO,CAACC,GAAD,CAAd;AAAsB;;AAE1X,SAASK,cAAT,CAAwBC,GAAxB,EAA6BC,CAA7B,EAAgC;AAAE,SAAOC,eAAe,CAACF,GAAD,CAAf,IAAwBG,qBAAqB,CAACH,GAAD,EAAMC,CAAN,CAA7C,IAAyDG,gBAAgB,EAAhF;AAAqF;;AAEvH,SAASA,gBAAT,GAA4B;AAAE,QAAM,IAAIC,SAAJ,CAAc,sDAAd,CAAN;AAA8E;;AAE5G,SAASF,qBAAT,CAA+BH,GAA/B,EAAoCC,CAApC,EAAuC;AAAE,MAAI,EAAEN,MAAM,CAACC,QAAP,IAAmBU,MAAM,CAACN,GAAD,CAAzB,IAAkCM,MAAM,CAACR,SAAP,CAAiBS,QAAjB,CAA0BC,IAA1B,CAA+BR,GAA/B,MAAwC,oBAA5E,CAAJ,EAAuG;AAAE;AAAS;;AAAC,MAAIS,IAAI,GAAG,EAAX;AAAe,MAAIC,EAAE,GAAG,IAAT;AAAe,MAAIC,EAAE,GAAG,KAAT;AAAgB,MAAIC,EAAE,GAAGC,SAAT;;AAAoB,MAAI;AAAE,SAAK,IAAIC,EAAE,GAAGd,GAAG,CAACL,MAAM,CAACC,QAAR,CAAH,EAAT,EAAiCmB,EAAtC,EAA0C,EAAEL,EAAE,GAAG,CAACK,EAAE,GAAGD,EAAE,CAACE,IAAH,EAAN,EAAiBC,IAAxB,CAA1C,EAAyEP,EAAE,GAAG,IAA9E,EAAoF;AAAED,MAAAA,IAAI,CAACS,IAAL,CAAUH,EAAE,CAACI,KAAb;;AAAqB,UAAIlB,CAAC,IAAIQ,IAAI,CAACW,MAAL,KAAgBnB,CAAzB,EAA4B;AAAQ;AAAE,GAAvJ,CAAwJ,OAAOoB,GAAP,EAAY;AAAEV,IAAAA,EAAE,GAAG,IAAL;AAAWC,IAAAA,EAAE,GAAGS,GAAL;AAAW,GAA5L,SAAqM;AAAE,QAAI;AAAE,UAAI,CAACX,EAAD,IAAOI,EAAE,CAAC,QAAD,CAAF,IAAgB,IAA3B,EAAiCA,EAAE,CAAC,QAAD,CAAF;AAAiB,KAAxD,SAAiE;AAAE,UAAIH,EAAJ,EAAQ,MAAMC,EAAN;AAAW;AAAE;;AAAC,SAAOH,IAAP;AAAc;;AAE5gB,SAASP,eAAT,CAAyBF,GAAzB,EAA8B;AAAE,MAAIsB,KAAK,CAACC,OAAN,CAAcvB,GAAd,CAAJ,EAAwB,OAAOA,GAAP;AAAa;;AAErE,SAASwB,eAAT,CAAyBC,QAAzB,EAAmCC,WAAnC,EAAgD;AAAE,MAAI,EAAED,QAAQ,YAAYC,WAAtB,CAAJ,EAAwC;AAAE,UAAM,IAAIrB,SAAJ,CAAc,mCAAd,CAAN;AAA2D;AAAE;;AAEzJ,SAASsB,iBAAT,CAA2BC,MAA3B,EAAmCC,KAAnC,EAA0C;AAAE,OAAK,IAAI5B,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG4B,KAAK,CAACT,MAA1B,EAAkCnB,CAAC,EAAnC,EAAuC;AAAE,QAAI6B,UAAU,GAAGD,KAAK,CAAC5B,CAAD,CAAtB;AAA2B6B,IAAAA,UAAU,CAACC,UAAX,GAAwBD,UAAU,CAACC,UAAX,IAAyB,KAAjD;AAAwDD,IAAAA,UAAU,CAACE,YAAX,GAA0B,IAA1B;AAAgC,QAAI,WAAWF,UAAf,EAA2BA,UAAU,CAACG,QAAX,GAAsB,IAAtB;AAA4B3B,IAAAA,MAAM,CAAC4B,cAAP,CAAsBN,MAAtB,EAA8BE,UAAU,CAACK,GAAzC,EAA8CL,UAA9C;AAA4D;AAAE;;AAE7T,SAASM,YAAT,CAAsBV,WAAtB,EAAmCW,UAAnC,EAA+CC,WAA/C,EAA4D;AAAE,MAAID,UAAJ,EAAgBV,iBAAiB,CAACD,WAAW,CAAC5B,SAAb,EAAwBuC,UAAxB,CAAjB;AAAsD,MAAIC,WAAJ,EAAiBX,iBAAiB,CAACD,WAAD,EAAcY,WAAd,CAAjB;AAA6C,SAAOZ,WAAP;AAAqB;;AAEvN,SAASa,0BAAT,CAAoCC,IAApC,EAA0ChC,IAA1C,EAAgD;AAAE,MAAIA,IAAI,KAAKf,OAAO,CAACe,IAAD,CAAP,KAAkB,QAAlB,IAA8B,OAAOA,IAAP,KAAgB,UAAnD,CAAR,EAAwE;AAAE,WAAOA,IAAP;AAAc;;AAAC,SAAOiC,sBAAsB,CAACD,IAAD,CAA7B;AAAsC;;AAEjL,SAASC,sBAAT,CAAgCD,IAAhC,EAAsC;AAAE,MAAIA,IAAI,KAAK,KAAK,CAAlB,EAAqB;AAAE,UAAM,IAAIE,cAAJ,CAAmB,2DAAnB,CAAN;AAAwF;;AAAC,SAAOF,IAAP;AAAc;;AAEtK,SAASG,IAAT,CAAcf,MAAd,EAAsBgB,QAAtB,EAAgCC,QAAhC,EAA0C;AAAE,MAAI,OAAOC,OAAP,KAAmB,WAAnB,IAAkCA,OAAO,CAACC,GAA9C,EAAmD;AAAEJ,IAAAA,IAAI,GAAGG,OAAO,CAACC,GAAf;AAAqB,GAA1E,MAAgF;AAAEJ,IAAAA,IAAI,GAAG,SAASA,IAAT,CAAcf,MAAd,EAAsBgB,QAAtB,EAAgCC,QAAhC,EAA0C;AAAE,UAAIG,IAAI,GAAGC,cAAc,CAACrB,MAAD,EAASgB,QAAT,CAAzB;;AAA6C,UAAI,CAACI,IAAL,EAAW;AAAQ,UAAIE,IAAI,GAAG5C,MAAM,CAAC6C,wBAAP,CAAgCH,IAAhC,EAAsCJ,QAAtC,CAAX;;AAA4D,UAAIM,IAAI,CAACH,GAAT,EAAc;AAAE,eAAOG,IAAI,CAACH,GAAL,CAASvC,IAAT,CAAcqC,QAAd,CAAP;AAAiC;;AAAC,aAAOK,IAAI,CAAC/B,KAAZ;AAAoB,KAArP;AAAwP;;AAAC,SAAOwB,IAAI,CAACf,MAAD,EAASgB,QAAT,EAAmBC,QAAQ,IAAIjB,MAA/B,CAAX;AAAoD;;AAE3a,SAASqB,cAAT,CAAwBG,MAAxB,EAAgCR,QAAhC,EAA0C;AAAE,SAAO,CAACtC,MAAM,CAACR,SAAP,CAAiBuD,cAAjB,CAAgC7C,IAAhC,CAAqC4C,MAArC,EAA6CR,QAA7C,CAAR,EAAgE;AAAEQ,IAAAA,MAAM,GAAGE,eAAe,CAACF,MAAD,CAAxB;AAAkC,QAAIA,MAAM,KAAK,IAAf,EAAqB;AAAQ;;AAAC,SAAOA,MAAP;AAAgB;;AAE9L,SAASE,eAAT,CAAyBC,CAAzB,EAA4B;AAAED,EAAAA,eAAe,GAAGhD,MAAM,CAACkD,cAAP,GAAwBlD,MAAM,CAACmD,cAA/B,GAAgD,SAASH,eAAT,CAAyBC,CAAzB,EAA4B;AAAE,WAAOA,CAAC,CAACG,SAAF,IAAepD,MAAM,CAACmD,cAAP,CAAsBF,CAAtB,CAAtB;AAAiD,GAAjJ;AAAmJ,SAAOD,eAAe,CAACC,CAAD,CAAtB;AAA4B;;AAE7M,SAASI,SAAT,CAAmBC,QAAnB,EAA6BC,UAA7B,EAAyC;AAAE,MAAI,OAAOA,UAAP,KAAsB,UAAtB,IAAoCA,UAAU,KAAK,IAAvD,EAA6D;AAAE,UAAM,IAAIxD,SAAJ,CAAc,oDAAd,CAAN;AAA4E;;AAACuD,EAAAA,QAAQ,CAAC9D,SAAT,GAAqBQ,MAAM,CAACwD,MAAP,CAAcD,UAAU,IAAIA,UAAU,CAAC/D,SAAvC,EAAkD;AAAED,IAAAA,WAAW,EAAE;AAAEsB,MAAAA,KAAK,EAAEyC,QAAT;AAAmB3B,MAAAA,QAAQ,EAAE,IAA7B;AAAmCD,MAAAA,YAAY,EAAE;AAAjD;AAAf,GAAlD,CAArB;AAAkJ,MAAI6B,UAAJ,EAAgBE,eAAe,CAACH,QAAD,EAAWC,UAAX,CAAf;AAAwC;;AAEjY,SAASE,eAAT,CAAyBR,CAAzB,EAA4BS,CAA5B,EAA+B;AAAED,EAAAA,eAAe,GAAGzD,MAAM,CAACkD,cAAP,IAAyB,SAASO,eAAT,CAAyBR,CAAzB,EAA4BS,CAA5B,EAA+B;AAAET,IAAAA,CAAC,CAACG,SAAF,GAAcM,CAAd;AAAiB,WAAOT,CAAP;AAAW,GAAxG;;AAA0G,SAAOQ,eAAe,CAACR,CAAD,EAAIS,CAAJ,CAAtB;AAA+B;;AAE1K,OAAOC,UAAP,MAAuB,UAAvB;AACA,SAASC,SAAT,QAA0B,qBAA1B;AACA,SAASC,QAAT,EAAmBC,UAAnB,QAAqC,sBAArC;AACA,OAAOC,YAAP,MAAyB,oBAAzB;AACA,SAASC,cAAT,QAA+B,eAA/B;AACA,SAASC,mBAAT,EAA8BC,kBAA9B,EAAkDC,0BAAlD,EAA8EC,yBAA9E,QAA+G,SAA/G;AACA,OAAOC,KAAP,MAAkB,SAAlB;AACA,OAAOC,YAAP,MAAyB,gBAAzB;AACA,OAAOC,gBAAP,MAA6B,oBAA7B;AACA;;;;;;;AAOA,IAAIC,QAAQ,GACZ,aACA,UAAUC,WAAV,EAAuB;AACrBpB,EAAAA,SAAS,CAACmB,QAAD,EAAWC,WAAX,CAAT;;AAEA,WAASD,QAAT,CAAkBE,WAAlB,EAA+B;AAC7B,QAAIC,KAAJ;;AAEAzD,IAAAA,eAAe,CAAC,IAAD,EAAOsD,QAAP,CAAf;;AAEAG,IAAAA,KAAK,GAAG1C,0BAA0B,CAAC,IAAD,EAAOe,eAAe,CAACwB,QAAD,CAAf,CAA0BtE,IAA1B,CAA+B,IAA/B,EAAqCwE,WAArC,CAAP,CAAlC;AACA;;;;;;;AAOAC,IAAAA,KAAK,CAACC,YAAN,GAAqB,IAAIb,YAAJ,CAAiB5B,sBAAsB,CAACwC,KAAD,CAAvC,CAArB;AACA;;;;;;;AAOAA,IAAAA,KAAK,CAACE,YAAN,GAAqB,IAAIP,YAAJ,CAAiBK,KAAK,CAACG,GAAvB,CAArB;AACA;;;;;;;AAOAH,IAAAA,KAAK,CAACI,KAAN,GAAc,IAAIV,KAAJ,CAAUM,KAAK,CAACG,GAAhB,EAAqBH,KAAK,CAACE,YAA3B,CAAd;AACA;;;;;;;AAOAF,IAAAA,KAAK,CAACK,gBAAN,GAAyB,IAAIT,gBAAJ,CAAqBI,KAAK,CAACI,KAA3B,CAAzB;AACA;;;;;;;;AAQAJ,IAAAA,KAAK,CAACM,cAAN,GAAuB,KAAvB;AACA,WAAON,KAAP;AACD;AACD;;;;;;;;AAQA7C,EAAAA,YAAY,CAAC0C,QAAD,EAAW,CAAC;AACtB3C,IAAAA,GAAG,EAAE,WADiB;AAEtBhB,IAAAA,KAAK,EAAE,SAASqE,SAAT,GAAqB;AAC1B;AACA,aAAO,KAAKJ,GAAL,CAASK,WAAT,GAAuBC,QAAvB,GAAkC,IAAlC,GAAyC,KAAhD;AACD;AACD;;;;AANsB,GAAD,EAUpB;AACDvD,IAAAA,GAAG,EAAE,cADJ;AAEDhB,IAAAA,KAAK,EAAE,SAASwE,YAAT,GAAwB;AAC7B,UAAIC,MAAM,GAAG,IAAb;;AAEA,UAAI,KAAKC,OAAT,EAAkB;AAChB;AACD;;AAED,UAAIC,QAAQ,GAAG,KAAKV,GAAL,CAASK,WAAT,GAAuBC,QAAtC;;AAEA,UAAIvB,QAAQ,CAAC2B,QAAD,CAAZ,EAAwB;AACtB,YAAI3B,QAAQ,CAAC2B,QAAQ,CAACC,SAAV,CAAZ,EAAkC;AAChC3B,UAAAA,UAAU,CAAC0B,QAAQ,CAACC,SAAV,EAAqB,UAAU5E,KAAV,EAAiB6E,IAAjB,EAAuB;AACpD,mBAAOJ,MAAM,CAACK,WAAP,CAAmBD,IAAnB,EAAyB7E,KAAzB,CAAP;AACD,WAFS,CAAV;AAGD;AACF;;AAED,WAAK+E,OAAL,CAAa,iBAAb,EAAgC,YAAY;AAC1C,eAAON,MAAM,CAACO,iBAAP,CAAyBC,KAAzB,CAA+BR,MAA/B,EAAuCS,SAAvC,CAAP;AACD,OAFD;AAGA,WAAKH,OAAL,CAAa,gBAAb,EAA+B,YAAY;AACzC,eAAON,MAAM,CAACU,gBAAP,CAAwBF,KAAxB,CAA8BR,MAA9B,EAAsCS,SAAtC,CAAP;AACD,OAFD;AAGA,WAAKH,OAAL,CAAa,gBAAb,EAA+B,YAAY;AACzC,eAAON,MAAM,CAACW,gBAAP,CAAwBH,KAAxB,CAA8BR,MAA9B,EAAsCS,SAAtC,CAAP;AACD,OAFD;AAGA,WAAKH,OAAL,CAAa,eAAb,EAA8B,YAAY;AACxC,eAAON,MAAM,CAACY,eAAP,EAAP;AACD,OAFD;AAGA,WAAKN,OAAL,CAAa,gBAAb,EAA+B,YAAY;AACzC,eAAON,MAAM,CAACa,gBAAP,CAAwBL,KAAxB,CAA8BR,MAA9B,EAAsCS,SAAtC,CAAP;AACD,OAFD;AAGA,WAAKH,OAAL,CAAa,gBAAb,EAA+B,YAAY;AACzC,eAAON,MAAM,CAACc,gBAAP,CAAwBN,KAAxB,CAA8BR,MAA9B,EAAsCS,SAAtC,CAAP;AACD,OAFD;AAGA,WAAKH,OAAL,CAAa,oBAAb,EAAmC,YAAY;AAC7C,eAAON,MAAM,CAACe,oBAAP,CAA4BP,KAA5B,CAAkCR,MAAlC,EAA0CS,SAA1C,CAAP;AACD,OAFD;AAGA,WAAKH,OAAL,CAAa,uBAAb,EAAsC,YAAY;AAChD,eAAON,MAAM,CAACe,oBAAP,CAA4BP,KAA5B,CAAkCR,MAAlC,EAA0CS,SAA1C,CAAP;AACD,OAFD;AAGA,WAAKH,OAAL,CAAa,kBAAb,EAAiC,YAAY;AAC3C,eAAON,MAAM,CAACgB,kBAAP,CAA0BR,KAA1B,CAAgCR,MAAhC,EAAwCS,SAAxC,CAAP;AACD,OAFD;AAGA,WAAKH,OAAL,CAAa,iBAAb,EAAgC,YAAY;AAC1C,eAAON,MAAM,CAACiB,iBAAP,CAAyBT,KAAzB,CAA+BR,MAA/B,EAAuCS,SAAvC,CAAP;AACD,OAFD;AAGA,WAAKH,OAAL,CAAa,iBAAb,EAAgC,YAAY;AAC1C,eAAON,MAAM,CAACkB,iBAAP,CAAyBV,KAAzB,CAA+BR,MAA/B,EAAuCS,SAAvC,CAAP;AACD,OAFD;AAGA,WAAKH,OAAL,CAAa,iBAAb,EAAgC,YAAY;AAC1C,eAAON,MAAM,CAACmB,iBAAP,CAAyBX,KAAzB,CAA+BR,MAA/B,EAAuCS,SAAvC,CAAP;AACD,OAFD;AAGA,WAAKH,OAAL,CAAa,iBAAb,EAAgC,YAAY;AAC1C,eAAON,MAAM,CAACoB,iBAAP,CAAyBZ,KAAzB,CAA+BR,MAA/B,EAAuCS,SAAvC,CAAP;AACD,OAFD;AAGA,WAAKH,OAAL,CAAa,gBAAb,EAA+B,YAAY;AACzC,eAAON,MAAM,CAACqB,gBAAP,CAAwBb,KAAxB,CAA8BR,MAA9B,EAAsCS,SAAtC,CAAP;AACD,OAFD;AAGA,WAAKH,OAAL,CAAa,mBAAb,EAAkC,YAAY;AAC5C,eAAON,MAAM,CAACsB,mBAAP,CAA2Bd,KAA3B,CAAiCR,MAAjC,EAAyCS,SAAzC,CAAP;AACD,OAFD;AAGA,WAAKH,OAAL,CAAa,YAAb,EAA2B,YAAY;AACrC,eAAON,MAAM,CAACuB,YAAP,CAAoBf,KAApB,CAA0BR,MAA1B,EAAkCS,SAAlC,CAAP;AACD,OAFD;AAGA,WAAKhB,KAAL,CAAW+B,YAAX,CAAwB,kBAAxB,EAA4C,YAAY;AACtD,eAAOxB,MAAM,CAACyB,uBAAP,CAA+BjB,KAA/B,CAAqCR,MAArC,EAA6CS,SAA7C,CAAP;AACD,OAFD;;AAIA1D,MAAAA,IAAI,CAACW,eAAe,CAACwB,QAAQ,CAAChF,SAAV,CAAhB,EAAsC,cAAtC,EAAsD,IAAtD,CAAJ,CAAgEU,IAAhE,CAAqE,IAArE;AACD;AACD;;;;AAzEC,GAVoB,EAuFpB;AACD2B,IAAAA,GAAG,EAAE,eADJ;AAEDhB,IAAAA,KAAK,EAAE,SAASmG,aAAT,GAAyB;AAC9B3E,MAAAA,IAAI,CAACW,eAAe,CAACwB,QAAQ,CAAChF,SAAV,CAAhB,EAAsC,eAAtC,EAAuD,IAAvD,CAAJ,CAAiEU,IAAjE,CAAsE,IAAtE;AACD;AACD;;;;;;;;AALC,GAvFoB,EAoGpB;AACD2B,IAAAA,GAAG,EAAE,cADJ;AAEDhB,IAAAA,KAAK,EAAE,SAASoG,YAAT,CAAsBC,GAAtB,EAA2BC,MAA3B,EAAmC;AACxC,UAAIC,IAAI,GAAG,KAAKrC,KAAL,CAAWsC,SAAX,CAAqBH,GAArB,EAA0BC,MAA1B,CAAX;AACA,aAAOC,IAAI,GAAGA,IAAI,CAACE,QAAL,MAAmBF,IAAI,CAACG,QAAL,EAAtB,GAAwC,KAAK,CAAxD;AACD;AACD;;;;;;;;AANC,GApGoB,EAkHpB;AACD1F,IAAAA,GAAG,EAAE,sBADJ;AAEDhB,IAAAA,KAAK,EAAE,SAAS2G,oBAAT,CAA8BN,GAA9B,EAAmCC,MAAnC,EAA2C;AAChD,aAAO,KAAKpC,KAAL,CAAWsC,SAAX,CAAqBH,GAArB,EAA0BC,MAA1B,MAAsC,IAA7C;AACD;AACD;;;;AALC,GAlHoB,EA2HpB;AACDtF,IAAAA,GAAG,EAAE,aADJ;AAEDhB,IAAAA,KAAK,EAAE,SAAS4G,WAAT,GAAuB;AAC5B,WAAK1C,KAAL,CAAW0C,WAAX;AACD;AACD;;;;AALC,GA3HoB,EAoIpB;AACD5F,IAAAA,GAAG,EAAE,iBADJ;AAEDhB,IAAAA,KAAK,EAAE,SAAS6G,eAAT,GAA2B;AAChC,WAAK3C,KAAL,CAAW2C,eAAX;AACD;AACD;;;;AALC,GApIoB,EA6IpB;AACD7F,IAAAA,GAAG,EAAE,sBADJ;AAEDhB,IAAAA,KAAK,EAAE,SAAS8G,oBAAT,GAAgC;AACrC,WAAK5C,KAAL,CAAW4C,oBAAX;AACD;AACD;;;;;;;AALC,GA7IoB,EAyJpB;AACD9F,IAAAA,GAAG,EAAE,aADJ;AAEDhB,IAAAA,KAAK,EAAE,SAAS8E,WAAT,CAAqBD,IAArB,EAA2B7E,KAA3B,EAAkC;AACvC,WAAKkE,KAAL,CAAWY,WAAX,CAAuBD,IAAvB,EAA6B7E,KAA7B;AACD;AACD;;;;;;;AALC,GAzJoB,EAqKpB;AACDgB,IAAAA,GAAG,EAAE,aADJ;AAEDhB,IAAAA,KAAK,EAAE,SAAS+G,WAAT,CAAqBlC,IAArB,EAA2B;AAChC,aAAO,KAAKX,KAAL,CAAW6C,WAAX,CAAuBlC,IAAvB,CAAP;AACD;AACD;;;;;;;AALC,GArKoB,EAiLpB;AACD7D,IAAAA,GAAG,EAAE,yBADJ;AAEDhB,IAAAA,KAAK,EAAE,SAASkG,uBAAT,CAAiCc,KAAjC,EAAwC;AAC7C,UAAI,KAAK5C,cAAT,EAAyB;AACvB,aAAKA,cAAL,GAAsB,KAAtB;AACA;AACD;;AAED,UAAIH,GAAG,GAAG,KAAKA,GAAf;AACAlB,MAAAA,SAAS,CAACiE,KAAD,EAAQ,UAAUC,IAAV,EAAgB;AAC/B,YAAIZ,GAAG,GAAGY,IAAI,CAACZ,GAAf;AAAA,YACIC,MAAM,GAAGW,IAAI,CAACX,MADlB;AAEArC,QAAAA,GAAG,CAACiD,YAAJ,CAAiBjD,GAAG,CAACkD,aAAJ,CAAkBd,GAAlB,EAAuBC,MAAvB,CAAjB,EAAiDrC,GAAG,CAACmD,WAAJ,CAAgBf,GAAhB,EAAqBC,MAArB,CAAjD,EAA+E,YAAY,CAAE,CAA7F;AACD,OAJQ,CAAT;AAKArC,MAAAA,GAAG,CAACoD,MAAJ;AACD;AACD;;;;;;;;;;;AAhBC,GAjLoB,EA4MpB;AACDrG,IAAAA,GAAG,EAAE,cADJ;AAEDhB,IAAAA,KAAK,EAAE,SAASgG,YAAT,CAAsBK,GAAtB,EAA2BC,MAA3B,EAAmCgB,WAAnC,EAAgDC,MAAhD,EAAwD;AAC7D,UAAIA,MAAM,KAAK,KAAX,IAAoB,KAAKZ,oBAAL,CAA0BN,GAA1B,EAA+BC,MAA/B,CAAxB,EAAgE;AAC9DgB,QAAAA,WAAW,CAACtH,KAAZ,GAAoB,KAAKoG,YAAL,CAAkBC,GAAlB,EAAuBC,MAAvB,CAApB;AACD,OAFD,MAEO,IAAIiB,MAAM,KAAK,KAAX,IAAoBnE,mBAAmB,CAACkE,WAAW,CAACtH,KAAb,CAA3C,EAAgE;AACrEsH,QAAAA,WAAW,CAACtH,KAAZ,GAAoBqD,kBAAkB,CAACiE,WAAW,CAACtH,KAAb,CAAtC;AACD;AACF;AACD;;;;;;;;AATC,GA5MoB,EA6NpB;AACDgB,IAAAA,GAAG,EAAE,qBADJ;AAEDhB,IAAAA,KAAK,EAAE,SAAS+F,mBAAT,CAA6B/F,KAA7B,EAAoC;AACzC,UAAIwH,WAAW,GAAGxH,KAAlB;;AAEA,UAAIsD,0BAA0B,CAACkE,WAAD,CAA9B,EAA6C;AAC3CA,QAAAA,WAAW,GAAGjE,yBAAyB,CAACiE,WAAD,CAAvC;AACD;;AAED,aAAOA,WAAP;AACD;AACD;;;;;;;;;AAXC,GA7NoB,EAiPpB;AACDxG,IAAAA,GAAG,EAAE,kBADJ;AAEDhB,IAAAA,KAAK,EAAE,SAAS8F,gBAAT,CAA0B9F,KAA1B,EAAiCqG,GAAjC,EAAsCoB,IAAtC,EAA4C;AACjD,UAAInB,MAAM,GAAG,KAAKrC,GAAL,CAASyD,SAAT,CAAmBD,IAAnB,CAAb;AACA,UAAIE,aAAa,GAAG3H,KAApB;;AAEA,UAAI,KAAK2G,oBAAL,CAA0BN,GAA1B,EAA+BC,MAA/B,CAAJ,EAA4C;AAC1CqB,QAAAA,aAAa,GAAG,KAAKvB,YAAL,CAAkBC,GAAlB,EAAuBC,MAAvB,CAAhB;AACD;;AAED,aAAOqB,aAAP;AACD;AACD;;;;;;;;AAZC,GAjPoB,EAqQpB;AACD3G,IAAAA,GAAG,EAAE,sBADJ;AAEDhB,IAAAA,KAAK,EAAE,SAASwF,oBAAT,CAA8BoC,OAA9B,EAAuCC,MAAvC,EAA+C;AACpD,UAAIC,MAAM,GAAG,IAAb;;AAEA,UAAID,MAAM,KAAK,UAAf,EAA2B;AACzB;AACD;;AAED,WAAK7D,YAAL,CAAkB+D,YAAlB;AACAhF,MAAAA,SAAS,CAAC6E,OAAD,EAAU,UAAUI,KAAV,EAAiB;AAClC,YAAIC,KAAK,GAAGrJ,cAAc,CAACoJ,KAAD,EAAQ,CAAR,CAA1B;AAAA,YACI3B,GAAG,GAAG4B,KAAK,CAAC,CAAD,CADf;AAAA,YAEI3B,MAAM,GAAG2B,KAAK,CAAC,CAAD,CAFlB;AAAA,YAGIC,QAAQ,GAAGD,KAAK,CAAC,CAAD,CAHpB;AAAA,YAIIE,QAAQ,GAAGF,KAAK,CAAC,CAAD,CAJpB;;AAMA,YAAIG,cAAc,GAAGN,MAAM,CAAC7D,GAAP,CAAWyD,SAAX,CAAqBpB,MAArB,CAArB;;AAEA,YAAI+B,WAAW,GAAGP,MAAM,CAACQ,CAAP,CAASC,aAAT,CAAuBlC,GAAvB,CAAlB;;AAEA,YAAIrG,KAAK,GAAGmI,QAAZ;;AAEA,YAAI/E,mBAAmB,CAACpD,KAAD,CAAvB,EAAgC;AAC9BA,UAAAA,KAAK,GAAGqD,kBAAkB,CAACrD,KAAD,CAA1B;AACD;;AAED8H,QAAAA,MAAM,CAAC9D,YAAP,CAAoBwE,cAApB,CAAmCH,WAAnC,EAAgDD,cAAhD,EAAgEpI,KAAhE;;AAEA,YAAIkI,QAAQ,KAAKlI,KAAjB,EAAwB;AACtB8H,UAAAA,MAAM,CAAC5D,KAAP,CAAauE,YAAb,CAA0BJ,WAA1B,EAAuCD,cAAvC,EAAuDpI,KAAvD;AACD;AACF,OAtBQ,CAAT;AAuBA,WAAK4G,WAAL;AACD;AACD;;;;;;;;;AAnCC,GArQoB,EAiTpB;AACD5F,IAAAA,GAAG,EAAE,mBADJ;AAEDhB,IAAAA,KAAK,EAAE,SAAS2F,iBAAT,CAA2BU,GAA3B,EAAgCqC,MAAhC,EAAwCb,MAAxC,EAAgD;AACrD,UAAIA,MAAM,KAAK,eAAf,EAAgC;AAC9B,aAAK1D,gBAAL,CAAsBwE,OAAtB;AACD;AACF;AACD;;;;;;;;;AAPC,GAjToB,EAiUpB;AACD3H,IAAAA,GAAG,EAAE,kBADJ;AAEDhB,IAAAA,KAAK,EAAE,SAASoF,gBAAT,CAA0BiB,GAA1B,EAA+BqC,MAA/B,EAAuCb,MAAvC,EAA+C;AACpD,WAAK3D,KAAL,CAAW0E,YAAX,CAAwBC,YAAxB,CAAqC,YAArC,EAAmDxC,GAAnD,EAAwDqC,MAAxD,EAAgEb,MAAM,KAAK,eAA3E;AACD;AACD;;;;;;;;AALC,GAjUoB,EA8UpB;AACD7G,IAAAA,GAAG,EAAE,mBADJ;AAEDhB,IAAAA,KAAK,EAAE,SAAS6F,iBAAT,CAA2BQ,GAA3B,EAAgCqC,MAAhC,EAAwC;AAC7C,WAAKvE,gBAAL,CAAsB2E,IAAtB,CAA2B,KAA3B,EAAkCzC,GAAlC,EAAuCqC,MAAvC;AACD;AACD;;;;;;;;AALC,GA9UoB,EA2VpB;AACD1H,IAAAA,GAAG,EAAE,kBADJ;AAEDhB,IAAAA,KAAK,EAAE,SAASuF,gBAAT,CAA0Bc,GAA1B,EAA+BqC,MAA/B,EAAuC;AAC5C,WAAKxE,KAAL,CAAW0E,YAAX,CAAwBC,YAAxB,CAAqC,YAArC,EAAmDxC,GAAnD,EAAwDqC,MAAxD;AACD;AACD;;;;;;;;;AALC,GA3VoB,EAyWpB;AACD1H,IAAAA,GAAG,EAAE,mBADJ;AAEDhB,IAAAA,KAAK,EAAE,SAAS0F,iBAAT,CAA2BY,MAA3B,EAAmCoC,MAAnC,EAA2Cb,MAA3C,EAAmD;AACxD,UAAIA,MAAM,KAAK,eAAf,EAAgC;AAC9B,aAAK1D,gBAAL,CAAsBwE,OAAtB;AACD;AACF;AACD;;;;;;;;;AAPC,GAzWoB,EAyXpB;AACD3H,IAAAA,GAAG,EAAE,kBADJ;AAEDhB,IAAAA,KAAK,EAAE,SAASmF,gBAAT,CAA0BmB,MAA1B,EAAkCoC,MAAlC,EAA0Cb,MAA1C,EAAkD;AACvD,WAAK3D,KAAL,CAAW0E,YAAX,CAAwBC,YAAxB,CAAqC,eAArC,EAAsDvC,MAAtD,EAA8DoC,MAA9D,EAAsEb,MAAM,KAAK,eAAjF;AACD;AACD;;;;;;;;AALC,GAzXoB,EAsYpB;AACD7G,IAAAA,GAAG,EAAE,mBADJ;AAEDhB,IAAAA,KAAK,EAAE,SAAS4F,iBAAT,CAA2BU,MAA3B,EAAmCoC,MAAnC,EAA2C;AAChD,WAAKvE,gBAAL,CAAsB2E,IAAtB,CAA2B,QAA3B,EAAqCxC,MAArC,EAA6CoC,MAA7C;AACD;AACD;;;;;;;;AALC,GAtYoB,EAmZpB;AACD1H,IAAAA,GAAG,EAAE,kBADJ;AAEDhB,IAAAA,KAAK,EAAE,SAASsF,gBAAT,CAA0BgB,MAA1B,EAAkCoC,MAAlC,EAA0C;AAC/C,WAAKxE,KAAL,CAAW0E,YAAX,CAAwBC,YAAxB,CAAqC,eAArC,EAAsDvC,MAAtD,EAA8DoC,MAA9D;AACD;AACD;;;;;;;;AALC,GAnZoB,EAgapB;AACD1H,IAAAA,GAAG,EAAE,oBADJ;AAEDhB,IAAAA,KAAK,EAAE,SAASyF,kBAAT,CAA4Ba,MAA5B,EAAoCyC,KAApC,EAA2C;AAChD,WAAK7E,KAAL,CAAW0E,YAAX,CAAwBI,YAAxB,CAAqC,gBAArC,EAAuD1C,MAAvD,EAA+DyC,KAA/D;AACD;AACD;;;;;;;;AALC,GAhaoB,EA6apB;AACD/H,IAAAA,GAAG,EAAE,mBADJ;AAEDhB,IAAAA,KAAK,EAAE,SAASgF,iBAAT,CAA2BsB,MAA3B,EAAmCyC,KAAnC,EAA0C;AAC/C,WAAK7E,KAAL,CAAW0E,YAAX,CAAwBC,YAAxB,CAAqC,gBAArC,EAAuDvC,MAAvD,EAA+DyC,KAA/D;AACD;AACD;;;;;;AALC,GA7aoB,EAwbpB;AACD/H,IAAAA,GAAG,EAAE,iBADJ;AAEDhB,IAAAA,KAAK,EAAE,SAASqF,eAAT,GAA2B;AAChC,WAAKjB,cAAL,GAAsB,IAAtB;AACA,WAAKyC,eAAL;AACD;AACD;;;;AANC,GAxboB,EAkcpB;AACD7F,IAAAA,GAAG,EAAE,SADJ;AAEDhB,IAAAA,KAAK,EAAE,SAASiJ,OAAT,GAAmB;AACxB,WAAKjF,YAAL,CAAkBiF,OAAlB;AACA,WAAKjF,YAAL,GAAoB,IAApB;AACA,WAAKE,KAAL,CAAW+E,OAAX;AACA,WAAK/E,KAAL,GAAa,IAAb;;AAEA1C,MAAAA,IAAI,CAACW,eAAe,CAACwB,QAAQ,CAAChF,SAAV,CAAhB,EAAsC,SAAtC,EAAiD,IAAjD,CAAJ,CAA2DU,IAA3D,CAAgE,IAAhE;AACD;AATA,GAlcoB,CAAX,CAAZ;;AA8cA,SAAOsE,QAAP;AACD,CA3gBD,CA2gBEb,UA3gBF,CAFA;;AA+gBAK,cAAc,CAAC,UAAD,EAAaQ,QAAb,CAAd;AACA,eAAeA,QAAf","sourcesContent":["import \"core-js/modules/es.symbol\";\nimport \"core-js/modules/es.symbol.description\";\nimport \"core-js/modules/es.symbol.iterator\";\nimport \"core-js/modules/es.array.iterator\";\nimport \"core-js/modules/es.object.get-own-property-descriptor\";\nimport \"core-js/modules/es.object.get-prototype-of\";\nimport \"core-js/modules/es.object.set-prototype-of\";\nimport \"core-js/modules/es.object.to-string\";\nimport \"core-js/modules/es.reflect.get\";\nimport \"core-js/modules/es.regexp.to-string\";\nimport \"core-js/modules/es.string.iterator\";\nimport \"core-js/modules/web.dom-collections.iterator\";\n\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); }\n\nfunction _iterableToArrayLimit(arr, i) { if (!(Symbol.iterator in Object(arr) || Object.prototype.toString.call(arr) === \"[object Arguments]\")) { return; } var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _get(target, property, receiver) { if (typeof Reflect !== \"undefined\" && Reflect.get) { _get = Reflect.get; } else { _get = function _get(target, property, receiver) { var base = _superPropBase(target, property); if (!base) return; var desc = Object.getOwnPropertyDescriptor(base, property); if (desc.get) { return desc.get.call(receiver); } return desc.value; }; } return _get(target, property, receiver || target); }\n\nfunction _superPropBase(object, property) { while (!Object.prototype.hasOwnProperty.call(object, property)) { object = _getPrototypeOf(object); if (object === null) break; } return object; }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nimport BasePlugin from '../_base';\nimport { arrayEach } from '../../helpers/array';\nimport { isObject, objectEach } from '../../helpers/object';\nimport EventManager from '../../eventManager';\nimport { registerPlugin } from '../../plugins';\nimport { isFormulaExpression, toUpperCaseFormula, isFormulaExpressionEscaped, unescapeFormulaExpression } from './utils';\nimport Sheet from './sheet';\nimport DataProvider from './dataProvider';\nimport UndoRedoSnapshot from './undoRedoSnapshot';\n/**\n * The formulas plugin.\n *\n * @plugin Formulas\n * @experimental\n */\n\nvar Formulas =\n/*#__PURE__*/\nfunction (_BasePlugin) {\n  _inherits(Formulas, _BasePlugin);\n\n  function Formulas(hotInstance) {\n    var _this;\n\n    _classCallCheck(this, Formulas);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Formulas).call(this, hotInstance));\n    /**\n     * Instance of {@link EventManager}.\n     *\n     * @private\n     * @type {EventManager}\n     */\n\n    _this.eventManager = new EventManager(_assertThisInitialized(_this));\n    /**\n     * Instance of {@link DataProvider}.\n     *\n     * @private\n     * @type {DataProvider}\n     */\n\n    _this.dataProvider = new DataProvider(_this.hot);\n    /**\n     * Instance of {@link Sheet}.\n     *\n     * @private\n     * @type {Sheet}\n     */\n\n    _this.sheet = new Sheet(_this.hot, _this.dataProvider);\n    /**\n     * Instance of {@link UndoRedoSnapshot}.\n     *\n     * @private\n     * @type {UndoRedoSnapshot}\n     */\n\n    _this.undoRedoSnapshot = new UndoRedoSnapshot(_this.sheet);\n    /**\n     * Flag which indicates if table should be re-render after sheet recalculations.\n     *\n     * @type {Boolean}\n     * @default false\n     * @private\n     */\n\n    _this._skipRendering = false;\n    return _this;\n  }\n  /**\n   * Checks if the plugin is enabled in the handsontable settings. This method is executed in {@link Hooks#beforeInit}\n   * hook and if it returns `true` than the {@link Formulas#enablePlugin} method is called.\n   *\n   * @returns {Boolean}\n   */\n\n\n  _createClass(Formulas, [{\n    key: \"isEnabled\",\n    value: function isEnabled() {\n      /* eslint-disable no-unneeded-ternary */\n      return this.hot.getSettings().formulas ? true : false;\n    }\n    /**\n     * Enables the plugin functionality for this Handsontable instance.\n     */\n\n  }, {\n    key: \"enablePlugin\",\n    value: function enablePlugin() {\n      var _this2 = this;\n\n      if (this.enabled) {\n        return;\n      }\n\n      var settings = this.hot.getSettings().formulas;\n\n      if (isObject(settings)) {\n        if (isObject(settings.variables)) {\n          objectEach(settings.variables, function (value, name) {\n            return _this2.setVariable(name, value);\n          });\n        }\n      }\n\n      this.addHook('afterColumnSort', function () {\n        return _this2.onAfterColumnSort.apply(_this2, arguments);\n      });\n      this.addHook('afterCreateCol', function () {\n        return _this2.onAfterCreateCol.apply(_this2, arguments);\n      });\n      this.addHook('afterCreateRow', function () {\n        return _this2.onAfterCreateRow.apply(_this2, arguments);\n      });\n      this.addHook('afterLoadData', function () {\n        return _this2.onAfterLoadData();\n      });\n      this.addHook('afterRemoveCol', function () {\n        return _this2.onAfterRemoveCol.apply(_this2, arguments);\n      });\n      this.addHook('afterRemoveRow', function () {\n        return _this2.onAfterRemoveRow.apply(_this2, arguments);\n      });\n      this.addHook('afterSetDataAtCell', function () {\n        return _this2.onAfterSetDataAtCell.apply(_this2, arguments);\n      });\n      this.addHook('afterSetDataAtRowProp', function () {\n        return _this2.onAfterSetDataAtCell.apply(_this2, arguments);\n      });\n      this.addHook('beforeColumnSort', function () {\n        return _this2.onBeforeColumnSort.apply(_this2, arguments);\n      });\n      this.addHook('beforeCreateCol', function () {\n        return _this2.onBeforeCreateCol.apply(_this2, arguments);\n      });\n      this.addHook('beforeCreateRow', function () {\n        return _this2.onBeforeCreateRow.apply(_this2, arguments);\n      });\n      this.addHook('beforeRemoveCol', function () {\n        return _this2.onBeforeRemoveCol.apply(_this2, arguments);\n      });\n      this.addHook('beforeRemoveRow', function () {\n        return _this2.onBeforeRemoveRow.apply(_this2, arguments);\n      });\n      this.addHook('beforeValidate', function () {\n        return _this2.onBeforeValidate.apply(_this2, arguments);\n      });\n      this.addHook('beforeValueRender', function () {\n        return _this2.onBeforeValueRender.apply(_this2, arguments);\n      });\n      this.addHook('modifyData', function () {\n        return _this2.onModifyData.apply(_this2, arguments);\n      });\n      this.sheet.addLocalHook('afterRecalculate', function () {\n        return _this2.onSheetAfterRecalculate.apply(_this2, arguments);\n      });\n\n      _get(_getPrototypeOf(Formulas.prototype), \"enablePlugin\", this).call(this);\n    }\n    /**\n     * Disables the plugin functionality for this Handsontable instance.\n     */\n\n  }, {\n    key: \"disablePlugin\",\n    value: function disablePlugin() {\n      _get(_getPrototypeOf(Formulas.prototype), \"disablePlugin\", this).call(this);\n    }\n    /**\n     * Returns cell value (evaluated from formula expression) at specified cell coords.\n     *\n     * @param {Number} row Row index.\n     * @param {Number} column Column index.\n     * @returns {*}\n     */\n\n  }, {\n    key: \"getCellValue\",\n    value: function getCellValue(row, column) {\n      var cell = this.sheet.getCellAt(row, column);\n      return cell ? cell.getError() || cell.getValue() : void 0;\n    }\n    /**\n     * Checks if there are any formula evaluations made under specific cell coords.\n     *\n     * @param {Number} row Row index.\n     * @param {Number} column Column index.\n     * @returns {Boolean}\n     */\n\n  }, {\n    key: \"hasComputedCellValue\",\n    value: function hasComputedCellValue(row, column) {\n      return this.sheet.getCellAt(row, column) !== null;\n    }\n    /**\n     * Recalculates all formulas (an algorithm will choose the best method of calculation).\n     */\n\n  }, {\n    key: \"recalculate\",\n    value: function recalculate() {\n      this.sheet.recalculate();\n    }\n    /**\n     * Recalculates all formulas (rebuild dependencies from scratch - slow approach).\n     */\n\n  }, {\n    key: \"recalculateFull\",\n    value: function recalculateFull() {\n      this.sheet.recalculateFull();\n    }\n    /**\n     * Recalculates all formulas (recalculate only changed cells - fast approach).\n     */\n\n  }, {\n    key: \"recalculateOptimized\",\n    value: function recalculateOptimized() {\n      this.sheet.recalculateOptimized();\n    }\n    /**\n     * Sets predefined variable name which can be visible while parsing formula expression.\n     *\n     * @param {String} name Variable name.\n     * @param {*} value Variable value.\n     */\n\n  }, {\n    key: \"setVariable\",\n    value: function setVariable(name, value) {\n      this.sheet.setVariable(name, value);\n    }\n    /**\n     * Returns variable name.\n     *\n     * @param {String} name Variable name.\n     * @returns {*}\n     */\n\n  }, {\n    key: \"getVariable\",\n    value: function getVariable(name) {\n      return this.sheet.getVariable(name);\n    }\n    /**\n     * Local hook listener for after sheet recalculation.\n     *\n     * @private\n     * @param {Array} cells An array of recalculated/changed cells.\n     */\n\n  }, {\n    key: \"onSheetAfterRecalculate\",\n    value: function onSheetAfterRecalculate(cells) {\n      if (this._skipRendering) {\n        this._skipRendering = false;\n        return;\n      }\n\n      var hot = this.hot;\n      arrayEach(cells, function (_ref) {\n        var row = _ref.row,\n            column = _ref.column;\n        hot.validateCell(hot.getDataAtCell(row, column), hot.getCellMeta(row, column), function () {});\n      });\n      hot.render();\n    }\n    /**\n     * On modify row data listener. It overwrites raw values into calculated ones and force upper case all formula expressions.\n     *\n     * @private\n     * @param {Number} row Row index.\n     * @param {Number} column Column index.\n     * @param {Object} valueHolder Value holder as an object to change value by reference.\n     * @param {String} ioMode IO operation (`get` or `set`).\n     * @returns {Array|undefined} Returns modified row data.\n     */\n\n  }, {\n    key: \"onModifyData\",\n    value: function onModifyData(row, column, valueHolder, ioMode) {\n      if (ioMode === 'get' && this.hasComputedCellValue(row, column)) {\n        valueHolder.value = this.getCellValue(row, column);\n      } else if (ioMode === 'set' && isFormulaExpression(valueHolder.value)) {\n        valueHolder.value = toUpperCaseFormula(valueHolder.value);\n      }\n    }\n    /**\n     * On before value render listener.\n     *\n     * @private\n     * @param {*} value Value to render.\n     * @returns {*}\n     */\n\n  }, {\n    key: \"onBeforeValueRender\",\n    value: function onBeforeValueRender(value) {\n      var renderValue = value;\n\n      if (isFormulaExpressionEscaped(renderValue)) {\n        renderValue = unescapeFormulaExpression(renderValue);\n      }\n\n      return renderValue;\n    }\n    /**\n     * On before validate listener.\n     *\n     * @private\n     * @param {*} value Value to validate.\n     * @param {Number} row Row index.\n     * @param {Number} prop Column property.\n     */\n\n  }, {\n    key: \"onBeforeValidate\",\n    value: function onBeforeValidate(value, row, prop) {\n      var column = this.hot.propToCol(prop);\n      var validateValue = value;\n\n      if (this.hasComputedCellValue(row, column)) {\n        validateValue = this.getCellValue(row, column);\n      }\n\n      return validateValue;\n    }\n    /**\n     * `afterSetDataAtCell` listener.\n     *\n     * @private\n     * @param {Array} changes Array of changes.\n     * @param {String} [source] Source of changes.\n     */\n\n  }, {\n    key: \"onAfterSetDataAtCell\",\n    value: function onAfterSetDataAtCell(changes, source) {\n      var _this3 = this;\n\n      if (source === 'loadData') {\n        return;\n      }\n\n      this.dataProvider.clearChanges();\n      arrayEach(changes, function (_ref2) {\n        var _ref3 = _slicedToArray(_ref2, 4),\n            row = _ref3[0],\n            column = _ref3[1],\n            oldValue = _ref3[2],\n            newValue = _ref3[3];\n\n        var physicalColumn = _this3.hot.propToCol(column);\n\n        var physicalRow = _this3.t.toPhysicalRow(row);\n\n        var value = newValue;\n\n        if (isFormulaExpression(value)) {\n          value = toUpperCaseFormula(value);\n        }\n\n        _this3.dataProvider.collectChanges(physicalRow, physicalColumn, value);\n\n        if (oldValue !== value) {\n          _this3.sheet.applyChanges(physicalRow, physicalColumn, value);\n        }\n      });\n      this.recalculate();\n    }\n    /**\n     * On before create row listener.\n     *\n     * @private\n     * @param {Number} row Row index.\n     * @param {Number} amount An amount of removed rows.\n     * @param {String} source Source of method call.\n     */\n\n  }, {\n    key: \"onBeforeCreateRow\",\n    value: function onBeforeCreateRow(row, amount, source) {\n      if (source === 'UndoRedo.undo') {\n        this.undoRedoSnapshot.restore();\n      }\n    }\n    /**\n     * On after create row listener.\n     *\n     * @private\n     * @param {Number} row Row index.\n     * @param {Number} amount An amount of created rows.\n     * @param {String} source Source of method call.\n     */\n\n  }, {\n    key: \"onAfterCreateRow\",\n    value: function onAfterCreateRow(row, amount, source) {\n      this.sheet.alterManager.triggerAlter('insert_row', row, amount, source !== 'UndoRedo.undo');\n    }\n    /**\n     * On before remove row listener.\n     *\n     * @private\n     * @param {Number} row Row index.\n     * @param {Number} amount An amount of removed rows.\n     */\n\n  }, {\n    key: \"onBeforeRemoveRow\",\n    value: function onBeforeRemoveRow(row, amount) {\n      this.undoRedoSnapshot.save('row', row, amount);\n    }\n    /**\n     * On after remove row listener.\n     *\n     * @private\n     * @param {Number} row Row index.\n     * @param {Number} amount An amount of removed rows.\n     */\n\n  }, {\n    key: \"onAfterRemoveRow\",\n    value: function onAfterRemoveRow(row, amount) {\n      this.sheet.alterManager.triggerAlter('remove_row', row, amount);\n    }\n    /**\n     * On before create column listener.\n     *\n     * @private\n     * @param {Number} column Column index.\n     * @param {Number} amount An amount of removed columns.\n     * @param {String} source Source of method call.\n     */\n\n  }, {\n    key: \"onBeforeCreateCol\",\n    value: function onBeforeCreateCol(column, amount, source) {\n      if (source === 'UndoRedo.undo') {\n        this.undoRedoSnapshot.restore();\n      }\n    }\n    /**\n     * On after create column listener.\n     *\n     * @private\n     * @param {Number} column Column index.\n     * @param {Number} amount An amount of created columns.\n     * @param {String} source Source of method call.\n     */\n\n  }, {\n    key: \"onAfterCreateCol\",\n    value: function onAfterCreateCol(column, amount, source) {\n      this.sheet.alterManager.triggerAlter('insert_column', column, amount, source !== 'UndoRedo.undo');\n    }\n    /**\n     * On before remove column listener.\n     *\n     * @private\n     * @param {Number} column Column index.\n     * @param {Number} amount An amount of removed columns.\n     */\n\n  }, {\n    key: \"onBeforeRemoveCol\",\n    value: function onBeforeRemoveCol(column, amount) {\n      this.undoRedoSnapshot.save('column', column, amount);\n    }\n    /**\n     * On after remove column listener.\n     *\n     * @private\n     * @param {Number} column Column index.\n     * @param {Number} amount An amount of created columns.\n     */\n\n  }, {\n    key: \"onAfterRemoveCol\",\n    value: function onAfterRemoveCol(column, amount) {\n      this.sheet.alterManager.triggerAlter('remove_column', column, amount);\n    }\n    /**\n     * On before column sorting listener.\n     *\n     * @private\n     * @param {Number} column Sorted column index.\n     * @param {Boolean} order Order type.\n     */\n\n  }, {\n    key: \"onBeforeColumnSort\",\n    value: function onBeforeColumnSort(column, order) {\n      this.sheet.alterManager.prepareAlter('column_sorting', column, order);\n    }\n    /**\n     * On after column sorting listener.\n     *\n     * @private\n     * @param {Number} column Sorted column index.\n     * @param {Boolean} order Order type.\n     */\n\n  }, {\n    key: \"onAfterColumnSort\",\n    value: function onAfterColumnSort(column, order) {\n      this.sheet.alterManager.triggerAlter('column_sorting', column, order);\n    }\n    /**\n     * On after load data listener.\n     *\n     * @private\n     */\n\n  }, {\n    key: \"onAfterLoadData\",\n    value: function onAfterLoadData() {\n      this._skipRendering = true;\n      this.recalculateFull();\n    }\n    /**\n     * Destroys the plugin instance.\n     */\n\n  }, {\n    key: \"destroy\",\n    value: function destroy() {\n      this.dataProvider.destroy();\n      this.dataProvider = null;\n      this.sheet.destroy();\n      this.sheet = null;\n\n      _get(_getPrototypeOf(Formulas.prototype), \"destroy\", this).call(this);\n    }\n  }]);\n\n  return Formulas;\n}(BasePlugin);\n\nregisterPlugin('formulas', Formulas);\nexport default Formulas;"]},"metadata":{},"sourceType":"module"}