{"ast":null,"code":"function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nfunction _templateObject2() {\n  var data = _taggedTemplateLiteral([\"Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\\n                is currently not supported and might result in glitches.\"]);\n\n  _templateObject2 = function _templateObject2() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject() {\n  var data = _taggedTemplateLiteral([\"You have declared a Nested Header overlapping the Fixed Columns section - it may lead to visual\\n          glitches. To prevent that kind of problems, split the nested headers between the fixed and non-fixed columns.\"]);\n\n  _templateObject = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _taggedTemplateLiteral(strings, raw) {\n  if (!raw) {\n    raw = strings.slice(0);\n  }\n\n  return Object.freeze(Object.defineProperties(strings, {\n    raw: {\n      value: Object.freeze(raw)\n    }\n  }));\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  }\n\n  return _assertThisInitialized(self);\n}\n\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nfunction _get(target, property, receiver) {\n  if (typeof Reflect !== \"undefined\" && Reflect.get) {\n    _get = Reflect.get;\n  } else {\n    _get = function _get(target, property, receiver) {\n      var base = _superPropBase(target, property);\n\n      if (!base) return;\n      var desc = Object.getOwnPropertyDescriptor(base, property);\n\n      if (desc.get) {\n        return desc.get.call(receiver);\n      }\n\n      return desc.value;\n    };\n  }\n\n  return _get(target, property, receiver || target);\n}\n\nfunction _superPropBase(object, property) {\n  while (!Object.prototype.hasOwnProperty.call(object, property)) {\n    object = _getPrototypeOf(object);\n    if (object === null) break;\n  }\n\n  return object;\n}\n\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) _setPrototypeOf(subClass, superClass);\n}\n\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nimport { addClass, removeClass, fastInnerHTML, empty } from '../../helpers/dom/element';\nimport { rangeEach } from '../../helpers/number';\nimport { arrayEach } from '../../helpers/array';\nimport { objectEach } from '../../helpers/object';\nimport { toSingleLine } from '../../helpers/templateLiteralTag';\nimport { warn } from '../../helpers/console';\nimport { registerPlugin } from '../../plugins';\nimport BasePlugin from '../_base';\nimport { CellCoords } from '../../3rdparty/walkontable/src';\nimport GhostTable from './utils/ghostTable';\n/**\n * @plugin NestedHeaders\n * @description\n * The plugin allows to create a nested header structure, using the HTML's colspan attribute.\n *\n * To make any header wider (covering multiple table columns), it's corresponding configuration array element should be\n * provided as an object with `label` and `colspan` properties. The `label` property defines the header's label,\n * while the `colspan` property defines a number of columns that the header should cover.\n *\n * __Note__ that the plugin supports a *nested* structure, which means, any header cannot be wider than it's \"parent\". In\n * other words, headers cannot overlap each other.\n * @example\n *\n * ```js\n * const container = document.getElementById('example');\n * const hot = new Handsontable(container, {\n *   date: getData(),\n *   nestedHeaders: [\n *           ['A', {label: 'B', colspan: 8}, 'C'],\n *           ['D', {label: 'E', colspan: 4}, {label: 'F', colspan: 4}, 'G'],\n *           ['H', {label: 'I', colspan: 2}, {label: 'J', colspan: 2}, {label: 'K', colspan: 2}, {label: 'L', colspan: 2}, 'M'],\n *           ['N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W']\n *  ],\n * ```\n */\n\nvar NestedHeaders = /*#__PURE__*/function (_BasePlugin) {\n  _inherits(NestedHeaders, _BasePlugin);\n\n  function NestedHeaders(hotInstance) {\n    var _this2;\n\n    _classCallCheck(this, NestedHeaders);\n\n    _this2 = _possibleConstructorReturn(this, _getPrototypeOf(NestedHeaders).call(this, hotInstance));\n    /**\n     * Nasted headers cached settings.\n     *\n     * @private\n     * @type {Object}\n     */\n\n    _this2.settings = [];\n    /**\n     * Cached number of column header levels.\n     *\n     * @private\n     * @type {Number}\n     */\n\n    _this2.columnHeaderLevelCount = 0;\n    /**\n     * Array of nested headers' colspans.\n     *\n     * @private\n     * @type {Array}\n     */\n\n    _this2.colspanArray = [];\n    /**\n     * Custom helper for getting widths of the nested headers.\n     * @TODO This should be changed after refactor handsontable/utils/ghostTable.\n     *\n     * @private\n     * @type {GhostTable}\n     */\n\n    _this2.ghostTable = new GhostTable(_assertThisInitialized(_this2));\n    return _this2;\n  }\n  /**\n   * Check if plugin is enabled\n   *\n   * @returns {Boolean}\n   */\n\n\n  _createClass(NestedHeaders, [{\n    key: \"isEnabled\",\n    value: function isEnabled() {\n      return !!this.hot.getSettings().nestedHeaders;\n    }\n    /**\n     * Enables the plugin functionality for this Handsontable instance.\n     */\n\n  }, {\n    key: \"enablePlugin\",\n    value: function enablePlugin() {\n      var _this3 = this;\n\n      if (this.enabled) {\n        return;\n      }\n\n      this.settings = this.hot.getSettings().nestedHeaders;\n      this.addHook('afterGetColumnHeaderRenderers', function (array) {\n        return _this3.onAfterGetColumnHeaderRenderers(array);\n      });\n      this.addHook('afterInit', function () {\n        return _this3.onAfterInit();\n      });\n      this.addHook('afterOnCellMouseDown', function (event, coords) {\n        return _this3.onAfterOnCellMouseDown(event, coords);\n      });\n      this.addHook('beforeOnCellMouseOver', function (event, coords, TD, blockCalculations) {\n        return _this3.onBeforeOnCellMouseOver(event, coords, TD, blockCalculations);\n      });\n      this.addHook('afterViewportColumnCalculatorOverride', function (calc) {\n        return _this3.onAfterViewportColumnCalculatorOverride(calc);\n      });\n      this.addHook('modifyColWidth', function (width, column) {\n        return _this3.onModifyColWidth(width, column);\n      });\n      this.setupColspanArray();\n      this.checkForFixedColumnsCollision();\n      this.columnHeaderLevelCount = this.hot.view ? this.hot.view.wt.getSetting('columnHeaders').length : 0;\n\n      _get(_getPrototypeOf(NestedHeaders.prototype), \"enablePlugin\", this).call(this);\n    }\n    /**\n     * Disables the plugin functionality for this Handsontable instance.\n     */\n\n  }, {\n    key: \"disablePlugin\",\n    value: function disablePlugin() {\n      this.clearColspans();\n      this.settings = [];\n      this.columnHeaderLevelCount = 0;\n      this.colspanArray = [];\n      this.ghostTable.clear();\n\n      _get(_getPrototypeOf(NestedHeaders.prototype), \"disablePlugin\", this).call(this);\n    }\n    /**\n     * Updates the plugin state. This method is executed when {@link Core#updateSettings} is invoked.\n     */\n\n  }, {\n    key: \"updatePlugin\",\n    value: function updatePlugin() {\n      this.disablePlugin();\n      this.enablePlugin();\n\n      _get(_getPrototypeOf(NestedHeaders.prototype), \"updatePlugin\", this).call(this);\n\n      this.ghostTable.buildWidthsMapper();\n    }\n    /**\n     * Clear the colspans remaining after plugin usage.\n     *\n     * @private\n     */\n\n  }, {\n    key: \"clearColspans\",\n    value: function clearColspans() {\n      if (!this.hot.view) {\n        return;\n      }\n\n      var headerLevels = this.hot.view.wt.getSetting('columnHeaders').length;\n      var mainHeaders = this.hot.view.wt.wtTable.THEAD;\n      var topHeaders = this.hot.view.wt.wtOverlays.topOverlay.clone.wtTable.THEAD;\n      var topLeftCornerHeaders = this.hot.view.wt.wtOverlays.topLeftCornerOverlay ? this.hot.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.THEAD : null;\n\n      for (var i = 0; i < headerLevels; i++) {\n        var masterLevel = mainHeaders.childNodes[i];\n\n        if (!masterLevel) {\n          break;\n        }\n\n        var topLevel = topHeaders.childNodes[i];\n        var topLeftCornerLevel = topLeftCornerHeaders ? topLeftCornerHeaders.childNodes[i] : null;\n\n        for (var j = 0, masterNodes = masterLevel.childNodes.length; j < masterNodes; j++) {\n          masterLevel.childNodes[j].removeAttribute('colspan');\n\n          if (topLevel && topLevel.childNodes[j]) {\n            topLevel.childNodes[j].removeAttribute('colspan');\n          }\n\n          if (topLeftCornerHeaders && topLeftCornerLevel && topLeftCornerLevel.childNodes[j]) {\n            topLeftCornerLevel.childNodes[j].removeAttribute('colspan');\n          }\n        }\n      }\n    }\n    /**\n     * Check if the nested headers overlap the fixed columns overlay, if so - display a warning.\n     *\n     * @private\n     */\n\n  }, {\n    key: \"checkForFixedColumnsCollision\",\n    value: function checkForFixedColumnsCollision() {\n      var _this4 = this;\n\n      var fixedColumnsLeft = this.hot.getSettings().fixedColumnsLeft;\n      arrayEach(this.colspanArray, function (value, i) {\n        if (_this4.getNestedParent(i, fixedColumnsLeft) !== fixedColumnsLeft) {\n          warn(toSingleLine(_templateObject()));\n        }\n      });\n    }\n    /**\n     * Check if the configuration contains overlapping headers.\n     *\n     * @private\n     */\n\n  }, {\n    key: \"checkForOverlappingHeaders\",\n    value: function checkForOverlappingHeaders() {\n      var _this5 = this;\n\n      arrayEach(this.colspanArray, function (level, i) {\n        arrayEach(_this5.colspanArray[i], function (header, j) {\n          if (header.colspan > 1) {\n            var row = _this5.levelToRowCoords(i);\n\n            var childHeaders = _this5.getChildHeaders(row, j);\n\n            if (childHeaders.length > 0) {\n              var childColspanSum = 0;\n              arrayEach(childHeaders, function (col) {\n                childColspanSum += _this5.getColspan(row + 1, col);\n              });\n\n              if (childColspanSum > header.colspan) {\n                warn(toSingleLine(_templateObject2()));\n              }\n\n              return false;\n            }\n          }\n        });\n      });\n    }\n    /**\n     * Create an internal array containing information of the headers with a colspan attribute.\n     *\n     * @private\n     */\n\n  }, {\n    key: \"setupColspanArray\",\n    value: function setupColspanArray() {\n      var _this6 = this;\n\n      function checkIfExists(array, index) {\n        if (!array[index]) {\n          array[index] = [];\n        }\n      }\n\n      objectEach(this.settings, function (levelValues, level) {\n        objectEach(levelValues, function (val, col, levelValue) {\n          checkIfExists(_this6.colspanArray, level);\n\n          if (levelValue[col].colspan === void 0) {\n            _this6.colspanArray[level].push({\n              label: levelValue[col] || '',\n              colspan: 1,\n              hidden: false\n            });\n          } else {\n            var colspan = levelValue[col].colspan || 1;\n\n            _this6.colspanArray[level].push({\n              label: levelValue[col].label || '',\n              colspan: colspan,\n              hidden: false\n            });\n\n            _this6.fillColspanArrayWithDummies(colspan, level);\n          }\n        });\n      });\n    }\n    /**\n     * Fill the \"colspan array\" with default data for the dummy hidden headers.\n     *\n     * @private\n     * @param {Number} colspan The colspan value.\n     * @param {Number} level Header level.\n     */\n\n  }, {\n    key: \"fillColspanArrayWithDummies\",\n    value: function fillColspanArrayWithDummies(colspan, level) {\n      var _this7 = this;\n\n      rangeEach(0, colspan - 2, function () {\n        _this7.colspanArray[level].push({\n          label: '',\n          colspan: 1,\n          hidden: true\n        });\n      });\n    }\n    /**\n     * Generates the appropriate header renderer for a header row.\n     *\n     * @private\n     * @param {Number} headerRow The header row.\n     * @returns {Function}\n     *\n     * @fires Hooks#afterGetColHeader\n     */\n\n  }, {\n    key: \"headerRendererFactory\",\n    value: function headerRendererFactory(headerRow) {\n      var _this = this;\n\n      return function (index, TH) {\n        var rootDocument = _this.hot.rootDocument;\n        TH.removeAttribute('colspan');\n        removeClass(TH, 'hiddenHeader'); // header row is the index of header row counting from the top (=> positive values)\n\n        if (_this.colspanArray[headerRow][index] && _this.colspanArray[headerRow][index].colspan) {\n          var colspan = _this.colspanArray[headerRow][index].colspan;\n          var fixedColumnsLeft = _this.hot.getSettings().fixedColumnsLeft || 0;\n          var _this$hot$view$wt$wtO = _this.hot.view.wt.wtOverlays,\n              leftOverlay = _this$hot$view$wt$wtO.leftOverlay,\n              topLeftCornerOverlay = _this$hot$view$wt$wtO.topLeftCornerOverlay;\n          var isInTopLeftCornerOverlay = topLeftCornerOverlay ? topLeftCornerOverlay.clone.wtTable.THEAD.contains(TH) : false;\n          var isInLeftOverlay = leftOverlay ? leftOverlay.clone.wtTable.THEAD.contains(TH) : false;\n\n          if (colspan > 1) {\n            TH.setAttribute('colspan', isInTopLeftCornerOverlay || isInLeftOverlay ? Math.min(colspan, fixedColumnsLeft - index) : colspan);\n          }\n\n          if (isInTopLeftCornerOverlay || isInLeftOverlay && index === fixedColumnsLeft - 1) {\n            addClass(TH, 'overlayEdge');\n          }\n        }\n\n        if (_this.colspanArray[headerRow][index] && _this.colspanArray[headerRow][index].hidden) {\n          addClass(TH, 'hiddenHeader');\n        }\n\n        empty(TH);\n        var divEl = rootDocument.createElement('DIV');\n        addClass(divEl, 'relative');\n        var spanEl = rootDocument.createElement('SPAN');\n        addClass(spanEl, 'colHeader');\n        fastInnerHTML(spanEl, _this.colspanArray[headerRow][index] ? _this.colspanArray[headerRow][index].label || '' : '');\n        divEl.appendChild(spanEl);\n        TH.appendChild(divEl);\n\n        _this.hot.runHooks('afterGetColHeader', index, TH);\n      };\n    }\n    /**\n     * Returns the colspan for the provided coordinates.\n     *\n     * @private\n     * @param {Number} row Row index.\n     * @param {Number} column Column index.\n     * @returns {Number}\n     */\n\n  }, {\n    key: \"getColspan\",\n    value: function getColspan(row, column) {\n      var header = this.colspanArray[this.rowCoordsToLevel(row)][column];\n      return header ? header.colspan : 1;\n    }\n    /**\n     * Translates the level value (header row index from the top) to the row value (negative index).\n     *\n     * @private\n     * @param {Number} level Header level.\n     * @returns {Number}\n     */\n\n  }, {\n    key: \"levelToRowCoords\",\n    value: function levelToRowCoords(level) {\n      return level - this.columnHeaderLevelCount;\n    }\n    /**\n     * Translates the row value (negative index) to the level value (header row index from the top).\n     *\n     * @private\n     * @param {Number} row Row index.\n     * @returns {Number}\n     */\n\n  }, {\n    key: \"rowCoordsToLevel\",\n    value: function rowCoordsToLevel(row) {\n      return row + this.columnHeaderLevelCount;\n    }\n    /**\n     * Returns the column index of the \"parent\" nested header.\n     *\n     * @private\n     * @param {Number} level Header level.\n     * @param {Number} column Column index.\n     * @returns {*}\n     */\n\n  }, {\n    key: \"getNestedParent\",\n    value: function getNestedParent(level, column) {\n      if (level < 0) {\n        return false;\n      }\n\n      var colspan = this.colspanArray[level][column] ? this.colspanArray[level][column].colspan : 1;\n      var hidden = this.colspanArray[level][column] ? this.colspanArray[level][column].hidden : false;\n\n      if (colspan > 1 || colspan === 1 && hidden === false) {\n        return column;\n      }\n\n      var parentCol = column - 1;\n\n      do {\n        if (this.colspanArray[level][parentCol].colspan > 1) {\n          break;\n        }\n\n        parentCol -= 1;\n      } while (column >= 0);\n\n      return parentCol;\n    }\n    /**\n     * Returns (physical) indexes of headers below the header with provided coordinates.\n     *\n     * @private\n     * @param {Number} row Row index.\n     * @param {Number} column Column index.\n     * @returns {Number[]}\n     */\n\n  }, {\n    key: \"getChildHeaders\",\n    value: function getChildHeaders(row, column) {\n      var level = this.rowCoordsToLevel(row);\n      var childColspanLevel = this.colspanArray[level + 1];\n      var nestedParentCol = this.getNestedParent(level, column);\n      var colspan = this.colspanArray[level][column].colspan;\n      var childHeaderRange = [];\n\n      if (!childColspanLevel) {\n        return childHeaderRange;\n      }\n\n      rangeEach(nestedParentCol, nestedParentCol + colspan - 1, function (i) {\n        if (childColspanLevel[i] && childColspanLevel[i].colspan > 1) {\n          colspan -= childColspanLevel[i].colspan - 1;\n        }\n\n        if (childColspanLevel[i] && !childColspanLevel[i].hidden && childHeaderRange.indexOf(i) === -1) {\n          childHeaderRange.push(i);\n        }\n      });\n      return childHeaderRange;\n    }\n    /**\n     * Fill the remaining colspanArray entries for the undeclared column headers.\n     *\n     * @private\n     */\n\n  }, {\n    key: \"fillTheRemainingColspans\",\n    value: function fillTheRemainingColspans() {\n      var _this8 = this;\n\n      objectEach(this.settings, function (levelValue, level) {\n        rangeEach(_this8.colspanArray[level].length - 1, _this8.hot.countCols() - 1, function (col) {\n          _this8.colspanArray[level].push({\n            label: levelValue[col] || '',\n            colspan: 1,\n            hidden: false\n          });\n        }, true);\n      });\n    }\n    /**\n     * Updates headers highlight in nested structure.\n     *\n     * @private\n     */\n\n  }, {\n    key: \"updateHeadersHighlight\",\n    value: function updateHeadersHighlight() {\n      var _this9 = this;\n\n      var selection = this.hot.getSelectedLast();\n\n      if (selection === void 0) {\n        return;\n      }\n\n      var wtOverlays = this.hot.view.wt.wtOverlays;\n      var selectionByHeader = this.hot.selection.isSelectedByColumnHeader();\n      var from = Math.min(selection[1], selection[3]);\n      var to = Math.max(selection[1], selection[3]);\n      var levelLimit = selectionByHeader ? -1 : this.columnHeaderLevelCount - 1;\n      var changes = [];\n\n      var classNameModifier = function classNameModifier(className) {\n        return function (TH, modifier) {\n          return function () {\n            return modifier(TH, className);\n          };\n        };\n      };\n\n      var highlightHeader = classNameModifier('ht__highlight');\n      var activeHeader = classNameModifier('ht__active_highlight');\n      rangeEach(from, to, function (column) {\n        var _loop = function _loop(level) {\n          var visibleColumnIndex = _this9.getNestedParent(level, column);\n\n          var topTH = wtOverlays.topOverlay ? wtOverlays.topOverlay.clone.wtTable.getColumnHeader(visibleColumnIndex, level) : void 0;\n          var topLeftTH = wtOverlays.topLeftCornerOverlay ? wtOverlays.topLeftCornerOverlay.clone.wtTable.getColumnHeader(visibleColumnIndex, level) : void 0;\n          var listTH = [topTH, topLeftTH];\n\n          var colspanLen = _this9.getColspan(level - _this9.columnHeaderLevelCount, visibleColumnIndex);\n\n          var isInSelection = visibleColumnIndex >= from && visibleColumnIndex + colspanLen - 1 <= to;\n          arrayEach(listTH, function (TH) {\n            if (TH === void 0) {\n              return false;\n            }\n\n            if (!selectionByHeader && level < levelLimit || selectionByHeader && !isInSelection) {\n              changes.push(highlightHeader(TH, removeClass));\n\n              if (selectionByHeader) {\n                changes.push(activeHeader(TH, removeClass));\n              }\n            } else {\n              changes.push(highlightHeader(TH, addClass));\n\n              if (selectionByHeader) {\n                changes.push(activeHeader(TH, addClass));\n              }\n            }\n          });\n        };\n\n        for (var level = _this9.columnHeaderLevelCount - 1; level > -1; level--) {\n          _loop(level);\n        }\n      });\n      arrayEach(changes, function (fn) {\n        return void fn();\n      });\n      changes.length = 0;\n    }\n    /**\n     * Make the renderer render the first nested column in its entirety.\n     *\n     * @private\n     * @param {Object} calc Viewport column calculator.\n     */\n\n  }, {\n    key: \"onAfterViewportColumnCalculatorOverride\",\n    value: function onAfterViewportColumnCalculatorOverride(calc) {\n      var _this10 = this;\n\n      var newStartColumn = calc.startColumn;\n      rangeEach(0, Math.max(this.columnHeaderLevelCount - 1, 0), function (l) {\n        var startColumnNestedParent = _this10.getNestedParent(l, calc.startColumn);\n\n        if (startColumnNestedParent < calc.startColumn) {\n          newStartColumn = Math.min(newStartColumn, startColumnNestedParent);\n        }\n      });\n      calc.startColumn = newStartColumn;\n    }\n    /**\n     * Select all nested headers of clicked cell.\n     *\n     * @private\n     * @param {MouseEvent} event Mouse event.\n     * @param {Object} coords Clicked cell coords.\n     */\n\n  }, {\n    key: \"onAfterOnCellMouseDown\",\n    value: function onAfterOnCellMouseDown(event, coords) {\n      if (coords.row < 0) {\n        var colspan = this.getColspan(coords.row, coords.col);\n        var lastColIndex = coords.col + colspan - 1;\n\n        if (colspan > 1) {\n          var lastRowIndex = this.hot.countRows() - 1;\n          this.hot.selection.setRangeEnd(new CellCoords(lastRowIndex, lastColIndex));\n        }\n      }\n    }\n    /**\n     * Make the header-selection properly select the nested headers.\n     *\n     * @private\n     * @param {MouseEvent} event Mouse event.\n     * @param {Object} coords Clicked cell coords.\n     * @param {HTMLElement} TD\n     */\n\n  }, {\n    key: \"onBeforeOnCellMouseOver\",\n    value: function onBeforeOnCellMouseOver(event, coords, TD, blockCalculations) {\n      if (coords.row >= 0 || coords.col < 0 || !this.hot.view.isMouseDown()) {\n        return;\n      }\n\n      var _this$hot$getSelected = this.hot.getSelectedRangeLast(),\n          from = _this$hot$getSelected.from,\n          to = _this$hot$getSelected.to;\n\n      var colspan = this.getColspan(coords.row, coords.col);\n      var lastColIndex = coords.col + colspan - 1;\n      var changeDirection = false;\n\n      if (from.col <= to.col) {\n        if (coords.col < from.col && lastColIndex === to.col || coords.col < from.col && lastColIndex < from.col || coords.col < from.col && lastColIndex >= from.col && lastColIndex < to.col) {\n          changeDirection = true;\n        }\n      } else if (coords.col < to.col && lastColIndex > from.col || coords.col > from.col || coords.col <= to.col && lastColIndex > from.col || coords.col > to.col && lastColIndex > from.col) {\n        changeDirection = true;\n      }\n\n      if (changeDirection) {\n        var _ref = [to.col, from.col];\n        from.col = _ref[0];\n        to.col = _ref[1];\n      }\n\n      if (colspan > 1) {\n        var _this$hot;\n\n        blockCalculations.column = true;\n        blockCalculations.cell = true;\n        var columnRange = [];\n\n        if (from.col === to.col) {\n          if (lastColIndex <= from.col && coords.col < from.col) {\n            columnRange.push(to.col, coords.col);\n          } else {\n            columnRange.push(coords.col < from.col ? coords.col : from.col, lastColIndex > to.col ? lastColIndex : to.col);\n          }\n        }\n\n        if (from.col < to.col) {\n          columnRange.push(coords.col < from.col ? coords.col : from.col, lastColIndex);\n        }\n\n        if (from.col > to.col) {\n          columnRange.push(from.col, coords.col);\n        }\n\n        (_this$hot = this.hot).selectColumns.apply(_this$hot, columnRange);\n      }\n    }\n    /**\n     * Cache column header count.\n     *\n     * @private\n     */\n\n  }, {\n    key: \"onAfterInit\",\n    value: function onAfterInit() {\n      this.columnHeaderLevelCount = this.hot.view.wt.getSetting('columnHeaders').length;\n      this.fillTheRemainingColspans();\n      this.checkForOverlappingHeaders();\n      this.ghostTable.buildWidthsMapper();\n    }\n    /**\n     * `afterGetColumnHeader` hook callback - prepares the header structure.\n     *\n     * @private\n     * @param {Array} renderersArray Array of renderers.\n     */\n\n  }, {\n    key: \"onAfterGetColumnHeaderRenderers\",\n    value: function onAfterGetColumnHeaderRenderers(renderersArray) {\n      if (renderersArray) {\n        renderersArray.length = 0;\n\n        for (var headersCount = this.colspanArray.length, i = headersCount - 1; i >= 0; i--) {\n          renderersArray.push(this.headerRendererFactory(i));\n        }\n\n        renderersArray.reverse();\n      }\n\n      this.updateHeadersHighlight();\n    }\n    /**\n     * `modifyColWidth` hook callback - returns width from cache, when is greater than incoming from hook.\n     *\n     * @private\n     * @param width Width from hook.\n     * @param column Visual index of an column.\n     * @returns {Number}\n     */\n\n  }, {\n    key: \"onModifyColWidth\",\n    value: function onModifyColWidth(width, column) {\n      var cachedWidth = this.ghostTable.widthsCache[column];\n      return width > cachedWidth ? width : cachedWidth;\n    }\n    /**\n     * Destroys the plugin instance.\n     */\n\n  }, {\n    key: \"destroy\",\n    value: function destroy() {\n      this.settings = null;\n      this.columnHeaderLevelCount = null;\n      this.colspanArray = null;\n\n      _get(_getPrototypeOf(NestedHeaders.prototype), \"destroy\", this).call(this);\n    }\n  }]);\n\n  return NestedHeaders;\n}(BasePlugin);\n\nregisterPlugin('nestedHeaders', NestedHeaders);\nexport default NestedHeaders;","map":{"version":3,"sources":["C:/Users/pjk14/Desktop/Gradely/gradely-react/node_modules/handsontable/es/plugins/nestedHeaders/nestedHeaders.js"],"names":["_typeof","obj","Symbol","iterator","constructor","prototype","_templateObject2","data","_taggedTemplateLiteral","_templateObject","strings","raw","slice","Object","freeze","defineProperties","value","_classCallCheck","instance","Constructor","TypeError","_defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","defineProperty","key","_createClass","protoProps","staticProps","_possibleConstructorReturn","self","call","_assertThisInitialized","ReferenceError","_get","property","receiver","Reflect","get","base","_superPropBase","desc","getOwnPropertyDescriptor","object","hasOwnProperty","_getPrototypeOf","o","setPrototypeOf","getPrototypeOf","__proto__","_inherits","subClass","superClass","create","_setPrototypeOf","p","addClass","removeClass","fastInnerHTML","empty","rangeEach","arrayEach","objectEach","toSingleLine","warn","registerPlugin","BasePlugin","CellCoords","GhostTable","NestedHeaders","_BasePlugin","hotInstance","_this2","settings","columnHeaderLevelCount","colspanArray","ghostTable","isEnabled","hot","getSettings","nestedHeaders","enablePlugin","_this3","enabled","addHook","array","onAfterGetColumnHeaderRenderers","onAfterInit","event","coords","onAfterOnCellMouseDown","TD","blockCalculations","onBeforeOnCellMouseOver","calc","onAfterViewportColumnCalculatorOverride","width","column","onModifyColWidth","setupColspanArray","checkForFixedColumnsCollision","view","wt","getSetting","disablePlugin","clearColspans","clear","updatePlugin","buildWidthsMapper","headerLevels","mainHeaders","wtTable","THEAD","topHeaders","wtOverlays","topOverlay","clone","topLeftCornerHeaders","topLeftCornerOverlay","masterLevel","childNodes","topLevel","topLeftCornerLevel","j","masterNodes","removeAttribute","_this4","fixedColumnsLeft","getNestedParent","checkForOverlappingHeaders","_this5","level","header","colspan","row","levelToRowCoords","childHeaders","getChildHeaders","childColspanSum","col","getColspan","_this6","checkIfExists","index","levelValues","val","levelValue","push","label","hidden","fillColspanArrayWithDummies","_this7","headerRendererFactory","headerRow","_this","TH","rootDocument","_this$hot$view$wt$wtO","leftOverlay","isInTopLeftCornerOverlay","contains","isInLeftOverlay","setAttribute","Math","min","divEl","createElement","spanEl","appendChild","runHooks","rowCoordsToLevel","parentCol","childColspanLevel","nestedParentCol","childHeaderRange","indexOf","fillTheRemainingColspans","_this8","countCols","updateHeadersHighlight","_this9","selection","getSelectedLast","selectionByHeader","isSelectedByColumnHeader","from","to","max","levelLimit","changes","classNameModifier","className","modifier","highlightHeader","activeHeader","_loop","visibleColumnIndex","topTH","getColumnHeader","topLeftTH","listTH","colspanLen","isInSelection","fn","_this10","newStartColumn","startColumn","l","startColumnNestedParent","lastColIndex","lastRowIndex","countRows","setRangeEnd","isMouseDown","_this$hot$getSelected","getSelectedRangeLast","changeDirection","_ref","_this$hot","cell","columnRange","selectColumns","apply","renderersArray","headersCount","reverse","cachedWidth","widthsCache","destroy"],"mappings":"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","sourcesContent":["import \"core-js/modules/es.symbol\";\nimport \"core-js/modules/es.symbol.description\";\nimport \"core-js/modules/es.symbol.iterator\";\nimport \"core-js/modules/es.array.index-of\";\nimport \"core-js/modules/es.array.iterator\";\nimport \"core-js/modules/es.array.reverse\";\nimport \"core-js/modules/es.array.slice\";\nimport \"core-js/modules/es.object.freeze\";\nimport \"core-js/modules/es.object.get-own-property-descriptor\";\nimport \"core-js/modules/es.object.get-prototype-of\";\nimport \"core-js/modules/es.object.set-prototype-of\";\nimport \"core-js/modules/es.object.to-string\";\nimport \"core-js/modules/es.reflect.get\";\nimport \"core-js/modules/es.string.iterator\";\nimport \"core-js/modules/web.dom-collections.iterator\";\n\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _templateObject2() {\n  var data = _taggedTemplateLiteral([\"Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\\n                is currently not supported and might result in glitches.\"]);\n\n  _templateObject2 = function _templateObject2() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject() {\n  var data = _taggedTemplateLiteral([\"You have declared a Nested Header overlapping the Fixed Columns section - it may lead to visual\\n          glitches. To prevent that kind of problems, split the nested headers between the fixed and non-fixed columns.\"]);\n\n  _templateObject = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _get(target, property, receiver) { if (typeof Reflect !== \"undefined\" && Reflect.get) { _get = Reflect.get; } else { _get = function _get(target, property, receiver) { var base = _superPropBase(target, property); if (!base) return; var desc = Object.getOwnPropertyDescriptor(base, property); if (desc.get) { return desc.get.call(receiver); } return desc.value; }; } return _get(target, property, receiver || target); }\n\nfunction _superPropBase(object, property) { while (!Object.prototype.hasOwnProperty.call(object, property)) { object = _getPrototypeOf(object); if (object === null) break; } return object; }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nimport { addClass, removeClass, fastInnerHTML, empty } from '../../helpers/dom/element';\nimport { rangeEach } from '../../helpers/number';\nimport { arrayEach } from '../../helpers/array';\nimport { objectEach } from '../../helpers/object';\nimport { toSingleLine } from '../../helpers/templateLiteralTag';\nimport { warn } from '../../helpers/console';\nimport { registerPlugin } from '../../plugins';\nimport BasePlugin from '../_base';\nimport { CellCoords } from '../../3rdparty/walkontable/src';\nimport GhostTable from './utils/ghostTable';\n\n/**\n * @plugin NestedHeaders\n * @description\n * The plugin allows to create a nested header structure, using the HTML's colspan attribute.\n *\n * To make any header wider (covering multiple table columns), it's corresponding configuration array element should be\n * provided as an object with `label` and `colspan` properties. The `label` property defines the header's label,\n * while the `colspan` property defines a number of columns that the header should cover.\n *\n * __Note__ that the plugin supports a *nested* structure, which means, any header cannot be wider than it's \"parent\". In\n * other words, headers cannot overlap each other.\n * @example\n *\n * ```js\n * const container = document.getElementById('example');\n * const hot = new Handsontable(container, {\n *   date: getData(),\n *   nestedHeaders: [\n *           ['A', {label: 'B', colspan: 8}, 'C'],\n *           ['D', {label: 'E', colspan: 4}, {label: 'F', colspan: 4}, 'G'],\n *           ['H', {label: 'I', colspan: 2}, {label: 'J', colspan: 2}, {label: 'K', colspan: 2}, {label: 'L', colspan: 2}, 'M'],\n *           ['N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W']\n *  ],\n * ```\n */\nvar NestedHeaders =\n/*#__PURE__*/\nfunction (_BasePlugin) {\n  _inherits(NestedHeaders, _BasePlugin);\n\n  function NestedHeaders(hotInstance) {\n    var _this2;\n\n    _classCallCheck(this, NestedHeaders);\n\n    _this2 = _possibleConstructorReturn(this, _getPrototypeOf(NestedHeaders).call(this, hotInstance));\n    /**\n     * Nasted headers cached settings.\n     *\n     * @private\n     * @type {Object}\n     */\n\n    _this2.settings = [];\n    /**\n     * Cached number of column header levels.\n     *\n     * @private\n     * @type {Number}\n     */\n\n    _this2.columnHeaderLevelCount = 0;\n    /**\n     * Array of nested headers' colspans.\n     *\n     * @private\n     * @type {Array}\n     */\n\n    _this2.colspanArray = [];\n    /**\n     * Custom helper for getting widths of the nested headers.\n     * @TODO This should be changed after refactor handsontable/utils/ghostTable.\n     *\n     * @private\n     * @type {GhostTable}\n     */\n\n    _this2.ghostTable = new GhostTable(_assertThisInitialized(_this2));\n    return _this2;\n  }\n  /**\n   * Check if plugin is enabled\n   *\n   * @returns {Boolean}\n   */\n\n\n  _createClass(NestedHeaders, [{\n    key: \"isEnabled\",\n    value: function isEnabled() {\n      return !!this.hot.getSettings().nestedHeaders;\n    }\n    /**\n     * Enables the plugin functionality for this Handsontable instance.\n     */\n\n  }, {\n    key: \"enablePlugin\",\n    value: function enablePlugin() {\n      var _this3 = this;\n\n      if (this.enabled) {\n        return;\n      }\n\n      this.settings = this.hot.getSettings().nestedHeaders;\n      this.addHook('afterGetColumnHeaderRenderers', function (array) {\n        return _this3.onAfterGetColumnHeaderRenderers(array);\n      });\n      this.addHook('afterInit', function () {\n        return _this3.onAfterInit();\n      });\n      this.addHook('afterOnCellMouseDown', function (event, coords) {\n        return _this3.onAfterOnCellMouseDown(event, coords);\n      });\n      this.addHook('beforeOnCellMouseOver', function (event, coords, TD, blockCalculations) {\n        return _this3.onBeforeOnCellMouseOver(event, coords, TD, blockCalculations);\n      });\n      this.addHook('afterViewportColumnCalculatorOverride', function (calc) {\n        return _this3.onAfterViewportColumnCalculatorOverride(calc);\n      });\n      this.addHook('modifyColWidth', function (width, column) {\n        return _this3.onModifyColWidth(width, column);\n      });\n      this.setupColspanArray();\n      this.checkForFixedColumnsCollision();\n      this.columnHeaderLevelCount = this.hot.view ? this.hot.view.wt.getSetting('columnHeaders').length : 0;\n\n      _get(_getPrototypeOf(NestedHeaders.prototype), \"enablePlugin\", this).call(this);\n    }\n    /**\n     * Disables the plugin functionality for this Handsontable instance.\n     */\n\n  }, {\n    key: \"disablePlugin\",\n    value: function disablePlugin() {\n      this.clearColspans();\n      this.settings = [];\n      this.columnHeaderLevelCount = 0;\n      this.colspanArray = [];\n      this.ghostTable.clear();\n\n      _get(_getPrototypeOf(NestedHeaders.prototype), \"disablePlugin\", this).call(this);\n    }\n    /**\n     * Updates the plugin state. This method is executed when {@link Core#updateSettings} is invoked.\n     */\n\n  }, {\n    key: \"updatePlugin\",\n    value: function updatePlugin() {\n      this.disablePlugin();\n      this.enablePlugin();\n\n      _get(_getPrototypeOf(NestedHeaders.prototype), \"updatePlugin\", this).call(this);\n\n      this.ghostTable.buildWidthsMapper();\n    }\n    /**\n     * Clear the colspans remaining after plugin usage.\n     *\n     * @private\n     */\n\n  }, {\n    key: \"clearColspans\",\n    value: function clearColspans() {\n      if (!this.hot.view) {\n        return;\n      }\n\n      var headerLevels = this.hot.view.wt.getSetting('columnHeaders').length;\n      var mainHeaders = this.hot.view.wt.wtTable.THEAD;\n      var topHeaders = this.hot.view.wt.wtOverlays.topOverlay.clone.wtTable.THEAD;\n      var topLeftCornerHeaders = this.hot.view.wt.wtOverlays.topLeftCornerOverlay ? this.hot.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.THEAD : null;\n\n      for (var i = 0; i < headerLevels; i++) {\n        var masterLevel = mainHeaders.childNodes[i];\n\n        if (!masterLevel) {\n          break;\n        }\n\n        var topLevel = topHeaders.childNodes[i];\n        var topLeftCornerLevel = topLeftCornerHeaders ? topLeftCornerHeaders.childNodes[i] : null;\n\n        for (var j = 0, masterNodes = masterLevel.childNodes.length; j < masterNodes; j++) {\n          masterLevel.childNodes[j].removeAttribute('colspan');\n\n          if (topLevel && topLevel.childNodes[j]) {\n            topLevel.childNodes[j].removeAttribute('colspan');\n          }\n\n          if (topLeftCornerHeaders && topLeftCornerLevel && topLeftCornerLevel.childNodes[j]) {\n            topLeftCornerLevel.childNodes[j].removeAttribute('colspan');\n          }\n        }\n      }\n    }\n    /**\n     * Check if the nested headers overlap the fixed columns overlay, if so - display a warning.\n     *\n     * @private\n     */\n\n  }, {\n    key: \"checkForFixedColumnsCollision\",\n    value: function checkForFixedColumnsCollision() {\n      var _this4 = this;\n\n      var fixedColumnsLeft = this.hot.getSettings().fixedColumnsLeft;\n      arrayEach(this.colspanArray, function (value, i) {\n        if (_this4.getNestedParent(i, fixedColumnsLeft) !== fixedColumnsLeft) {\n          warn(toSingleLine(_templateObject()));\n        }\n      });\n    }\n    /**\n     * Check if the configuration contains overlapping headers.\n     *\n     * @private\n     */\n\n  }, {\n    key: \"checkForOverlappingHeaders\",\n    value: function checkForOverlappingHeaders() {\n      var _this5 = this;\n\n      arrayEach(this.colspanArray, function (level, i) {\n        arrayEach(_this5.colspanArray[i], function (header, j) {\n          if (header.colspan > 1) {\n            var row = _this5.levelToRowCoords(i);\n\n            var childHeaders = _this5.getChildHeaders(row, j);\n\n            if (childHeaders.length > 0) {\n              var childColspanSum = 0;\n              arrayEach(childHeaders, function (col) {\n                childColspanSum += _this5.getColspan(row + 1, col);\n              });\n\n              if (childColspanSum > header.colspan) {\n                warn(toSingleLine(_templateObject2()));\n              }\n\n              return false;\n            }\n          }\n        });\n      });\n    }\n    /**\n     * Create an internal array containing information of the headers with a colspan attribute.\n     *\n     * @private\n     */\n\n  }, {\n    key: \"setupColspanArray\",\n    value: function setupColspanArray() {\n      var _this6 = this;\n\n      function checkIfExists(array, index) {\n        if (!array[index]) {\n          array[index] = [];\n        }\n      }\n\n      objectEach(this.settings, function (levelValues, level) {\n        objectEach(levelValues, function (val, col, levelValue) {\n          checkIfExists(_this6.colspanArray, level);\n\n          if (levelValue[col].colspan === void 0) {\n            _this6.colspanArray[level].push({\n              label: levelValue[col] || '',\n              colspan: 1,\n              hidden: false\n            });\n          } else {\n            var colspan = levelValue[col].colspan || 1;\n\n            _this6.colspanArray[level].push({\n              label: levelValue[col].label || '',\n              colspan: colspan,\n              hidden: false\n            });\n\n            _this6.fillColspanArrayWithDummies(colspan, level);\n          }\n        });\n      });\n    }\n    /**\n     * Fill the \"colspan array\" with default data for the dummy hidden headers.\n     *\n     * @private\n     * @param {Number} colspan The colspan value.\n     * @param {Number} level Header level.\n     */\n\n  }, {\n    key: \"fillColspanArrayWithDummies\",\n    value: function fillColspanArrayWithDummies(colspan, level) {\n      var _this7 = this;\n\n      rangeEach(0, colspan - 2, function () {\n        _this7.colspanArray[level].push({\n          label: '',\n          colspan: 1,\n          hidden: true\n        });\n      });\n    }\n    /**\n     * Generates the appropriate header renderer for a header row.\n     *\n     * @private\n     * @param {Number} headerRow The header row.\n     * @returns {Function}\n     *\n     * @fires Hooks#afterGetColHeader\n     */\n\n  }, {\n    key: \"headerRendererFactory\",\n    value: function headerRendererFactory(headerRow) {\n      var _this = this;\n\n      return function (index, TH) {\n        var rootDocument = _this.hot.rootDocument;\n        TH.removeAttribute('colspan');\n        removeClass(TH, 'hiddenHeader'); // header row is the index of header row counting from the top (=> positive values)\n\n        if (_this.colspanArray[headerRow][index] && _this.colspanArray[headerRow][index].colspan) {\n          var colspan = _this.colspanArray[headerRow][index].colspan;\n          var fixedColumnsLeft = _this.hot.getSettings().fixedColumnsLeft || 0;\n          var _this$hot$view$wt$wtO = _this.hot.view.wt.wtOverlays,\n              leftOverlay = _this$hot$view$wt$wtO.leftOverlay,\n              topLeftCornerOverlay = _this$hot$view$wt$wtO.topLeftCornerOverlay;\n          var isInTopLeftCornerOverlay = topLeftCornerOverlay ? topLeftCornerOverlay.clone.wtTable.THEAD.contains(TH) : false;\n          var isInLeftOverlay = leftOverlay ? leftOverlay.clone.wtTable.THEAD.contains(TH) : false;\n\n          if (colspan > 1) {\n            TH.setAttribute('colspan', isInTopLeftCornerOverlay || isInLeftOverlay ? Math.min(colspan, fixedColumnsLeft - index) : colspan);\n          }\n\n          if (isInTopLeftCornerOverlay || isInLeftOverlay && index === fixedColumnsLeft - 1) {\n            addClass(TH, 'overlayEdge');\n          }\n        }\n\n        if (_this.colspanArray[headerRow][index] && _this.colspanArray[headerRow][index].hidden) {\n          addClass(TH, 'hiddenHeader');\n        }\n\n        empty(TH);\n        var divEl = rootDocument.createElement('DIV');\n        addClass(divEl, 'relative');\n        var spanEl = rootDocument.createElement('SPAN');\n        addClass(spanEl, 'colHeader');\n        fastInnerHTML(spanEl, _this.colspanArray[headerRow][index] ? _this.colspanArray[headerRow][index].label || '' : '');\n        divEl.appendChild(spanEl);\n        TH.appendChild(divEl);\n\n        _this.hot.runHooks('afterGetColHeader', index, TH);\n      };\n    }\n    /**\n     * Returns the colspan for the provided coordinates.\n     *\n     * @private\n     * @param {Number} row Row index.\n     * @param {Number} column Column index.\n     * @returns {Number}\n     */\n\n  }, {\n    key: \"getColspan\",\n    value: function getColspan(row, column) {\n      var header = this.colspanArray[this.rowCoordsToLevel(row)][column];\n      return header ? header.colspan : 1;\n    }\n    /**\n     * Translates the level value (header row index from the top) to the row value (negative index).\n     *\n     * @private\n     * @param {Number} level Header level.\n     * @returns {Number}\n     */\n\n  }, {\n    key: \"levelToRowCoords\",\n    value: function levelToRowCoords(level) {\n      return level - this.columnHeaderLevelCount;\n    }\n    /**\n     * Translates the row value (negative index) to the level value (header row index from the top).\n     *\n     * @private\n     * @param {Number} row Row index.\n     * @returns {Number}\n     */\n\n  }, {\n    key: \"rowCoordsToLevel\",\n    value: function rowCoordsToLevel(row) {\n      return row + this.columnHeaderLevelCount;\n    }\n    /**\n     * Returns the column index of the \"parent\" nested header.\n     *\n     * @private\n     * @param {Number} level Header level.\n     * @param {Number} column Column index.\n     * @returns {*}\n     */\n\n  }, {\n    key: \"getNestedParent\",\n    value: function getNestedParent(level, column) {\n      if (level < 0) {\n        return false;\n      }\n\n      var colspan = this.colspanArray[level][column] ? this.colspanArray[level][column].colspan : 1;\n      var hidden = this.colspanArray[level][column] ? this.colspanArray[level][column].hidden : false;\n\n      if (colspan > 1 || colspan === 1 && hidden === false) {\n        return column;\n      }\n\n      var parentCol = column - 1;\n\n      do {\n        if (this.colspanArray[level][parentCol].colspan > 1) {\n          break;\n        }\n\n        parentCol -= 1;\n      } while (column >= 0);\n\n      return parentCol;\n    }\n    /**\n     * Returns (physical) indexes of headers below the header with provided coordinates.\n     *\n     * @private\n     * @param {Number} row Row index.\n     * @param {Number} column Column index.\n     * @returns {Number[]}\n     */\n\n  }, {\n    key: \"getChildHeaders\",\n    value: function getChildHeaders(row, column) {\n      var level = this.rowCoordsToLevel(row);\n      var childColspanLevel = this.colspanArray[level + 1];\n      var nestedParentCol = this.getNestedParent(level, column);\n      var colspan = this.colspanArray[level][column].colspan;\n      var childHeaderRange = [];\n\n      if (!childColspanLevel) {\n        return childHeaderRange;\n      }\n\n      rangeEach(nestedParentCol, nestedParentCol + colspan - 1, function (i) {\n        if (childColspanLevel[i] && childColspanLevel[i].colspan > 1) {\n          colspan -= childColspanLevel[i].colspan - 1;\n        }\n\n        if (childColspanLevel[i] && !childColspanLevel[i].hidden && childHeaderRange.indexOf(i) === -1) {\n          childHeaderRange.push(i);\n        }\n      });\n      return childHeaderRange;\n    }\n    /**\n     * Fill the remaining colspanArray entries for the undeclared column headers.\n     *\n     * @private\n     */\n\n  }, {\n    key: \"fillTheRemainingColspans\",\n    value: function fillTheRemainingColspans() {\n      var _this8 = this;\n\n      objectEach(this.settings, function (levelValue, level) {\n        rangeEach(_this8.colspanArray[level].length - 1, _this8.hot.countCols() - 1, function (col) {\n          _this8.colspanArray[level].push({\n            label: levelValue[col] || '',\n            colspan: 1,\n            hidden: false\n          });\n        }, true);\n      });\n    }\n    /**\n     * Updates headers highlight in nested structure.\n     *\n     * @private\n     */\n\n  }, {\n    key: \"updateHeadersHighlight\",\n    value: function updateHeadersHighlight() {\n      var _this9 = this;\n\n      var selection = this.hot.getSelectedLast();\n\n      if (selection === void 0) {\n        return;\n      }\n\n      var wtOverlays = this.hot.view.wt.wtOverlays;\n      var selectionByHeader = this.hot.selection.isSelectedByColumnHeader();\n      var from = Math.min(selection[1], selection[3]);\n      var to = Math.max(selection[1], selection[3]);\n      var levelLimit = selectionByHeader ? -1 : this.columnHeaderLevelCount - 1;\n      var changes = [];\n\n      var classNameModifier = function classNameModifier(className) {\n        return function (TH, modifier) {\n          return function () {\n            return modifier(TH, className);\n          };\n        };\n      };\n\n      var highlightHeader = classNameModifier('ht__highlight');\n      var activeHeader = classNameModifier('ht__active_highlight');\n      rangeEach(from, to, function (column) {\n        var _loop = function _loop(level) {\n          var visibleColumnIndex = _this9.getNestedParent(level, column);\n\n          var topTH = wtOverlays.topOverlay ? wtOverlays.topOverlay.clone.wtTable.getColumnHeader(visibleColumnIndex, level) : void 0;\n          var topLeftTH = wtOverlays.topLeftCornerOverlay ? wtOverlays.topLeftCornerOverlay.clone.wtTable.getColumnHeader(visibleColumnIndex, level) : void 0;\n          var listTH = [topTH, topLeftTH];\n\n          var colspanLen = _this9.getColspan(level - _this9.columnHeaderLevelCount, visibleColumnIndex);\n\n          var isInSelection = visibleColumnIndex >= from && visibleColumnIndex + colspanLen - 1 <= to;\n          arrayEach(listTH, function (TH) {\n            if (TH === void 0) {\n              return false;\n            }\n\n            if (!selectionByHeader && level < levelLimit || selectionByHeader && !isInSelection) {\n              changes.push(highlightHeader(TH, removeClass));\n\n              if (selectionByHeader) {\n                changes.push(activeHeader(TH, removeClass));\n              }\n            } else {\n              changes.push(highlightHeader(TH, addClass));\n\n              if (selectionByHeader) {\n                changes.push(activeHeader(TH, addClass));\n              }\n            }\n          });\n        };\n\n        for (var level = _this9.columnHeaderLevelCount - 1; level > -1; level--) {\n          _loop(level);\n        }\n      });\n      arrayEach(changes, function (fn) {\n        return void fn();\n      });\n      changes.length = 0;\n    }\n    /**\n     * Make the renderer render the first nested column in its entirety.\n     *\n     * @private\n     * @param {Object} calc Viewport column calculator.\n     */\n\n  }, {\n    key: \"onAfterViewportColumnCalculatorOverride\",\n    value: function onAfterViewportColumnCalculatorOverride(calc) {\n      var _this10 = this;\n\n      var newStartColumn = calc.startColumn;\n      rangeEach(0, Math.max(this.columnHeaderLevelCount - 1, 0), function (l) {\n        var startColumnNestedParent = _this10.getNestedParent(l, calc.startColumn);\n\n        if (startColumnNestedParent < calc.startColumn) {\n          newStartColumn = Math.min(newStartColumn, startColumnNestedParent);\n        }\n      });\n      calc.startColumn = newStartColumn;\n    }\n    /**\n     * Select all nested headers of clicked cell.\n     *\n     * @private\n     * @param {MouseEvent} event Mouse event.\n     * @param {Object} coords Clicked cell coords.\n     */\n\n  }, {\n    key: \"onAfterOnCellMouseDown\",\n    value: function onAfterOnCellMouseDown(event, coords) {\n      if (coords.row < 0) {\n        var colspan = this.getColspan(coords.row, coords.col);\n        var lastColIndex = coords.col + colspan - 1;\n\n        if (colspan > 1) {\n          var lastRowIndex = this.hot.countRows() - 1;\n          this.hot.selection.setRangeEnd(new CellCoords(lastRowIndex, lastColIndex));\n        }\n      }\n    }\n    /**\n     * Make the header-selection properly select the nested headers.\n     *\n     * @private\n     * @param {MouseEvent} event Mouse event.\n     * @param {Object} coords Clicked cell coords.\n     * @param {HTMLElement} TD\n     */\n\n  }, {\n    key: \"onBeforeOnCellMouseOver\",\n    value: function onBeforeOnCellMouseOver(event, coords, TD, blockCalculations) {\n      if (coords.row >= 0 || coords.col < 0 || !this.hot.view.isMouseDown()) {\n        return;\n      }\n\n      var _this$hot$getSelected = this.hot.getSelectedRangeLast(),\n          from = _this$hot$getSelected.from,\n          to = _this$hot$getSelected.to;\n\n      var colspan = this.getColspan(coords.row, coords.col);\n      var lastColIndex = coords.col + colspan - 1;\n      var changeDirection = false;\n\n      if (from.col <= to.col) {\n        if (coords.col < from.col && lastColIndex === to.col || coords.col < from.col && lastColIndex < from.col || coords.col < from.col && lastColIndex >= from.col && lastColIndex < to.col) {\n          changeDirection = true;\n        }\n      } else if (coords.col < to.col && lastColIndex > from.col || coords.col > from.col || coords.col <= to.col && lastColIndex > from.col || coords.col > to.col && lastColIndex > from.col) {\n        changeDirection = true;\n      }\n\n      if (changeDirection) {\n        var _ref = [to.col, from.col];\n        from.col = _ref[0];\n        to.col = _ref[1];\n      }\n\n      if (colspan > 1) {\n        var _this$hot;\n\n        blockCalculations.column = true;\n        blockCalculations.cell = true;\n        var columnRange = [];\n\n        if (from.col === to.col) {\n          if (lastColIndex <= from.col && coords.col < from.col) {\n            columnRange.push(to.col, coords.col);\n          } else {\n            columnRange.push(coords.col < from.col ? coords.col : from.col, lastColIndex > to.col ? lastColIndex : to.col);\n          }\n        }\n\n        if (from.col < to.col) {\n          columnRange.push(coords.col < from.col ? coords.col : from.col, lastColIndex);\n        }\n\n        if (from.col > to.col) {\n          columnRange.push(from.col, coords.col);\n        }\n\n        (_this$hot = this.hot).selectColumns.apply(_this$hot, columnRange);\n      }\n    }\n    /**\n     * Cache column header count.\n     *\n     * @private\n     */\n\n  }, {\n    key: \"onAfterInit\",\n    value: function onAfterInit() {\n      this.columnHeaderLevelCount = this.hot.view.wt.getSetting('columnHeaders').length;\n      this.fillTheRemainingColspans();\n      this.checkForOverlappingHeaders();\n      this.ghostTable.buildWidthsMapper();\n    }\n    /**\n     * `afterGetColumnHeader` hook callback - prepares the header structure.\n     *\n     * @private\n     * @param {Array} renderersArray Array of renderers.\n     */\n\n  }, {\n    key: \"onAfterGetColumnHeaderRenderers\",\n    value: function onAfterGetColumnHeaderRenderers(renderersArray) {\n      if (renderersArray) {\n        renderersArray.length = 0;\n\n        for (var headersCount = this.colspanArray.length, i = headersCount - 1; i >= 0; i--) {\n          renderersArray.push(this.headerRendererFactory(i));\n        }\n\n        renderersArray.reverse();\n      }\n\n      this.updateHeadersHighlight();\n    }\n    /**\n     * `modifyColWidth` hook callback - returns width from cache, when is greater than incoming from hook.\n     *\n     * @private\n     * @param width Width from hook.\n     * @param column Visual index of an column.\n     * @returns {Number}\n     */\n\n  }, {\n    key: \"onModifyColWidth\",\n    value: function onModifyColWidth(width, column) {\n      var cachedWidth = this.ghostTable.widthsCache[column];\n      return width > cachedWidth ? width : cachedWidth;\n    }\n    /**\n     * Destroys the plugin instance.\n     */\n\n  }, {\n    key: \"destroy\",\n    value: function destroy() {\n      this.settings = null;\n      this.columnHeaderLevelCount = null;\n      this.colspanArray = null;\n\n      _get(_getPrototypeOf(NestedHeaders.prototype), \"destroy\", this).call(this);\n    }\n  }]);\n\n  return NestedHeaders;\n}(BasePlugin);\n\nregisterPlugin('nestedHeaders', NestedHeaders);\nexport default NestedHeaders;"]},"metadata":{},"sourceType":"module"}