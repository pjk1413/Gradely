{"ast":null,"code":"import \"core-js/modules/es.string.replace\";\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nimport Core from './../../core';\nimport { addClass, empty, fastInnerHTML, getScrollbarWidth, isChildOf, isInput, removeClass, getParentWindow } from './../../helpers/dom/element';\nimport { arrayEach, arrayFilter, arrayReduce } from './../../helpers/array';\nimport Cursor from './cursor';\nimport EventManager from './../../eventManager';\nimport { mixin, hasOwnProperty } from './../../helpers/object';\nimport { isUndefined, isDefined } from './../../helpers/mixed';\nimport { debounce, isFunction } from './../../helpers/function';\nimport { filterSeparators, hasSubMenu, isDisabled, isItemHidden, isSeparator, isSelectionDisabled, normalizeSelection } from './utils';\nimport { KEY_CODES } from './../../helpers/unicode';\nimport localHooks from './../../mixins/localHooks';\nimport { SEPARATOR, NO_ITEMS, predefinedItems } from './predefinedItems';\nimport { stopImmediatePropagation, isRightClick } from './../../helpers/dom/event';\nimport { isWindowsOS } from './../../helpers/browser';\nvar MIN_WIDTH = 215;\n/**\n * @class Menu\n * @plugin ContextMenu\n */\n\nvar Menu = /*#__PURE__*/function () {\n  function Menu(hotInstance, options) {\n    _classCallCheck(this, Menu);\n\n    this.hot = hotInstance;\n    this.options = options || {\n      parent: null,\n      name: null,\n      className: '',\n      keepInViewport: true,\n      standalone: false,\n      minWidth: MIN_WIDTH,\n      container: this.hot.rootDocument.documentElement\n    };\n    this.eventManager = new EventManager(this);\n    this.container = this.createContainer(this.options.name);\n    this.hotMenu = null;\n    this.hotSubMenus = {};\n    this.parentMenu = this.options.parent || null;\n    this.menuItems = null;\n    this.origOutsideClickDeselects = null;\n    this.keyEvent = false;\n    this.offset = {\n      above: 0,\n      below: 0,\n      left: 0,\n      right: 0\n    };\n    this._afterScrollCallback = null;\n    this.registerEvents();\n  }\n  /**\n   * Register event listeners.\n   *\n   * @private\n   */\n\n\n  _createClass(Menu, [{\n    key: \"registerEvents\",\n    value: function registerEvents() {\n      var _this = this;\n\n      var frame = this.hot.rootWindow;\n\n      while (frame) {\n        this.eventManager.addEventListener(frame.document, 'mousedown', function (event) {\n          return _this.onDocumentMouseDown(event);\n        });\n        frame = getParentWindow(frame);\n      }\n    }\n    /**\n     * Set array of objects which defines menu items.\n     *\n     * @param {Array} menuItems Menu items to display.\n     */\n\n  }, {\n    key: \"setMenuItems\",\n    value: function setMenuItems(menuItems) {\n      this.menuItems = menuItems;\n    }\n    /**\n     * Returns currently selected menu item. Returns `null` if no item was selected.\n     *\n     * @returns {Object|null}\n     */\n\n  }, {\n    key: \"getSelectedItem\",\n    value: function getSelectedItem() {\n      return this.hasSelectedItem() ? this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]) : null;\n    }\n    /**\n     * Checks if the menu has selected (highlighted) any item from the menu list.\n     *\n     * @returns {Boolean}\n     */\n\n  }, {\n    key: \"hasSelectedItem\",\n    value: function hasSelectedItem() {\n      return Array.isArray(this.hotMenu.getSelectedLast());\n    }\n    /**\n     * Set offset menu position for specified area (`above`, `below`, `left` or `right`).\n     *\n     * @param {String} area Specified area name (`above`, `below`, `left` or `right`).\n     * @param {Number} offset Offset value.\n     */\n\n  }, {\n    key: \"setOffset\",\n    value: function setOffset(area) {\n      var offset = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n      this.offset[area] = offset;\n    }\n    /**\n     * Check if menu is using as sub-menu.\n     *\n     * @returns {Boolean}\n     */\n\n  }, {\n    key: \"isSubMenu\",\n    value: function isSubMenu() {\n      return this.parentMenu !== null;\n    }\n    /**\n     * Open menu.\n     *\n     * @fires Hooks#beforeContextMenuShow\n     * @fires Hooks#afterContextMenuShow\n     */\n\n  }, {\n    key: \"open\",\n    value: function open() {\n      var _this2 = this;\n\n      this.runLocalHooks('beforeOpen');\n      this.container.removeAttribute('style');\n      this.container.style.display = 'block';\n      var delayedOpenSubMenu = debounce(function (row) {\n        return _this2.openSubMenu(row);\n      }, 300);\n      var minWidthOfMenu = this.options.minWidth || MIN_WIDTH;\n      var noItemsDefined = false;\n      var filteredItems = arrayFilter(this.menuItems, function (item) {\n        if (item.key === NO_ITEMS) {\n          noItemsDefined = true;\n        }\n\n        return isItemHidden(item, _this2.hot);\n      });\n\n      if (filteredItems.length < 1 && !noItemsDefined) {\n        filteredItems.push(predefinedItems()[NO_ITEMS]);\n      } else if (filteredItems.length === 0) {\n        return;\n      }\n\n      filteredItems = filterSeparators(filteredItems, SEPARATOR);\n      var shouldAutoCloseMenu = false;\n      var settings = {\n        data: filteredItems,\n        colHeaders: false,\n        autoColumnSize: true,\n        autoWrapRow: false,\n        modifyColWidth: function modifyColWidth(width) {\n          if (isDefined(width) && width < minWidthOfMenu) {\n            return minWidthOfMenu;\n          }\n\n          return width;\n        },\n        autoRowSize: false,\n        readOnly: true,\n        editor: false,\n        copyPaste: false,\n        columns: [{\n          data: 'name',\n          renderer: function renderer(hot, TD, row, col, prop, value) {\n            return _this2.menuItemRenderer(hot, TD, row, col, prop, value);\n          }\n        }],\n        renderAllRows: true,\n        fragmentSelection: false,\n        outsideClickDeselects: false,\n        disableVisualSelection: 'area',\n        beforeKeyDown: function beforeKeyDown(event) {\n          return _this2.onBeforeKeyDown(event);\n        },\n        afterOnCellMouseOver: function afterOnCellMouseOver(event, coords) {\n          if (_this2.isAllSubMenusClosed()) {\n            delayedOpenSubMenu(coords.row);\n          } else {\n            _this2.openSubMenu(coords.row);\n          }\n        },\n        rowHeights: function rowHeights(row) {\n          return filteredItems[row].name === SEPARATOR ? 1 : 23;\n        },\n        afterOnCellContextMenu: function afterOnCellContextMenu(event) {\n          event.preventDefault(); // On the Windows platform, the \"contextmenu\" is triggered after the \"mouseup\" so that's\n          // why the closing menu is here. (#6507#issuecomment-582392301).\n\n          if (isWindowsOS() && shouldAutoCloseMenu && _this2.hasSelectedItem()) {\n            _this2.close(true);\n          }\n        },\n        beforeOnCellMouseUp: function beforeOnCellMouseUp(event) {\n          if (_this2.hasSelectedItem()) {\n            shouldAutoCloseMenu = !_this2.isCommandPassive(_this2.getSelectedItem());\n\n            _this2.executeCommand(event);\n          }\n        },\n        afterOnCellMouseUp: function afterOnCellMouseUp(event) {\n          // If the code runs on the other platform than Windows, the \"mouseup\" is triggered\n          // after the \"contextmenu\". So then \"mouseup\" closes the menu. Otherwise, the closing\n          // menu responsibility is forwarded to \"afterOnCellContextMenu\" callback (#6507#issuecomment-582392301).\n          if ((!isWindowsOS() || !isRightClick(event)) && shouldAutoCloseMenu && _this2.hasSelectedItem()) {\n            _this2.close(true);\n          }\n        },\n        afterUnlisten: function afterUnlisten() {\n          // Restore menu focus, fix for `this.instance.unlisten();` call in the tableView.js@260 file.\n          // This prevents losing table responsiveness for keyboard events when filter select menu is closed (#6497).\n          if (!_this2.hasSelectedItem() && _this2.isOpened()) {\n            _this2.hotMenu.listen(false);\n          }\n        }\n      };\n      this.origOutsideClickDeselects = this.hot.getSettings().outsideClickDeselects;\n      this.hot.getSettings().outsideClickDeselects = false;\n      this.hotMenu = new Core(this.container, settings);\n      this.hotMenu.addHook('afterInit', function () {\n        return _this2.onAfterInit();\n      });\n      this.hotMenu.addHook('afterSelection', function () {\n        return _this2.onAfterSelection.apply(_this2, arguments);\n      });\n      this.hotMenu.init();\n      this.hotMenu.listen();\n      this.blockMainTableCallbacks();\n      this.runLocalHooks('afterOpen');\n    }\n    /**\n     * Close menu.\n     *\n     * @param {Boolean} [closeParent=false] if `true` try to close parent menu if exists.\n     */\n\n  }, {\n    key: \"close\",\n    value: function close() {\n      var closeParent = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n\n      if (!this.isOpened()) {\n        return;\n      }\n\n      if (closeParent && this.parentMenu) {\n        this.parentMenu.close();\n      } else {\n        this.closeAllSubMenus();\n        this.container.style.display = 'none';\n        this.releaseMainTableCallbacks();\n        this.hotMenu.destroy();\n        this.hotMenu = null;\n        this.hot.getSettings().outsideClickDeselects = this.origOutsideClickDeselects;\n        this.runLocalHooks('afterClose');\n\n        if (this.parentMenu) {\n          this.parentMenu.hotMenu.listen();\n        }\n      }\n    }\n    /**\n     * Open sub menu at the provided row index.\n     *\n     * @param {Number} row Row index.\n     * @returns {Menu|Boolean} Returns created menu or `false` if no one menu was created.\n     */\n\n  }, {\n    key: \"openSubMenu\",\n    value: function openSubMenu(row) {\n      if (!this.hotMenu) {\n        return false;\n      }\n\n      var cell = this.hotMenu.getCell(row, 0);\n      this.closeAllSubMenus();\n\n      if (!cell || !hasSubMenu(cell)) {\n        return false;\n      }\n\n      var dataItem = this.hotMenu.getSourceDataAtRow(row);\n      var subMenu = new Menu(this.hot, {\n        parent: this,\n        name: dataItem.name,\n        className: this.options.className,\n        keepInViewport: true,\n        container: this.options.container\n      });\n      subMenu.setMenuItems(dataItem.submenu.items);\n      subMenu.open();\n      subMenu.setPosition(cell.getBoundingClientRect());\n      this.hotSubMenus[dataItem.key] = subMenu;\n      return subMenu;\n    }\n    /**\n     * Close sub menu at row index.\n     *\n     * @param {Number} row Row index.\n     */\n\n  }, {\n    key: \"closeSubMenu\",\n    value: function closeSubMenu(row) {\n      var dataItem = this.hotMenu.getSourceDataAtRow(row);\n      var menus = this.hotSubMenus[dataItem.key];\n\n      if (menus) {\n        menus.destroy();\n        delete this.hotSubMenus[dataItem.key];\n      }\n    }\n    /**\n     * Close all opened sub menus.\n     */\n\n  }, {\n    key: \"closeAllSubMenus\",\n    value: function closeAllSubMenus() {\n      var _this3 = this;\n\n      arrayEach(this.hotMenu.getData(), function (value, row) {\n        return _this3.closeSubMenu(row);\n      });\n    }\n    /**\n     * Checks if all created and opened sub menus are closed.\n     *\n     * @returns {Boolean}\n     */\n\n  }, {\n    key: \"isAllSubMenusClosed\",\n    value: function isAllSubMenusClosed() {\n      return Object.keys(this.hotSubMenus).length === 0;\n    }\n    /**\n     * Destroy instance.\n     */\n\n  }, {\n    key: \"destroy\",\n    value: function destroy() {\n      var menuContainerParentElement = this.container.parentNode;\n      this.clearLocalHooks();\n      this.close();\n      this.parentMenu = null;\n      this.eventManager.destroy();\n\n      if (menuContainerParentElement) {\n        menuContainerParentElement.removeChild(this.container);\n      }\n    }\n    /**\n     * Checks if menu was opened.\n     *\n     * @returns {Boolean} Returns `true` if menu was opened.\n     */\n\n  }, {\n    key: \"isOpened\",\n    value: function isOpened() {\n      return this.hotMenu !== null;\n    }\n    /**\n     * Execute menu command.\n     *\n     * @param {Event} [event]\n     */\n\n  }, {\n    key: \"executeCommand\",\n    value: function executeCommand(event) {\n      if (!this.isOpened() || !this.hasSelectedItem()) {\n        return;\n      }\n\n      var selectedItem = this.getSelectedItem();\n      this.runLocalHooks('select', selectedItem, event);\n\n      if (this.isCommandPassive(selectedItem)) {\n        return;\n      }\n\n      var selRanges = this.hot.getSelectedRange();\n      var normalizedSelection = selRanges ? normalizeSelection(selRanges) : [];\n      this.runLocalHooks('executeCommand', selectedItem.key, normalizedSelection, event);\n\n      if (this.isSubMenu()) {\n        this.parentMenu.runLocalHooks('executeCommand', selectedItem.key, normalizedSelection, event);\n      }\n    }\n    /**\n     * Checks if the passed command is passive or not. The command is passive when it's marked as\n     * disabled, the descriptor object contains `isCommand` property set to `false`, command\n     * is a separator, or the item is recognized as submenu. For passive items the menu is not\n     * closed automatically after the user trigger the command through the UI.\n     *\n     * @param {Object} commandDescriptor Selected menu item from the menu data source.\n     * @returns {Boolean}\n     */\n\n  }, {\n    key: \"isCommandPassive\",\n    value: function isCommandPassive(commandDescriptor) {\n      var isCommand = commandDescriptor.isCommand,\n          commandName = commandDescriptor.name,\n          disabled = commandDescriptor.disabled,\n          submenu = commandDescriptor.submenu;\n      var isItemDisabled = disabled === true || typeof disabled === 'function' && disabled.call(this.hot) === true;\n      return isCommand === false || commandName === SEPARATOR || isItemDisabled === true || submenu;\n    }\n    /**\n     * Set menu position based on dom event or based on literal object.\n     *\n     * @param {Event|Object} coords Event or literal Object with coordinates.\n     */\n\n  }, {\n    key: \"setPosition\",\n    value: function setPosition(coords) {\n      var cursor = new Cursor(coords, this.container.ownerDocument.defaultView);\n\n      if (this.options.keepInViewport) {\n        if (cursor.fitsBelow(this.container)) {\n          this.setPositionBelowCursor(cursor);\n        } else if (cursor.fitsAbove(this.container)) {\n          this.setPositionAboveCursor(cursor);\n        } else {\n          this.setPositionBelowCursor(cursor);\n        }\n\n        if (cursor.fitsOnRight(this.container)) {\n          this.setPositionOnRightOfCursor(cursor);\n        } else {\n          this.setPositionOnLeftOfCursor(cursor);\n        }\n      } else {\n        this.setPositionBelowCursor(cursor);\n        this.setPositionOnRightOfCursor(cursor);\n      }\n    }\n    /**\n     * Set menu position above cursor object.\n     *\n     * @param {Cursor} cursor `Cursor` object.\n     */\n\n  }, {\n    key: \"setPositionAboveCursor\",\n    value: function setPositionAboveCursor(cursor) {\n      var top = this.offset.above + cursor.top - this.container.offsetHeight;\n\n      if (this.isSubMenu()) {\n        top = cursor.top + cursor.cellHeight - this.container.offsetHeight + 3;\n      }\n\n      this.container.style.top = \"\".concat(top, \"px\");\n    }\n    /**\n     * Set menu position below cursor object.\n     *\n     * @param {Cursor} cursor `Cursor` object.\n     */\n\n  }, {\n    key: \"setPositionBelowCursor\",\n    value: function setPositionBelowCursor(cursor) {\n      var top = this.offset.below + cursor.top;\n\n      if (this.isSubMenu()) {\n        top = cursor.top - 1;\n      }\n\n      this.container.style.top = \"\".concat(top, \"px\");\n    }\n    /**\n     * Set menu position on the right of cursor object.\n     *\n     * @param {Cursor} cursor `Cursor` object.\n     */\n\n  }, {\n    key: \"setPositionOnRightOfCursor\",\n    value: function setPositionOnRightOfCursor(cursor) {\n      var left;\n\n      if (this.isSubMenu()) {\n        left = 1 + cursor.left + cursor.cellWidth;\n      } else {\n        left = this.offset.right + 1 + cursor.left;\n      }\n\n      this.container.style.left = \"\".concat(left, \"px\");\n    }\n    /**\n     * Set menu position on the left of cursor object.\n     *\n     * @param {Cursor} cursor `Cursor` object.\n     */\n\n  }, {\n    key: \"setPositionOnLeftOfCursor\",\n    value: function setPositionOnLeftOfCursor(cursor) {\n      var left = this.offset.left + cursor.left - this.container.offsetWidth + getScrollbarWidth(this.hot.rootDocument) + 4;\n      this.container.style.left = \"\".concat(left, \"px\");\n    }\n    /**\n     * Select first cell in opened menu.\n     */\n\n  }, {\n    key: \"selectFirstCell\",\n    value: function selectFirstCell() {\n      var cell = this.hotMenu.getCell(0, 0);\n\n      if (isSeparator(cell) || isDisabled(cell) || isSelectionDisabled(cell)) {\n        this.selectNextCell(0, 0);\n      } else {\n        this.hotMenu.selectCell(0, 0);\n      }\n    }\n    /**\n     * Select last cell in opened menu.\n     */\n\n  }, {\n    key: \"selectLastCell\",\n    value: function selectLastCell() {\n      var lastRow = this.hotMenu.countRows() - 1;\n      var cell = this.hotMenu.getCell(lastRow, 0);\n\n      if (isSeparator(cell) || isDisabled(cell) || isSelectionDisabled(cell)) {\n        this.selectPrevCell(lastRow, 0);\n      } else {\n        this.hotMenu.selectCell(lastRow, 0);\n      }\n    }\n    /**\n     * Select next cell in opened menu.\n     *\n     * @param {Number} row Row index.\n     * @param {Number} col Column index.\n     */\n\n  }, {\n    key: \"selectNextCell\",\n    value: function selectNextCell(row, col) {\n      var nextRow = row + 1;\n      var cell = nextRow < this.hotMenu.countRows() ? this.hotMenu.getCell(nextRow, col) : null;\n\n      if (!cell) {\n        return;\n      }\n\n      if (isSeparator(cell) || isDisabled(cell) || isSelectionDisabled(cell)) {\n        this.selectNextCell(nextRow, col);\n      } else {\n        this.hotMenu.selectCell(nextRow, col);\n      }\n    }\n    /**\n     * Select previous cell in opened menu.\n     *\n     * @param {Number} row Row index.\n     * @param {Number} col Column index.\n     */\n\n  }, {\n    key: \"selectPrevCell\",\n    value: function selectPrevCell(row, col) {\n      var prevRow = row - 1;\n      var cell = prevRow >= 0 ? this.hotMenu.getCell(prevRow, col) : null;\n\n      if (!cell) {\n        return;\n      }\n\n      if (isSeparator(cell) || isDisabled(cell) || isSelectionDisabled(cell)) {\n        this.selectPrevCell(prevRow, col);\n      } else {\n        this.hotMenu.selectCell(prevRow, col);\n      }\n    }\n    /**\n     * Menu item renderer.\n     *\n     * @private\n     */\n\n  }, {\n    key: \"menuItemRenderer\",\n    value: function menuItemRenderer(hot, TD, row, col, prop, value) {\n      var _this4 = this;\n\n      var item = hot.getSourceDataAtRow(row);\n      var wrapper = this.hot.rootDocument.createElement('div');\n\n      var isSubMenu = function isSubMenu(itemToTest) {\n        return hasOwnProperty(itemToTest, 'submenu');\n      };\n\n      var itemIsSeparator = function itemIsSeparator(itemToTest) {\n        return new RegExp(SEPARATOR, 'i').test(itemToTest.name);\n      };\n\n      var itemIsDisabled = function itemIsDisabled(itemToTest) {\n        return itemToTest.disabled === true || typeof itemToTest.disabled === 'function' && itemToTest.disabled.call(_this4.hot) === true;\n      };\n\n      var itemIsSelectionDisabled = function itemIsSelectionDisabled(itemToTest) {\n        return itemToTest.disableSelection;\n      };\n\n      var itemValue = value;\n\n      if (typeof itemValue === 'function') {\n        itemValue = itemValue.call(this.hot);\n      }\n\n      empty(TD);\n      addClass(wrapper, 'htItemWrapper');\n      TD.appendChild(wrapper);\n\n      if (itemIsSeparator(item)) {\n        addClass(TD, 'htSeparator');\n      } else if (typeof item.renderer === 'function') {\n        addClass(TD, 'htCustomMenuRenderer');\n        TD.appendChild(item.renderer(hot, wrapper, row, col, prop, itemValue));\n      } else {\n        fastInnerHTML(wrapper, itemValue);\n      }\n\n      if (itemIsDisabled(item)) {\n        addClass(TD, 'htDisabled');\n        this.eventManager.addEventListener(TD, 'mouseenter', function () {\n          return hot.deselectCell();\n        });\n      } else if (itemIsSelectionDisabled(item)) {\n        addClass(TD, 'htSelectionDisabled');\n        this.eventManager.addEventListener(TD, 'mouseenter', function () {\n          return hot.deselectCell();\n        });\n      } else if (isSubMenu(item)) {\n        addClass(TD, 'htSubmenu');\n\n        if (itemIsSelectionDisabled(item)) {\n          this.eventManager.addEventListener(TD, 'mouseenter', function () {\n            return hot.deselectCell();\n          });\n        } else {\n          this.eventManager.addEventListener(TD, 'mouseenter', function () {\n            return hot.selectCell(row, col, void 0, void 0, false, false);\n          });\n        }\n      } else {\n        removeClass(TD, ['htSubmenu', 'htDisabled']);\n\n        if (itemIsSelectionDisabled(item)) {\n          this.eventManager.addEventListener(TD, 'mouseenter', function () {\n            return hot.deselectCell();\n          });\n        } else {\n          this.eventManager.addEventListener(TD, 'mouseenter', function () {\n            return hot.selectCell(row, col, void 0, void 0, false, false);\n          });\n        }\n      }\n    }\n    /**\n     * Create container/wrapper for handsontable.\n     *\n     * @private\n     * @param {String} [name] Class name.\n     * @returns {HTMLElement}\n     */\n\n  }, {\n    key: \"createContainer\",\n    value: function createContainer() {\n      var name = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n      var doc = this.options.container.ownerDocument;\n      var className = name;\n      var container;\n\n      if (className) {\n        if (isFunction(className)) {\n          className = className.call(this.hot);\n\n          if (className === null || isUndefined(className)) {\n            className = '';\n          } else {\n            className = className.toString();\n          }\n        }\n\n        className = className.replace(/[^A-z0-9]/g, '_');\n        className = \"\".concat(this.options.className, \"Sub_\").concat(className);\n        container = doc.querySelector(\".\".concat(this.options.className, \".\").concat(className));\n      }\n\n      if (!container) {\n        container = doc.createElement('div');\n        addClass(container, \"htMenu \".concat(this.options.className));\n\n        if (className) {\n          addClass(container, className);\n        }\n\n        this.options.container.appendChild(container);\n      }\n\n      return container;\n    }\n    /**\n     * @private\n     */\n\n  }, {\n    key: \"blockMainTableCallbacks\",\n    value: function blockMainTableCallbacks() {\n      this._afterScrollCallback = function () {};\n\n      this.hot.addHook('afterScrollVertically', this._afterScrollCallback);\n      this.hot.addHook('afterScrollHorizontally', this._afterScrollCallback);\n    }\n    /**\n     * @private\n     */\n\n  }, {\n    key: \"releaseMainTableCallbacks\",\n    value: function releaseMainTableCallbacks() {\n      if (this._afterScrollCallback) {\n        this.hot.removeHook('afterScrollVertically', this._afterScrollCallback);\n        this.hot.removeHook('afterScrollHorizontally', this._afterScrollCallback);\n        this._afterScrollCallback = null;\n      }\n    }\n    /**\n     * On before key down listener.\n     *\n     * @private\n     * @param {Event} event\n     */\n\n  }, {\n    key: \"onBeforeKeyDown\",\n    value: function onBeforeKeyDown(event) {\n      // For input elements, prevent event propagation. It allows entering text into an input\n      // element freely - without steeling the key events from the menu module (#6506, #6549).\n      if (isInput(event.target) && this.container.contains(event.target)) {\n        stopImmediatePropagation(event);\n        return;\n      }\n\n      var selection = this.hotMenu.getSelectedLast();\n      var stopEvent = false;\n      this.keyEvent = true;\n\n      switch (event.keyCode) {\n        case KEY_CODES.ESCAPE:\n          this.close();\n          stopEvent = true;\n          break;\n\n        case KEY_CODES.ENTER:\n          if (selection) {\n            if (this.hotMenu.getSourceDataAtRow(selection[0]).submenu) {\n              stopEvent = true;\n            } else {\n              this.executeCommand(event);\n              this.close(true);\n            }\n          }\n\n          break;\n\n        case KEY_CODES.ARROW_DOWN:\n          if (selection) {\n            this.selectNextCell(selection[0], selection[1]);\n          } else {\n            this.selectFirstCell();\n          }\n\n          stopEvent = true;\n          break;\n\n        case KEY_CODES.ARROW_UP:\n          if (selection) {\n            this.selectPrevCell(selection[0], selection[1]);\n          } else {\n            this.selectLastCell();\n          }\n\n          stopEvent = true;\n          break;\n\n        case KEY_CODES.ARROW_RIGHT:\n          if (selection) {\n            var menu = this.openSubMenu(selection[0]);\n\n            if (menu) {\n              menu.selectFirstCell();\n            }\n          }\n\n          stopEvent = true;\n          break;\n\n        case KEY_CODES.ARROW_LEFT:\n          if (selection && this.isSubMenu()) {\n            this.close();\n\n            if (this.parentMenu) {\n              this.parentMenu.hotMenu.listen();\n            }\n\n            stopEvent = true;\n          }\n\n          break;\n\n        default:\n          break;\n      }\n\n      if (stopEvent) {\n        event.preventDefault();\n        stopImmediatePropagation(event);\n      }\n\n      this.keyEvent = false;\n    }\n    /**\n     * On after init listener.\n     *\n     * @private\n     */\n\n  }, {\n    key: \"onAfterInit\",\n    value: function onAfterInit() {\n      var wtTable = this.hotMenu.view.wt.wtTable;\n      var data = this.hotMenu.getSettings().data;\n      var hiderStyle = wtTable.hider.style;\n      var holderStyle = wtTable.holder.style;\n      var currentHiderWidth = parseInt(hiderStyle.width, 10);\n      var realHeight = arrayReduce(data, function (accumulator, value) {\n        return accumulator + (value.name === SEPARATOR ? 1 : 26);\n      }, 0);\n      holderStyle.width = \"\".concat(currentHiderWidth + 22, \"px\");\n      holderStyle.height = \"\".concat(realHeight + 4, \"px\");\n      hiderStyle.height = holderStyle.height;\n    }\n    /**\n     * On after selection listener.\n     *\n     * @param {Number} r Selection start row index.\n     * @param {Number} c Selection start column index.\n     * @param {Number} r2 Selection end row index.\n     * @param {Number} c2 Selection end column index.\n     * @param {Object} preventScrolling Object with `value` property where its value change will be observed.\n     * @param {Number} selectionLayerLevel The number which indicates what selection layer is currently modified.\n     */\n\n  }, {\n    key: \"onAfterSelection\",\n    value: function onAfterSelection(r, c, r2, c2, preventScrolling) {\n      if (this.keyEvent === false) {\n        preventScrolling.value = true;\n      }\n    }\n    /**\n     * Document mouse down listener.\n     *\n     * @private\n     * @param {Event} event\n     */\n\n  }, {\n    key: \"onDocumentMouseDown\",\n    value: function onDocumentMouseDown(event) {\n      if (!this.isOpened()) {\n        return;\n      } // Close menu when clicked element is not belongs to menu itself\n\n\n      if (this.options.standalone && this.hotMenu && !isChildOf(event.target, this.hotMenu.rootElement)) {\n        this.close(true); // Automatically close menu when clicked element is not belongs to menu or submenu (not necessarily to itself)\n      } else if ((this.isAllSubMenusClosed() || this.isSubMenu()) && !isChildOf(event.target, '.htMenu') && (isChildOf(event.target, this.container.ownerDocument) || isChildOf(event.target, this.hot.rootDocument))) {\n        this.close(true);\n      }\n    }\n  }]);\n\n  return Menu;\n}();\n\nmixin(Menu, localHooks);\nexport default Menu;","map":{"version":3,"sources":["C:/Users/pjk14/Desktop/Gradely/gradely-react/node_modules/handsontable/es/plugins/contextMenu/menu.js"],"names":["_classCallCheck","instance","Constructor","TypeError","_defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","_createClass","protoProps","staticProps","prototype","Core","addClass","empty","fastInnerHTML","getScrollbarWidth","isChildOf","isInput","removeClass","getParentWindow","arrayEach","arrayFilter","arrayReduce","Cursor","EventManager","mixin","hasOwnProperty","isUndefined","isDefined","debounce","isFunction","filterSeparators","hasSubMenu","isDisabled","isItemHidden","isSeparator","isSelectionDisabled","normalizeSelection","KEY_CODES","localHooks","SEPARATOR","NO_ITEMS","predefinedItems","stopImmediatePropagation","isRightClick","isWindowsOS","MIN_WIDTH","Menu","hotInstance","options","hot","parent","name","className","keepInViewport","standalone","minWidth","container","rootDocument","documentElement","eventManager","createContainer","hotMenu","hotSubMenus","parentMenu","menuItems","origOutsideClickDeselects","keyEvent","offset","above","below","left","right","_afterScrollCallback","registerEvents","value","_this","frame","rootWindow","addEventListener","document","event","onDocumentMouseDown","setMenuItems","getSelectedItem","hasSelectedItem","getSourceDataAtRow","getSelectedLast","Array","isArray","setOffset","area","arguments","undefined","isSubMenu","open","_this2","runLocalHooks","removeAttribute","style","display","delayedOpenSubMenu","row","openSubMenu","minWidthOfMenu","noItemsDefined","filteredItems","item","push","shouldAutoCloseMenu","settings","data","colHeaders","autoColumnSize","autoWrapRow","modifyColWidth","width","autoRowSize","readOnly","editor","copyPaste","columns","renderer","TD","col","prop","menuItemRenderer","renderAllRows","fragmentSelection","outsideClickDeselects","disableVisualSelection","beforeKeyDown","onBeforeKeyDown","afterOnCellMouseOver","coords","isAllSubMenusClosed","rowHeights","afterOnCellContextMenu","preventDefault","close","beforeOnCellMouseUp","isCommandPassive","executeCommand","afterOnCellMouseUp","afterUnlisten","isOpened","listen","getSettings","addHook","onAfterInit","onAfterSelection","apply","init","blockMainTableCallbacks","closeParent","closeAllSubMenus","releaseMainTableCallbacks","destroy","cell","getCell","dataItem","subMenu","submenu","items","setPosition","getBoundingClientRect","closeSubMenu","menus","_this3","getData","keys","menuContainerParentElement","parentNode","clearLocalHooks","removeChild","selectedItem","selRanges","getSelectedRange","normalizedSelection","commandDescriptor","isCommand","commandName","disabled","isItemDisabled","call","cursor","ownerDocument","defaultView","fitsBelow","setPositionBelowCursor","fitsAbove","setPositionAboveCursor","fitsOnRight","setPositionOnRightOfCursor","setPositionOnLeftOfCursor","top","offsetHeight","cellHeight","concat","cellWidth","offsetWidth","selectFirstCell","selectNextCell","selectCell","selectLastCell","lastRow","countRows","selectPrevCell","nextRow","prevRow","_this4","wrapper","createElement","itemToTest","itemIsSeparator","RegExp","test","itemIsDisabled","itemIsSelectionDisabled","disableSelection","itemValue","appendChild","deselectCell","doc","toString","replace","querySelector","removeHook","contains","selection","stopEvent","keyCode","ESCAPE","ENTER","ARROW_DOWN","ARROW_UP","ARROW_RIGHT","menu","ARROW_LEFT","wtTable","view","wt","hiderStyle","hider","holderStyle","holder","currentHiderWidth","parseInt","realHeight","accumulator","height","r","c","r2","c2","preventScrolling","rootElement"],"mappings":"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","sourcesContent":["import \"core-js/modules/es.array.concat\";\nimport \"core-js/modules/es.function.name\";\nimport \"core-js/modules/es.object.keys\";\nimport \"core-js/modules/es.object.to-string\";\nimport \"core-js/modules/es.regexp.constructor\";\nimport \"core-js/modules/es.regexp.exec\";\nimport \"core-js/modules/es.regexp.to-string\";\nimport \"core-js/modules/es.string.replace\";\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nimport Core from './../../core';\nimport { addClass, empty, fastInnerHTML, getScrollbarWidth, isChildOf, isInput, removeClass, getParentWindow } from './../../helpers/dom/element';\nimport { arrayEach, arrayFilter, arrayReduce } from './../../helpers/array';\nimport Cursor from './cursor';\nimport EventManager from './../../eventManager';\nimport { mixin, hasOwnProperty } from './../../helpers/object';\nimport { isUndefined, isDefined } from './../../helpers/mixed';\nimport { debounce, isFunction } from './../../helpers/function';\nimport { filterSeparators, hasSubMenu, isDisabled, isItemHidden, isSeparator, isSelectionDisabled, normalizeSelection } from './utils';\nimport { KEY_CODES } from './../../helpers/unicode';\nimport localHooks from './../../mixins/localHooks';\nimport { SEPARATOR, NO_ITEMS, predefinedItems } from './predefinedItems';\nimport { stopImmediatePropagation, isRightClick } from './../../helpers/dom/event';\nimport { isWindowsOS } from './../../helpers/browser';\nvar MIN_WIDTH = 215;\n/**\n * @class Menu\n * @plugin ContextMenu\n */\n\nvar Menu =\n/*#__PURE__*/\nfunction () {\n  function Menu(hotInstance, options) {\n    _classCallCheck(this, Menu);\n\n    this.hot = hotInstance;\n    this.options = options || {\n      parent: null,\n      name: null,\n      className: '',\n      keepInViewport: true,\n      standalone: false,\n      minWidth: MIN_WIDTH,\n      container: this.hot.rootDocument.documentElement\n    };\n    this.eventManager = new EventManager(this);\n    this.container = this.createContainer(this.options.name);\n    this.hotMenu = null;\n    this.hotSubMenus = {};\n    this.parentMenu = this.options.parent || null;\n    this.menuItems = null;\n    this.origOutsideClickDeselects = null;\n    this.keyEvent = false;\n    this.offset = {\n      above: 0,\n      below: 0,\n      left: 0,\n      right: 0\n    };\n    this._afterScrollCallback = null;\n    this.registerEvents();\n  }\n  /**\n   * Register event listeners.\n   *\n   * @private\n   */\n\n\n  _createClass(Menu, [{\n    key: \"registerEvents\",\n    value: function registerEvents() {\n      var _this = this;\n\n      var frame = this.hot.rootWindow;\n\n      while (frame) {\n        this.eventManager.addEventListener(frame.document, 'mousedown', function (event) {\n          return _this.onDocumentMouseDown(event);\n        });\n        frame = getParentWindow(frame);\n      }\n    }\n    /**\n     * Set array of objects which defines menu items.\n     *\n     * @param {Array} menuItems Menu items to display.\n     */\n\n  }, {\n    key: \"setMenuItems\",\n    value: function setMenuItems(menuItems) {\n      this.menuItems = menuItems;\n    }\n    /**\n     * Returns currently selected menu item. Returns `null` if no item was selected.\n     *\n     * @returns {Object|null}\n     */\n\n  }, {\n    key: \"getSelectedItem\",\n    value: function getSelectedItem() {\n      return this.hasSelectedItem() ? this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]) : null;\n    }\n    /**\n     * Checks if the menu has selected (highlighted) any item from the menu list.\n     *\n     * @returns {Boolean}\n     */\n\n  }, {\n    key: \"hasSelectedItem\",\n    value: function hasSelectedItem() {\n      return Array.isArray(this.hotMenu.getSelectedLast());\n    }\n    /**\n     * Set offset menu position for specified area (`above`, `below`, `left` or `right`).\n     *\n     * @param {String} area Specified area name (`above`, `below`, `left` or `right`).\n     * @param {Number} offset Offset value.\n     */\n\n  }, {\n    key: \"setOffset\",\n    value: function setOffset(area) {\n      var offset = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n      this.offset[area] = offset;\n    }\n    /**\n     * Check if menu is using as sub-menu.\n     *\n     * @returns {Boolean}\n     */\n\n  }, {\n    key: \"isSubMenu\",\n    value: function isSubMenu() {\n      return this.parentMenu !== null;\n    }\n    /**\n     * Open menu.\n     *\n     * @fires Hooks#beforeContextMenuShow\n     * @fires Hooks#afterContextMenuShow\n     */\n\n  }, {\n    key: \"open\",\n    value: function open() {\n      var _this2 = this;\n\n      this.runLocalHooks('beforeOpen');\n      this.container.removeAttribute('style');\n      this.container.style.display = 'block';\n      var delayedOpenSubMenu = debounce(function (row) {\n        return _this2.openSubMenu(row);\n      }, 300);\n      var minWidthOfMenu = this.options.minWidth || MIN_WIDTH;\n      var noItemsDefined = false;\n      var filteredItems = arrayFilter(this.menuItems, function (item) {\n        if (item.key === NO_ITEMS) {\n          noItemsDefined = true;\n        }\n\n        return isItemHidden(item, _this2.hot);\n      });\n\n      if (filteredItems.length < 1 && !noItemsDefined) {\n        filteredItems.push(predefinedItems()[NO_ITEMS]);\n      } else if (filteredItems.length === 0) {\n        return;\n      }\n\n      filteredItems = filterSeparators(filteredItems, SEPARATOR);\n      var shouldAutoCloseMenu = false;\n      var settings = {\n        data: filteredItems,\n        colHeaders: false,\n        autoColumnSize: true,\n        autoWrapRow: false,\n        modifyColWidth: function modifyColWidth(width) {\n          if (isDefined(width) && width < minWidthOfMenu) {\n            return minWidthOfMenu;\n          }\n\n          return width;\n        },\n        autoRowSize: false,\n        readOnly: true,\n        editor: false,\n        copyPaste: false,\n        columns: [{\n          data: 'name',\n          renderer: function renderer(hot, TD, row, col, prop, value) {\n            return _this2.menuItemRenderer(hot, TD, row, col, prop, value);\n          }\n        }],\n        renderAllRows: true,\n        fragmentSelection: false,\n        outsideClickDeselects: false,\n        disableVisualSelection: 'area',\n        beforeKeyDown: function beforeKeyDown(event) {\n          return _this2.onBeforeKeyDown(event);\n        },\n        afterOnCellMouseOver: function afterOnCellMouseOver(event, coords) {\n          if (_this2.isAllSubMenusClosed()) {\n            delayedOpenSubMenu(coords.row);\n          } else {\n            _this2.openSubMenu(coords.row);\n          }\n        },\n        rowHeights: function rowHeights(row) {\n          return filteredItems[row].name === SEPARATOR ? 1 : 23;\n        },\n        afterOnCellContextMenu: function afterOnCellContextMenu(event) {\n          event.preventDefault(); // On the Windows platform, the \"contextmenu\" is triggered after the \"mouseup\" so that's\n          // why the closing menu is here. (#6507#issuecomment-582392301).\n\n          if (isWindowsOS() && shouldAutoCloseMenu && _this2.hasSelectedItem()) {\n            _this2.close(true);\n          }\n        },\n        beforeOnCellMouseUp: function beforeOnCellMouseUp(event) {\n          if (_this2.hasSelectedItem()) {\n            shouldAutoCloseMenu = !_this2.isCommandPassive(_this2.getSelectedItem());\n\n            _this2.executeCommand(event);\n          }\n        },\n        afterOnCellMouseUp: function afterOnCellMouseUp(event) {\n          // If the code runs on the other platform than Windows, the \"mouseup\" is triggered\n          // after the \"contextmenu\". So then \"mouseup\" closes the menu. Otherwise, the closing\n          // menu responsibility is forwarded to \"afterOnCellContextMenu\" callback (#6507#issuecomment-582392301).\n          if ((!isWindowsOS() || !isRightClick(event)) && shouldAutoCloseMenu && _this2.hasSelectedItem()) {\n            _this2.close(true);\n          }\n        },\n        afterUnlisten: function afterUnlisten() {\n          // Restore menu focus, fix for `this.instance.unlisten();` call in the tableView.js@260 file.\n          // This prevents losing table responsiveness for keyboard events when filter select menu is closed (#6497).\n          if (!_this2.hasSelectedItem() && _this2.isOpened()) {\n            _this2.hotMenu.listen(false);\n          }\n        }\n      };\n      this.origOutsideClickDeselects = this.hot.getSettings().outsideClickDeselects;\n      this.hot.getSettings().outsideClickDeselects = false;\n      this.hotMenu = new Core(this.container, settings);\n      this.hotMenu.addHook('afterInit', function () {\n        return _this2.onAfterInit();\n      });\n      this.hotMenu.addHook('afterSelection', function () {\n        return _this2.onAfterSelection.apply(_this2, arguments);\n      });\n      this.hotMenu.init();\n      this.hotMenu.listen();\n      this.blockMainTableCallbacks();\n      this.runLocalHooks('afterOpen');\n    }\n    /**\n     * Close menu.\n     *\n     * @param {Boolean} [closeParent=false] if `true` try to close parent menu if exists.\n     */\n\n  }, {\n    key: \"close\",\n    value: function close() {\n      var closeParent = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n\n      if (!this.isOpened()) {\n        return;\n      }\n\n      if (closeParent && this.parentMenu) {\n        this.parentMenu.close();\n      } else {\n        this.closeAllSubMenus();\n        this.container.style.display = 'none';\n        this.releaseMainTableCallbacks();\n        this.hotMenu.destroy();\n        this.hotMenu = null;\n        this.hot.getSettings().outsideClickDeselects = this.origOutsideClickDeselects;\n        this.runLocalHooks('afterClose');\n\n        if (this.parentMenu) {\n          this.parentMenu.hotMenu.listen();\n        }\n      }\n    }\n    /**\n     * Open sub menu at the provided row index.\n     *\n     * @param {Number} row Row index.\n     * @returns {Menu|Boolean} Returns created menu or `false` if no one menu was created.\n     */\n\n  }, {\n    key: \"openSubMenu\",\n    value: function openSubMenu(row) {\n      if (!this.hotMenu) {\n        return false;\n      }\n\n      var cell = this.hotMenu.getCell(row, 0);\n      this.closeAllSubMenus();\n\n      if (!cell || !hasSubMenu(cell)) {\n        return false;\n      }\n\n      var dataItem = this.hotMenu.getSourceDataAtRow(row);\n      var subMenu = new Menu(this.hot, {\n        parent: this,\n        name: dataItem.name,\n        className: this.options.className,\n        keepInViewport: true,\n        container: this.options.container\n      });\n      subMenu.setMenuItems(dataItem.submenu.items);\n      subMenu.open();\n      subMenu.setPosition(cell.getBoundingClientRect());\n      this.hotSubMenus[dataItem.key] = subMenu;\n      return subMenu;\n    }\n    /**\n     * Close sub menu at row index.\n     *\n     * @param {Number} row Row index.\n     */\n\n  }, {\n    key: \"closeSubMenu\",\n    value: function closeSubMenu(row) {\n      var dataItem = this.hotMenu.getSourceDataAtRow(row);\n      var menus = this.hotSubMenus[dataItem.key];\n\n      if (menus) {\n        menus.destroy();\n        delete this.hotSubMenus[dataItem.key];\n      }\n    }\n    /**\n     * Close all opened sub menus.\n     */\n\n  }, {\n    key: \"closeAllSubMenus\",\n    value: function closeAllSubMenus() {\n      var _this3 = this;\n\n      arrayEach(this.hotMenu.getData(), function (value, row) {\n        return _this3.closeSubMenu(row);\n      });\n    }\n    /**\n     * Checks if all created and opened sub menus are closed.\n     *\n     * @returns {Boolean}\n     */\n\n  }, {\n    key: \"isAllSubMenusClosed\",\n    value: function isAllSubMenusClosed() {\n      return Object.keys(this.hotSubMenus).length === 0;\n    }\n    /**\n     * Destroy instance.\n     */\n\n  }, {\n    key: \"destroy\",\n    value: function destroy() {\n      var menuContainerParentElement = this.container.parentNode;\n      this.clearLocalHooks();\n      this.close();\n      this.parentMenu = null;\n      this.eventManager.destroy();\n\n      if (menuContainerParentElement) {\n        menuContainerParentElement.removeChild(this.container);\n      }\n    }\n    /**\n     * Checks if menu was opened.\n     *\n     * @returns {Boolean} Returns `true` if menu was opened.\n     */\n\n  }, {\n    key: \"isOpened\",\n    value: function isOpened() {\n      return this.hotMenu !== null;\n    }\n    /**\n     * Execute menu command.\n     *\n     * @param {Event} [event]\n     */\n\n  }, {\n    key: \"executeCommand\",\n    value: function executeCommand(event) {\n      if (!this.isOpened() || !this.hasSelectedItem()) {\n        return;\n      }\n\n      var selectedItem = this.getSelectedItem();\n      this.runLocalHooks('select', selectedItem, event);\n\n      if (this.isCommandPassive(selectedItem)) {\n        return;\n      }\n\n      var selRanges = this.hot.getSelectedRange();\n      var normalizedSelection = selRanges ? normalizeSelection(selRanges) : [];\n      this.runLocalHooks('executeCommand', selectedItem.key, normalizedSelection, event);\n\n      if (this.isSubMenu()) {\n        this.parentMenu.runLocalHooks('executeCommand', selectedItem.key, normalizedSelection, event);\n      }\n    }\n    /**\n     * Checks if the passed command is passive or not. The command is passive when it's marked as\n     * disabled, the descriptor object contains `isCommand` property set to `false`, command\n     * is a separator, or the item is recognized as submenu. For passive items the menu is not\n     * closed automatically after the user trigger the command through the UI.\n     *\n     * @param {Object} commandDescriptor Selected menu item from the menu data source.\n     * @returns {Boolean}\n     */\n\n  }, {\n    key: \"isCommandPassive\",\n    value: function isCommandPassive(commandDescriptor) {\n      var isCommand = commandDescriptor.isCommand,\n          commandName = commandDescriptor.name,\n          disabled = commandDescriptor.disabled,\n          submenu = commandDescriptor.submenu;\n      var isItemDisabled = disabled === true || typeof disabled === 'function' && disabled.call(this.hot) === true;\n      return isCommand === false || commandName === SEPARATOR || isItemDisabled === true || submenu;\n    }\n    /**\n     * Set menu position based on dom event or based on literal object.\n     *\n     * @param {Event|Object} coords Event or literal Object with coordinates.\n     */\n\n  }, {\n    key: \"setPosition\",\n    value: function setPosition(coords) {\n      var cursor = new Cursor(coords, this.container.ownerDocument.defaultView);\n\n      if (this.options.keepInViewport) {\n        if (cursor.fitsBelow(this.container)) {\n          this.setPositionBelowCursor(cursor);\n        } else if (cursor.fitsAbove(this.container)) {\n          this.setPositionAboveCursor(cursor);\n        } else {\n          this.setPositionBelowCursor(cursor);\n        }\n\n        if (cursor.fitsOnRight(this.container)) {\n          this.setPositionOnRightOfCursor(cursor);\n        } else {\n          this.setPositionOnLeftOfCursor(cursor);\n        }\n      } else {\n        this.setPositionBelowCursor(cursor);\n        this.setPositionOnRightOfCursor(cursor);\n      }\n    }\n    /**\n     * Set menu position above cursor object.\n     *\n     * @param {Cursor} cursor `Cursor` object.\n     */\n\n  }, {\n    key: \"setPositionAboveCursor\",\n    value: function setPositionAboveCursor(cursor) {\n      var top = this.offset.above + cursor.top - this.container.offsetHeight;\n\n      if (this.isSubMenu()) {\n        top = cursor.top + cursor.cellHeight - this.container.offsetHeight + 3;\n      }\n\n      this.container.style.top = \"\".concat(top, \"px\");\n    }\n    /**\n     * Set menu position below cursor object.\n     *\n     * @param {Cursor} cursor `Cursor` object.\n     */\n\n  }, {\n    key: \"setPositionBelowCursor\",\n    value: function setPositionBelowCursor(cursor) {\n      var top = this.offset.below + cursor.top;\n\n      if (this.isSubMenu()) {\n        top = cursor.top - 1;\n      }\n\n      this.container.style.top = \"\".concat(top, \"px\");\n    }\n    /**\n     * Set menu position on the right of cursor object.\n     *\n     * @param {Cursor} cursor `Cursor` object.\n     */\n\n  }, {\n    key: \"setPositionOnRightOfCursor\",\n    value: function setPositionOnRightOfCursor(cursor) {\n      var left;\n\n      if (this.isSubMenu()) {\n        left = 1 + cursor.left + cursor.cellWidth;\n      } else {\n        left = this.offset.right + 1 + cursor.left;\n      }\n\n      this.container.style.left = \"\".concat(left, \"px\");\n    }\n    /**\n     * Set menu position on the left of cursor object.\n     *\n     * @param {Cursor} cursor `Cursor` object.\n     */\n\n  }, {\n    key: \"setPositionOnLeftOfCursor\",\n    value: function setPositionOnLeftOfCursor(cursor) {\n      var left = this.offset.left + cursor.left - this.container.offsetWidth + getScrollbarWidth(this.hot.rootDocument) + 4;\n      this.container.style.left = \"\".concat(left, \"px\");\n    }\n    /**\n     * Select first cell in opened menu.\n     */\n\n  }, {\n    key: \"selectFirstCell\",\n    value: function selectFirstCell() {\n      var cell = this.hotMenu.getCell(0, 0);\n\n      if (isSeparator(cell) || isDisabled(cell) || isSelectionDisabled(cell)) {\n        this.selectNextCell(0, 0);\n      } else {\n        this.hotMenu.selectCell(0, 0);\n      }\n    }\n    /**\n     * Select last cell in opened menu.\n     */\n\n  }, {\n    key: \"selectLastCell\",\n    value: function selectLastCell() {\n      var lastRow = this.hotMenu.countRows() - 1;\n      var cell = this.hotMenu.getCell(lastRow, 0);\n\n      if (isSeparator(cell) || isDisabled(cell) || isSelectionDisabled(cell)) {\n        this.selectPrevCell(lastRow, 0);\n      } else {\n        this.hotMenu.selectCell(lastRow, 0);\n      }\n    }\n    /**\n     * Select next cell in opened menu.\n     *\n     * @param {Number} row Row index.\n     * @param {Number} col Column index.\n     */\n\n  }, {\n    key: \"selectNextCell\",\n    value: function selectNextCell(row, col) {\n      var nextRow = row + 1;\n      var cell = nextRow < this.hotMenu.countRows() ? this.hotMenu.getCell(nextRow, col) : null;\n\n      if (!cell) {\n        return;\n      }\n\n      if (isSeparator(cell) || isDisabled(cell) || isSelectionDisabled(cell)) {\n        this.selectNextCell(nextRow, col);\n      } else {\n        this.hotMenu.selectCell(nextRow, col);\n      }\n    }\n    /**\n     * Select previous cell in opened menu.\n     *\n     * @param {Number} row Row index.\n     * @param {Number} col Column index.\n     */\n\n  }, {\n    key: \"selectPrevCell\",\n    value: function selectPrevCell(row, col) {\n      var prevRow = row - 1;\n      var cell = prevRow >= 0 ? this.hotMenu.getCell(prevRow, col) : null;\n\n      if (!cell) {\n        return;\n      }\n\n      if (isSeparator(cell) || isDisabled(cell) || isSelectionDisabled(cell)) {\n        this.selectPrevCell(prevRow, col);\n      } else {\n        this.hotMenu.selectCell(prevRow, col);\n      }\n    }\n    /**\n     * Menu item renderer.\n     *\n     * @private\n     */\n\n  }, {\n    key: \"menuItemRenderer\",\n    value: function menuItemRenderer(hot, TD, row, col, prop, value) {\n      var _this4 = this;\n\n      var item = hot.getSourceDataAtRow(row);\n      var wrapper = this.hot.rootDocument.createElement('div');\n\n      var isSubMenu = function isSubMenu(itemToTest) {\n        return hasOwnProperty(itemToTest, 'submenu');\n      };\n\n      var itemIsSeparator = function itemIsSeparator(itemToTest) {\n        return new RegExp(SEPARATOR, 'i').test(itemToTest.name);\n      };\n\n      var itemIsDisabled = function itemIsDisabled(itemToTest) {\n        return itemToTest.disabled === true || typeof itemToTest.disabled === 'function' && itemToTest.disabled.call(_this4.hot) === true;\n      };\n\n      var itemIsSelectionDisabled = function itemIsSelectionDisabled(itemToTest) {\n        return itemToTest.disableSelection;\n      };\n\n      var itemValue = value;\n\n      if (typeof itemValue === 'function') {\n        itemValue = itemValue.call(this.hot);\n      }\n\n      empty(TD);\n      addClass(wrapper, 'htItemWrapper');\n      TD.appendChild(wrapper);\n\n      if (itemIsSeparator(item)) {\n        addClass(TD, 'htSeparator');\n      } else if (typeof item.renderer === 'function') {\n        addClass(TD, 'htCustomMenuRenderer');\n        TD.appendChild(item.renderer(hot, wrapper, row, col, prop, itemValue));\n      } else {\n        fastInnerHTML(wrapper, itemValue);\n      }\n\n      if (itemIsDisabled(item)) {\n        addClass(TD, 'htDisabled');\n        this.eventManager.addEventListener(TD, 'mouseenter', function () {\n          return hot.deselectCell();\n        });\n      } else if (itemIsSelectionDisabled(item)) {\n        addClass(TD, 'htSelectionDisabled');\n        this.eventManager.addEventListener(TD, 'mouseenter', function () {\n          return hot.deselectCell();\n        });\n      } else if (isSubMenu(item)) {\n        addClass(TD, 'htSubmenu');\n\n        if (itemIsSelectionDisabled(item)) {\n          this.eventManager.addEventListener(TD, 'mouseenter', function () {\n            return hot.deselectCell();\n          });\n        } else {\n          this.eventManager.addEventListener(TD, 'mouseenter', function () {\n            return hot.selectCell(row, col, void 0, void 0, false, false);\n          });\n        }\n      } else {\n        removeClass(TD, ['htSubmenu', 'htDisabled']);\n\n        if (itemIsSelectionDisabled(item)) {\n          this.eventManager.addEventListener(TD, 'mouseenter', function () {\n            return hot.deselectCell();\n          });\n        } else {\n          this.eventManager.addEventListener(TD, 'mouseenter', function () {\n            return hot.selectCell(row, col, void 0, void 0, false, false);\n          });\n        }\n      }\n    }\n    /**\n     * Create container/wrapper for handsontable.\n     *\n     * @private\n     * @param {String} [name] Class name.\n     * @returns {HTMLElement}\n     */\n\n  }, {\n    key: \"createContainer\",\n    value: function createContainer() {\n      var name = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n      var doc = this.options.container.ownerDocument;\n      var className = name;\n      var container;\n\n      if (className) {\n        if (isFunction(className)) {\n          className = className.call(this.hot);\n\n          if (className === null || isUndefined(className)) {\n            className = '';\n          } else {\n            className = className.toString();\n          }\n        }\n\n        className = className.replace(/[^A-z0-9]/g, '_');\n        className = \"\".concat(this.options.className, \"Sub_\").concat(className);\n        container = doc.querySelector(\".\".concat(this.options.className, \".\").concat(className));\n      }\n\n      if (!container) {\n        container = doc.createElement('div');\n        addClass(container, \"htMenu \".concat(this.options.className));\n\n        if (className) {\n          addClass(container, className);\n        }\n\n        this.options.container.appendChild(container);\n      }\n\n      return container;\n    }\n    /**\n     * @private\n     */\n\n  }, {\n    key: \"blockMainTableCallbacks\",\n    value: function blockMainTableCallbacks() {\n      this._afterScrollCallback = function () {};\n\n      this.hot.addHook('afterScrollVertically', this._afterScrollCallback);\n      this.hot.addHook('afterScrollHorizontally', this._afterScrollCallback);\n    }\n    /**\n     * @private\n     */\n\n  }, {\n    key: \"releaseMainTableCallbacks\",\n    value: function releaseMainTableCallbacks() {\n      if (this._afterScrollCallback) {\n        this.hot.removeHook('afterScrollVertically', this._afterScrollCallback);\n        this.hot.removeHook('afterScrollHorizontally', this._afterScrollCallback);\n        this._afterScrollCallback = null;\n      }\n    }\n    /**\n     * On before key down listener.\n     *\n     * @private\n     * @param {Event} event\n     */\n\n  }, {\n    key: \"onBeforeKeyDown\",\n    value: function onBeforeKeyDown(event) {\n      // For input elements, prevent event propagation. It allows entering text into an input\n      // element freely - without steeling the key events from the menu module (#6506, #6549).\n      if (isInput(event.target) && this.container.contains(event.target)) {\n        stopImmediatePropagation(event);\n        return;\n      }\n\n      var selection = this.hotMenu.getSelectedLast();\n      var stopEvent = false;\n      this.keyEvent = true;\n\n      switch (event.keyCode) {\n        case KEY_CODES.ESCAPE:\n          this.close();\n          stopEvent = true;\n          break;\n\n        case KEY_CODES.ENTER:\n          if (selection) {\n            if (this.hotMenu.getSourceDataAtRow(selection[0]).submenu) {\n              stopEvent = true;\n            } else {\n              this.executeCommand(event);\n              this.close(true);\n            }\n          }\n\n          break;\n\n        case KEY_CODES.ARROW_DOWN:\n          if (selection) {\n            this.selectNextCell(selection[0], selection[1]);\n          } else {\n            this.selectFirstCell();\n          }\n\n          stopEvent = true;\n          break;\n\n        case KEY_CODES.ARROW_UP:\n          if (selection) {\n            this.selectPrevCell(selection[0], selection[1]);\n          } else {\n            this.selectLastCell();\n          }\n\n          stopEvent = true;\n          break;\n\n        case KEY_CODES.ARROW_RIGHT:\n          if (selection) {\n            var menu = this.openSubMenu(selection[0]);\n\n            if (menu) {\n              menu.selectFirstCell();\n            }\n          }\n\n          stopEvent = true;\n          break;\n\n        case KEY_CODES.ARROW_LEFT:\n          if (selection && this.isSubMenu()) {\n            this.close();\n\n            if (this.parentMenu) {\n              this.parentMenu.hotMenu.listen();\n            }\n\n            stopEvent = true;\n          }\n\n          break;\n\n        default:\n          break;\n      }\n\n      if (stopEvent) {\n        event.preventDefault();\n        stopImmediatePropagation(event);\n      }\n\n      this.keyEvent = false;\n    }\n    /**\n     * On after init listener.\n     *\n     * @private\n     */\n\n  }, {\n    key: \"onAfterInit\",\n    value: function onAfterInit() {\n      var wtTable = this.hotMenu.view.wt.wtTable;\n      var data = this.hotMenu.getSettings().data;\n      var hiderStyle = wtTable.hider.style;\n      var holderStyle = wtTable.holder.style;\n      var currentHiderWidth = parseInt(hiderStyle.width, 10);\n      var realHeight = arrayReduce(data, function (accumulator, value) {\n        return accumulator + (value.name === SEPARATOR ? 1 : 26);\n      }, 0);\n      holderStyle.width = \"\".concat(currentHiderWidth + 22, \"px\");\n      holderStyle.height = \"\".concat(realHeight + 4, \"px\");\n      hiderStyle.height = holderStyle.height;\n    }\n    /**\n     * On after selection listener.\n     *\n     * @param {Number} r Selection start row index.\n     * @param {Number} c Selection start column index.\n     * @param {Number} r2 Selection end row index.\n     * @param {Number} c2 Selection end column index.\n     * @param {Object} preventScrolling Object with `value` property where its value change will be observed.\n     * @param {Number} selectionLayerLevel The number which indicates what selection layer is currently modified.\n     */\n\n  }, {\n    key: \"onAfterSelection\",\n    value: function onAfterSelection(r, c, r2, c2, preventScrolling) {\n      if (this.keyEvent === false) {\n        preventScrolling.value = true;\n      }\n    }\n    /**\n     * Document mouse down listener.\n     *\n     * @private\n     * @param {Event} event\n     */\n\n  }, {\n    key: \"onDocumentMouseDown\",\n    value: function onDocumentMouseDown(event) {\n      if (!this.isOpened()) {\n        return;\n      } // Close menu when clicked element is not belongs to menu itself\n\n\n      if (this.options.standalone && this.hotMenu && !isChildOf(event.target, this.hotMenu.rootElement)) {\n        this.close(true); // Automatically close menu when clicked element is not belongs to menu or submenu (not necessarily to itself)\n      } else if ((this.isAllSubMenusClosed() || this.isSubMenu()) && !isChildOf(event.target, '.htMenu') && (isChildOf(event.target, this.container.ownerDocument) || isChildOf(event.target, this.hot.rootDocument))) {\n        this.close(true);\n      }\n    }\n  }]);\n\n  return Menu;\n}();\n\nmixin(Menu, localHooks);\nexport default Menu;"]},"metadata":{},"sourceType":"module"}