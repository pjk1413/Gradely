{"ast":null,"code":"function _slicedToArray(arr, i) {\n  return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest();\n}\n\nfunction _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance\");\n}\n\nfunction _iterableToArrayLimit(arr, i) {\n  if (!(Symbol.iterator in Object(arr) || Object.prototype.toString.call(arr) === \"[object Arguments]\")) {\n    return;\n  }\n\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n  var _e = undefined;\n\n  try {\n    for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}\n\nfunction _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nimport { rangeEach } from '../../helpers/number'; // Waiting for jshint >=2.9.0 where they added support for destructing\n// jshint ignore: start\n\n/**\n * @plugin ExportFile\n * @private\n */\n\nvar DataProvider = /*#__PURE__*/function () {\n  function DataProvider(hotInstance) {\n    _classCallCheck(this, DataProvider);\n    /**\n     * Handsontable instance.\n     *\n     * @type {Core}\n     */\n\n\n    this.hot = hotInstance;\n    /**\n     * Format type class options.\n     *\n     * @type {Object}\n     */\n\n    this.options = {};\n  }\n  /**\n   * Set options for data provider.\n   *\n   * @param {Object} options Object with specified options.\n   */\n\n\n  _createClass(DataProvider, [{\n    key: \"setOptions\",\n    value: function setOptions(options) {\n      this.options = options;\n    }\n    /**\n     * Get table data based on provided settings to the class constructor.\n     *\n     * @returns {Array}\n     */\n\n  }, {\n    key: \"getData\",\n    value: function getData() {\n      var _this = this;\n\n      var _this$_getDataRange = this._getDataRange(),\n          startRow = _this$_getDataRange.startRow,\n          startCol = _this$_getDataRange.startCol,\n          endRow = _this$_getDataRange.endRow,\n          endCol = _this$_getDataRange.endCol;\n\n      var options = this.options;\n      var data = [];\n      rangeEach(startRow, endRow, function (rowIndex) {\n        var row = [];\n\n        if (!options.exportHiddenRows && _this._isHiddenRow(rowIndex)) {\n          return;\n        }\n\n        rangeEach(startCol, endCol, function (colIndex) {\n          if (!options.exportHiddenColumns && _this._isHiddenColumn(colIndex)) {\n            return;\n          }\n\n          row.push(_this.hot.getDataAtCell(rowIndex, colIndex));\n        });\n        data.push(row);\n      });\n      return data;\n    }\n    /**\n     * Gets list of row headers.\n     *\n     * @return {Array}\n     */\n\n  }, {\n    key: \"getRowHeaders\",\n    value: function getRowHeaders() {\n      var _this2 = this;\n\n      var headers = [];\n\n      if (this.options.rowHeaders) {\n        var _this$_getDataRange2 = this._getDataRange(),\n            startRow = _this$_getDataRange2.startRow,\n            endRow = _this$_getDataRange2.endRow;\n\n        var rowHeaders = this.hot.getRowHeader();\n        rangeEach(startRow, endRow, function (row) {\n          if (!_this2.options.exportHiddenRows && _this2._isHiddenRow(row)) {\n            return;\n          }\n\n          headers.push(rowHeaders[row]);\n        });\n      }\n\n      return headers;\n    }\n    /**\n     * Gets list of columns headers.\n     *\n     * @return {Array}\n     */\n\n  }, {\n    key: \"getColumnHeaders\",\n    value: function getColumnHeaders() {\n      var _this3 = this;\n\n      var headers = [];\n\n      if (this.options.columnHeaders) {\n        var _this$_getDataRange3 = this._getDataRange(),\n            startCol = _this$_getDataRange3.startCol,\n            endCol = _this$_getDataRange3.endCol;\n\n        var colHeaders = this.hot.getColHeader();\n        rangeEach(startCol, endCol, function (column) {\n          if (!_this3.options.exportHiddenColumns && _this3._isHiddenColumn(column)) {\n            return;\n          }\n\n          headers.push(colHeaders[column]);\n        });\n      }\n\n      return headers;\n    }\n    /**\n     * Get data range object based on settings provided in the class constructor.\n     *\n     * @private\n     * @returns {Object} Returns object with keys `startRow`, `startCol`, `endRow` and `endCol`.\n     */\n\n  }, {\n    key: \"_getDataRange\",\n    value: function _getDataRange() {\n      var cols = this.hot.countCols() - 1;\n      var rows = this.hot.countRows() - 1;\n\n      var _this$options$range = _slicedToArray(this.options.range, 4),\n          _this$options$range$ = _this$options$range[0],\n          startRow = _this$options$range$ === void 0 ? 0 : _this$options$range$,\n          _this$options$range$2 = _this$options$range[1],\n          startCol = _this$options$range$2 === void 0 ? 0 : _this$options$range$2,\n          _this$options$range$3 = _this$options$range[2],\n          endRow = _this$options$range$3 === void 0 ? rows : _this$options$range$3,\n          _this$options$range$4 = _this$options$range[3],\n          endCol = _this$options$range$4 === void 0 ? cols : _this$options$range$4;\n\n      startRow = Math.max(startRow, 0);\n      startCol = Math.max(startCol, 0);\n      endRow = Math.min(endRow, rows);\n      endCol = Math.min(endCol, cols);\n      return {\n        startRow: startRow,\n        startCol: startCol,\n        endRow: endRow,\n        endCol: endCol\n      };\n    }\n    /**\n     * Check if row at specified row index is hidden.\n     *\n     * @private\n     * @param {Number} row Row index.\n     * @returns {Boolean}\n     */\n\n  }, {\n    key: \"_isHiddenRow\",\n    value: function _isHiddenRow(row) {\n      return this.hot.hasHook('hiddenRow') && this.hot.runHooks('hiddenRow', row);\n    }\n    /**\n     * Check if column at specified column index is hidden.\n     *\n     * @private\n     * @param {Number} column Column index.\n     * @returns {Boolean}\n     */\n\n  }, {\n    key: \"_isHiddenColumn\",\n    value: function _isHiddenColumn(column) {\n      return this.hot.hasHook('hiddenColumn') && this.hot.runHooks('hiddenColumn', column);\n    }\n  }]);\n\n  return DataProvider;\n}();\n\nexport default DataProvider;","map":{"version":3,"sources":["C:/Users/pjk14/Desktop/Gradely/gradely-react/node_modules/handsontable/es/plugins/exportFile/dataProvider.js"],"names":["_slicedToArray","arr","i","_arrayWithHoles","_iterableToArrayLimit","_nonIterableRest","TypeError","Symbol","iterator","Object","prototype","toString","call","_arr","_n","_d","_e","undefined","_i","_s","next","done","push","value","length","err","Array","isArray","_classCallCheck","instance","Constructor","_defineProperties","target","props","descriptor","enumerable","configurable","writable","defineProperty","key","_createClass","protoProps","staticProps","rangeEach","DataProvider","hotInstance","hot","options","setOptions","getData","_this","_this$_getDataRange","_getDataRange","startRow","startCol","endRow","endCol","data","rowIndex","row","exportHiddenRows","_isHiddenRow","colIndex","exportHiddenColumns","_isHiddenColumn","getDataAtCell","getRowHeaders","_this2","headers","rowHeaders","_this$_getDataRange2","getRowHeader","getColumnHeaders","_this3","columnHeaders","_this$_getDataRange3","colHeaders","getColHeader","column","cols","countCols","rows","countRows","_this$options$range","range","_this$options$range$","_this$options$range$2","_this$options$range$3","_this$options$range$4","Math","max","min","hasHook","runHooks"],"mappings":"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","sourcesContent":["import \"core-js/modules/es.symbol\";\nimport \"core-js/modules/es.symbol.description\";\nimport \"core-js/modules/es.symbol.iterator\";\nimport \"core-js/modules/es.array.iterator\";\nimport \"core-js/modules/es.object.to-string\";\nimport \"core-js/modules/es.regexp.to-string\";\nimport \"core-js/modules/es.string.iterator\";\nimport \"core-js/modules/web.dom-collections.iterator\";\n\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); }\n\nfunction _iterableToArrayLimit(arr, i) { if (!(Symbol.iterator in Object(arr) || Object.prototype.toString.call(arr) === \"[object Arguments]\")) { return; } var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nimport { rangeEach } from '../../helpers/number'; // Waiting for jshint >=2.9.0 where they added support for destructing\n// jshint ignore: start\n\n/**\n * @plugin ExportFile\n * @private\n */\n\nvar DataProvider =\n/*#__PURE__*/\nfunction () {\n  function DataProvider(hotInstance) {\n    _classCallCheck(this, DataProvider);\n\n    /**\n     * Handsontable instance.\n     *\n     * @type {Core}\n     */\n    this.hot = hotInstance;\n    /**\n     * Format type class options.\n     *\n     * @type {Object}\n     */\n\n    this.options = {};\n  }\n  /**\n   * Set options for data provider.\n   *\n   * @param {Object} options Object with specified options.\n   */\n\n\n  _createClass(DataProvider, [{\n    key: \"setOptions\",\n    value: function setOptions(options) {\n      this.options = options;\n    }\n    /**\n     * Get table data based on provided settings to the class constructor.\n     *\n     * @returns {Array}\n     */\n\n  }, {\n    key: \"getData\",\n    value: function getData() {\n      var _this = this;\n\n      var _this$_getDataRange = this._getDataRange(),\n          startRow = _this$_getDataRange.startRow,\n          startCol = _this$_getDataRange.startCol,\n          endRow = _this$_getDataRange.endRow,\n          endCol = _this$_getDataRange.endCol;\n\n      var options = this.options;\n      var data = [];\n      rangeEach(startRow, endRow, function (rowIndex) {\n        var row = [];\n\n        if (!options.exportHiddenRows && _this._isHiddenRow(rowIndex)) {\n          return;\n        }\n\n        rangeEach(startCol, endCol, function (colIndex) {\n          if (!options.exportHiddenColumns && _this._isHiddenColumn(colIndex)) {\n            return;\n          }\n\n          row.push(_this.hot.getDataAtCell(rowIndex, colIndex));\n        });\n        data.push(row);\n      });\n      return data;\n    }\n    /**\n     * Gets list of row headers.\n     *\n     * @return {Array}\n     */\n\n  }, {\n    key: \"getRowHeaders\",\n    value: function getRowHeaders() {\n      var _this2 = this;\n\n      var headers = [];\n\n      if (this.options.rowHeaders) {\n        var _this$_getDataRange2 = this._getDataRange(),\n            startRow = _this$_getDataRange2.startRow,\n            endRow = _this$_getDataRange2.endRow;\n\n        var rowHeaders = this.hot.getRowHeader();\n        rangeEach(startRow, endRow, function (row) {\n          if (!_this2.options.exportHiddenRows && _this2._isHiddenRow(row)) {\n            return;\n          }\n\n          headers.push(rowHeaders[row]);\n        });\n      }\n\n      return headers;\n    }\n    /**\n     * Gets list of columns headers.\n     *\n     * @return {Array}\n     */\n\n  }, {\n    key: \"getColumnHeaders\",\n    value: function getColumnHeaders() {\n      var _this3 = this;\n\n      var headers = [];\n\n      if (this.options.columnHeaders) {\n        var _this$_getDataRange3 = this._getDataRange(),\n            startCol = _this$_getDataRange3.startCol,\n            endCol = _this$_getDataRange3.endCol;\n\n        var colHeaders = this.hot.getColHeader();\n        rangeEach(startCol, endCol, function (column) {\n          if (!_this3.options.exportHiddenColumns && _this3._isHiddenColumn(column)) {\n            return;\n          }\n\n          headers.push(colHeaders[column]);\n        });\n      }\n\n      return headers;\n    }\n    /**\n     * Get data range object based on settings provided in the class constructor.\n     *\n     * @private\n     * @returns {Object} Returns object with keys `startRow`, `startCol`, `endRow` and `endCol`.\n     */\n\n  }, {\n    key: \"_getDataRange\",\n    value: function _getDataRange() {\n      var cols = this.hot.countCols() - 1;\n      var rows = this.hot.countRows() - 1;\n\n      var _this$options$range = _slicedToArray(this.options.range, 4),\n          _this$options$range$ = _this$options$range[0],\n          startRow = _this$options$range$ === void 0 ? 0 : _this$options$range$,\n          _this$options$range$2 = _this$options$range[1],\n          startCol = _this$options$range$2 === void 0 ? 0 : _this$options$range$2,\n          _this$options$range$3 = _this$options$range[2],\n          endRow = _this$options$range$3 === void 0 ? rows : _this$options$range$3,\n          _this$options$range$4 = _this$options$range[3],\n          endCol = _this$options$range$4 === void 0 ? cols : _this$options$range$4;\n\n      startRow = Math.max(startRow, 0);\n      startCol = Math.max(startCol, 0);\n      endRow = Math.min(endRow, rows);\n      endCol = Math.min(endCol, cols);\n      return {\n        startRow: startRow,\n        startCol: startCol,\n        endRow: endRow,\n        endCol: endCol\n      };\n    }\n    /**\n     * Check if row at specified row index is hidden.\n     *\n     * @private\n     * @param {Number} row Row index.\n     * @returns {Boolean}\n     */\n\n  }, {\n    key: \"_isHiddenRow\",\n    value: function _isHiddenRow(row) {\n      return this.hot.hasHook('hiddenRow') && this.hot.runHooks('hiddenRow', row);\n    }\n    /**\n     * Check if column at specified column index is hidden.\n     *\n     * @private\n     * @param {Number} column Column index.\n     * @returns {Boolean}\n     */\n\n  }, {\n    key: \"_isHiddenColumn\",\n    value: function _isHiddenColumn(column) {\n      return this.hot.hasHook('hiddenColumn') && this.hot.runHooks('hiddenColumn', column);\n    }\n  }]);\n\n  return DataProvider;\n}();\n\nexport default DataProvider;"]},"metadata":{},"sourceType":"module"}