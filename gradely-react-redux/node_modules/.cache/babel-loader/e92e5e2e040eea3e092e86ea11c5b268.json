{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _objectSpread from \"@babel/runtime/helpers/esm/objectSpread\";\nimport _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"@babel/runtime/helpers/esm/inherits\";\nimport React, { PureComponent } from \"react\";\nimport { connect } from \"unistore/react\"; // $FlowFixMe\n\nimport { Parser as FormulaParser, columnIndexToLabel } from \"hot-formula-parser\";\nimport * as Types from \"./types\";\nimport Table from \"./Table\";\nimport Row from \"./Row\";\nimport { Cell, enhance as enhanceCell } from \"./Cell\";\nimport DataViewer from \"./DataViewer\";\nimport DataEditor from \"./DataEditor\";\nimport ActiveCell from \"./ActiveCell\";\nimport Selected from \"./Selected\";\nimport Copied from \"./Copied\";\nimport { getBindingsForCell } from \"./bindings\";\nimport { range, readTextFromClipboard, writeTextToClipboard } from \"./util\";\nimport * as PointSet from \"./point-set\";\nimport * as Matrix from \"./matrix\";\nimport * as Actions from \"./actions\";\nimport \"./Spreadsheet.css\";\n\nvar getValue = function getValue(_ref) {\n  var data = _ref.data;\n  return data ? data.value : null;\n};\n\nvar DefaultColumnIndicator = function DefaultColumnIndicator(_ref2) {\n  var column = _ref2.column,\n      label = _ref2.label;\n  return label !== undefined ? React.createElement(\"th\", null, label) : React.createElement(\"th\", null, columnIndexToLabel(column));\n};\n\nvar DefaultRowIndicator = function DefaultRowIndicator(_ref3) {\n  var row = _ref3.row,\n      label = _ref3.label;\n  return label !== undefined ? React.createElement(\"th\", null, label) : React.createElement(\"th\", null, row + 1);\n};\n\nvar Spreadsheet = /*#__PURE__*/function (_PureComponent) {\n  _inherits(Spreadsheet, _PureComponent);\n\n  function Spreadsheet() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, Spreadsheet);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(Spreadsheet)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.formulaParser = _this.props.formulaParser || new FormulaParser();\n\n    _this.clip = function (event) {\n      var _this$props = _this.props,\n          store = _this$props.store,\n          getValue = _this$props.getValue;\n\n      var _store$getState = store.getState(),\n          data = _store$getState.data,\n          selected = _store$getState.selected;\n\n      var startPoint = PointSet.min(selected);\n      var endPoint = PointSet.max(selected);\n      var slicedMatrix = Matrix.slice(startPoint, endPoint, data);\n      var valueMatrix = Matrix.map(function (value, point) {\n        // Slice makes non-existing cells undefined, empty cells are classically\n        // translated to an empty string in join()\n        if (value === undefined) {\n          return \"\";\n        }\n\n        return getValue(_objectSpread({}, point, {\n          data: value\n        }));\n      }, slicedMatrix);\n      var csv = Matrix.join(valueMatrix);\n      writeTextToClipboard(event, csv);\n    };\n\n    _this.handleCopy = function (event) {\n      if (_this.isFocused()) {\n        event.preventDefault();\n        event.stopPropagation();\n\n        _this.clip(event);\n\n        _this.props.copy();\n      }\n    };\n\n    _this.handlePaste = /*#__PURE__*/function () {\n      var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(event) {\n        var _text;\n\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                if (_this.props.mode === \"view\" && _this.isFocused()) {\n                  event.preventDefault();\n                  event.stopPropagation();\n\n                  if (event.clipboardData) {\n                    _text = readTextFromClipboard(event);\n\n                    _this.props.paste(_text);\n                  }\n                }\n\n              case 1:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n\n      return function (_x) {\n        return _ref4.apply(this, arguments);\n      };\n    }();\n\n    _this.handleCut = function (event) {\n      if (_this.isFocused()) {\n        event.preventDefault();\n        event.stopPropagation();\n\n        _this.clip(event);\n\n        _this.props.cut();\n      }\n    };\n\n    _this.handleKeyDown = function (event) {\n      var _this$props2 = _this.props,\n          store = _this$props2.store,\n          onKeyDown = _this$props2.onKeyDown,\n          onKeyDownAction = _this$props2.onKeyDownAction;\n\n      if (onKeyDown) {\n        onKeyDown(event);\n      } // Do not use event in case preventDefault() was called inside onKeyDown\n\n\n      if (!event.defaultPrevented) {\n        // Only disable default behavior if an handler exist\n        if (Actions.getKeyDownHandler(store.getState(), event)) {\n          event.nativeEvent.preventDefault();\n        }\n\n        onKeyDownAction(event);\n      }\n    };\n\n    _this.handleMouseUp = function () {\n      _this.props.onDragEnd();\n\n      document.removeEventListener(\"mouseup\", _this.handleMouseUp);\n    };\n\n    _this.handleMouseMove = function (event) {\n      if (!_this.props.store.getState().dragging && event.buttons === 1) {\n        _this.props.onDragStart();\n\n        document.addEventListener(\"mouseup\", _this.handleMouseUp);\n      }\n    };\n\n    _this.handleRoot = function (root) {\n      _this.root = root;\n    };\n\n    return _this;\n  }\n\n  _createClass(Spreadsheet, [{\n    key: \"isFocused\",\n    value: function isFocused() {\n      var _document = document,\n          activeElement = _document.activeElement;\n      return this.props.mode === \"view\" && this.root ? this.root === activeElement || this.root.contains(activeElement) : false;\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      document.removeEventListener(\"cut\", this.handleCut);\n      document.removeEventListener(\"copy\", this.handleCopy);\n      document.removeEventListener(\"paste\", this.handlePaste);\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var store = this.props.store;\n      document.addEventListener(\"cut\", this.handleCut);\n      document.addEventListener(\"copy\", this.handleCopy);\n      document.addEventListener(\"paste\", this.handlePaste);\n      this.formulaParser.on(\"callCellValue\", function (cellCoord, done) {\n        var value;\n        /** @todo More sound error, or at least document */\n\n        try {\n          var cell = Matrix.get(cellCoord.row.index, cellCoord.column.index, store.getState().data);\n          value = getValue({\n            data: cell\n          });\n        } catch (error) {\n          console.error(error);\n        } finally {\n          done(value);\n        }\n      });\n      this.formulaParser.on(\"callRangeValue\", function (startCellCoord, endCellCoord, done) {\n        var startPoint = {\n          row: startCellCoord.row.index,\n          column: startCellCoord.column.index\n        };\n        var endPoint = {\n          row: endCellCoord.row.index,\n          column: endCellCoord.column.index\n        };\n        var values = Matrix.toArray(Matrix.slice(startPoint, endPoint, store.getState().data)).map(function (cell) {\n          return getValue({\n            data: cell\n          });\n        });\n        done(values);\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var _this$props3 = this.props,\n          Table = _this$props3.Table,\n          Row = _this$props3.Row,\n          Cell = _this$props3.Cell,\n          columnLabels = _this$props3.columnLabels,\n          rowLabels = _this$props3.rowLabels,\n          DataViewer = _this$props3.DataViewer,\n          getValue = _this$props3.getValue,\n          rows = _this$props3.rows,\n          columns = _this$props3.columns,\n          onKeyPress = _this$props3.onKeyPress,\n          getBindingsForCell = _this$props3.getBindingsForCell,\n          hideColumnIndicators = _this$props3.hideColumnIndicators,\n          hideRowIndicators = _this$props3.hideRowIndicators;\n      var ColumnIndicator = this.props.ColumnIndicator || DefaultColumnIndicator;\n      var RowIndicator = this.props.RowIndicator || DefaultRowIndicator;\n      return React.createElement(\"div\", {\n        ref: this.handleRoot,\n        className: \"Spreadsheet\",\n        onKeyPress: onKeyPress,\n        onKeyDown: this.handleKeyDown,\n        onMouseMove: this.handleMouseMove\n      }, React.createElement(Table, {\n        columns: columns,\n        hideColumnIndicators: hideColumnIndicators\n      }, React.createElement(\"tr\", null, !hideRowIndicators && !hideColumnIndicators && React.createElement(\"th\", null), !hideColumnIndicators && range(columns).map(function (columnNumber) {\n        return columnLabels ? React.createElement(ColumnIndicator, {\n          key: columnNumber,\n          column: columnNumber,\n          label: columnNumber in columnLabels ? columnLabels[columnNumber] : null\n        }) : React.createElement(ColumnIndicator, {\n          key: columnNumber,\n          column: columnNumber\n        });\n      })), range(rows).map(function (rowNumber) {\n        return React.createElement(Row, {\n          key: rowNumber\n        }, !hideRowIndicators && (rowLabels ? React.createElement(RowIndicator, {\n          key: rowNumber,\n          row: rowNumber,\n          label: rowNumber in rowLabels ? rowLabels[rowNumber] : null\n        }) : React.createElement(RowIndicator, {\n          key: rowNumber,\n          row: rowNumber\n        })), range(columns).map(function (columnNumber) {\n          return React.createElement(Cell, {\n            key: columnNumber,\n            row: rowNumber,\n            column: columnNumber,\n            DataViewer: DataViewer,\n            getValue: getValue,\n            formulaParser: _this2.formulaParser\n          });\n        }));\n      })), React.createElement(ActiveCell, {\n        DataEditor: DataEditor,\n        getValue: getValue,\n        getBindingsForCell: getBindingsForCell\n      }), React.createElement(Selected, null), React.createElement(Copied, null));\n    }\n  }]);\n\n  return Spreadsheet;\n}(PureComponent);\n\nSpreadsheet.defaultProps = {\n  Table: Table,\n  Row: Row,\n\n  /** @todo enhance incoming Cell prop */\n  Cell: enhanceCell(Cell),\n  DataViewer: DataViewer,\n  DataEditor: DataEditor,\n  getValue: getValue,\n  getBindingsForCell: getBindingsForCell\n};\n\nvar mapStateToProps = function mapStateToProps(_ref5, _ref6) {\n  var data = _ref5.data,\n      mode = _ref5.mode;\n  var columnLabels = _ref6.columnLabels;\n\n  var _Matrix$getSize = Matrix.getSize(data),\n      columns = _Matrix$getSize.columns,\n      rows = _Matrix$getSize.rows;\n\n  return {\n    mode: mode,\n    rows: rows,\n    columns: columnLabels ? Math.max(columns, columnLabels.length) : columns\n  };\n};\n\nexport default connect(mapStateToProps, {\n  copy: Actions.copy,\n  cut: Actions.cut,\n  paste: Actions.paste,\n  onKeyDownAction: Actions.keyDown,\n  onKeyPress: Actions.keyPress,\n  onDragStart: Actions.dragStart,\n  onDragEnd: Actions.dragEnd\n})(Spreadsheet);","map":{"version":3,"sources":["C:/Users/pjk14/Desktop/Gradely/gradely-react-redux/node_modules/react-spreadsheet/dist/Spreadsheet.js"],"names":["_regeneratorRuntime","_asyncToGenerator","_objectSpread","_classCallCheck","_createClass","_possibleConstructorReturn","_getPrototypeOf","_inherits","React","PureComponent","connect","Parser","FormulaParser","columnIndexToLabel","Types","Table","Row","Cell","enhance","enhanceCell","DataViewer","DataEditor","ActiveCell","Selected","Copied","getBindingsForCell","range","readTextFromClipboard","writeTextToClipboard","PointSet","Matrix","Actions","getValue","_ref","data","value","DefaultColumnIndicator","_ref2","column","label","undefined","createElement","DefaultRowIndicator","_ref3","row","Spreadsheet","_PureComponent","_getPrototypeOf2","_this","_len","arguments","length","args","Array","_key","call","apply","concat","formulaParser","props","clip","event","_this$props","store","_store$getState","getState","selected","startPoint","min","endPoint","max","slicedMatrix","slice","valueMatrix","map","point","csv","join","handleCopy","isFocused","preventDefault","stopPropagation","copy","handlePaste","_ref4","mark","_callee","_text","wrap","_callee$","_context","prev","next","mode","clipboardData","paste","stop","_x","handleCut","cut","handleKeyDown","_this$props2","onKeyDown","onKeyDownAction","defaultPrevented","getKeyDownHandler","nativeEvent","handleMouseUp","onDragEnd","document","removeEventListener","handleMouseMove","dragging","buttons","onDragStart","addEventListener","handleRoot","root","key","_document","activeElement","contains","componentWillUnmount","componentDidMount","on","cellCoord","done","cell","get","index","error","console","startCellCoord","endCellCoord","values","toArray","render","_this2","_this$props3","columnLabels","rowLabels","rows","columns","onKeyPress","hideColumnIndicators","hideRowIndicators","ColumnIndicator","RowIndicator","ref","className","onMouseMove","columnNumber","rowNumber","defaultProps","mapStateToProps","_ref5","_ref6","_Matrix$getSize","getSize","Math","keyDown","keyPress","dragStart","dragEnd"],"mappings":"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","sourcesContent":["import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _objectSpread from \"@babel/runtime/helpers/esm/objectSpread\";\nimport _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"@babel/runtime/helpers/esm/inherits\";\nimport React, { PureComponent } from \"react\";\nimport { connect } from \"unistore/react\"; // $FlowFixMe\n\nimport { Parser as FormulaParser, columnIndexToLabel } from \"hot-formula-parser\";\nimport * as Types from \"./types\";\nimport Table from \"./Table\";\nimport Row from \"./Row\";\nimport { Cell, enhance as enhanceCell } from \"./Cell\";\nimport DataViewer from \"./DataViewer\";\nimport DataEditor from \"./DataEditor\";\nimport ActiveCell from \"./ActiveCell\";\nimport Selected from \"./Selected\";\nimport Copied from \"./Copied\";\nimport { getBindingsForCell } from \"./bindings\";\nimport { range, readTextFromClipboard, writeTextToClipboard } from \"./util\";\nimport * as PointSet from \"./point-set\";\nimport * as Matrix from \"./matrix\";\nimport * as Actions from \"./actions\";\nimport \"./Spreadsheet.css\";\n\nvar getValue = function getValue(_ref) {\n  var data = _ref.data;\n  return data ? data.value : null;\n};\n\nvar DefaultColumnIndicator = function DefaultColumnIndicator(_ref2) {\n  var column = _ref2.column,\n      label = _ref2.label;\n  return label !== undefined ? React.createElement(\"th\", null, label) : React.createElement(\"th\", null, columnIndexToLabel(column));\n};\n\nvar DefaultRowIndicator = function DefaultRowIndicator(_ref3) {\n  var row = _ref3.row,\n      label = _ref3.label;\n  return label !== undefined ? React.createElement(\"th\", null, label) : React.createElement(\"th\", null, row + 1);\n};\n\nvar Spreadsheet = /*#__PURE__*/function (_PureComponent) {\n  _inherits(Spreadsheet, _PureComponent);\n\n  function Spreadsheet() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, Spreadsheet);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(Spreadsheet)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.formulaParser = _this.props.formulaParser || new FormulaParser();\n\n    _this.clip = function (event) {\n      var _this$props = _this.props,\n          store = _this$props.store,\n          getValue = _this$props.getValue;\n\n      var _store$getState = store.getState(),\n          data = _store$getState.data,\n          selected = _store$getState.selected;\n\n      var startPoint = PointSet.min(selected);\n      var endPoint = PointSet.max(selected);\n      var slicedMatrix = Matrix.slice(startPoint, endPoint, data);\n      var valueMatrix = Matrix.map(function (value, point) {\n        // Slice makes non-existing cells undefined, empty cells are classically\n        // translated to an empty string in join()\n        if (value === undefined) {\n          return \"\";\n        }\n\n        return getValue(_objectSpread({}, point, {\n          data: value\n        }));\n      }, slicedMatrix);\n      var csv = Matrix.join(valueMatrix);\n      writeTextToClipboard(event, csv);\n    };\n\n    _this.handleCopy = function (event) {\n      if (_this.isFocused()) {\n        event.preventDefault();\n        event.stopPropagation();\n\n        _this.clip(event);\n\n        _this.props.copy();\n      }\n    };\n\n    _this.handlePaste = /*#__PURE__*/function () {\n      var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(event) {\n        var _text;\n\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                if (_this.props.mode === \"view\" && _this.isFocused()) {\n                  event.preventDefault();\n                  event.stopPropagation();\n\n                  if (event.clipboardData) {\n                    _text = readTextFromClipboard(event);\n\n                    _this.props.paste(_text);\n                  }\n                }\n\n              case 1:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n\n      return function (_x) {\n        return _ref4.apply(this, arguments);\n      };\n    }();\n\n    _this.handleCut = function (event) {\n      if (_this.isFocused()) {\n        event.preventDefault();\n        event.stopPropagation();\n\n        _this.clip(event);\n\n        _this.props.cut();\n      }\n    };\n\n    _this.handleKeyDown = function (event) {\n      var _this$props2 = _this.props,\n          store = _this$props2.store,\n          onKeyDown = _this$props2.onKeyDown,\n          onKeyDownAction = _this$props2.onKeyDownAction;\n\n      if (onKeyDown) {\n        onKeyDown(event);\n      } // Do not use event in case preventDefault() was called inside onKeyDown\n\n\n      if (!event.defaultPrevented) {\n        // Only disable default behavior if an handler exist\n        if (Actions.getKeyDownHandler(store.getState(), event)) {\n          event.nativeEvent.preventDefault();\n        }\n\n        onKeyDownAction(event);\n      }\n    };\n\n    _this.handleMouseUp = function () {\n      _this.props.onDragEnd();\n\n      document.removeEventListener(\"mouseup\", _this.handleMouseUp);\n    };\n\n    _this.handleMouseMove = function (event) {\n      if (!_this.props.store.getState().dragging && event.buttons === 1) {\n        _this.props.onDragStart();\n\n        document.addEventListener(\"mouseup\", _this.handleMouseUp);\n      }\n    };\n\n    _this.handleRoot = function (root) {\n      _this.root = root;\n    };\n\n    return _this;\n  }\n\n  _createClass(Spreadsheet, [{\n    key: \"isFocused\",\n    value: function isFocused() {\n      var _document = document,\n          activeElement = _document.activeElement;\n      return this.props.mode === \"view\" && this.root ? this.root === activeElement || this.root.contains(activeElement) : false;\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      document.removeEventListener(\"cut\", this.handleCut);\n      document.removeEventListener(\"copy\", this.handleCopy);\n      document.removeEventListener(\"paste\", this.handlePaste);\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var store = this.props.store;\n      document.addEventListener(\"cut\", this.handleCut);\n      document.addEventListener(\"copy\", this.handleCopy);\n      document.addEventListener(\"paste\", this.handlePaste);\n      this.formulaParser.on(\"callCellValue\", function (cellCoord, done) {\n        var value;\n        /** @todo More sound error, or at least document */\n\n        try {\n          var cell = Matrix.get(cellCoord.row.index, cellCoord.column.index, store.getState().data);\n          value = getValue({\n            data: cell\n          });\n        } catch (error) {\n          console.error(error);\n        } finally {\n          done(value);\n        }\n      });\n      this.formulaParser.on(\"callRangeValue\", function (startCellCoord, endCellCoord, done) {\n        var startPoint = {\n          row: startCellCoord.row.index,\n          column: startCellCoord.column.index\n        };\n        var endPoint = {\n          row: endCellCoord.row.index,\n          column: endCellCoord.column.index\n        };\n        var values = Matrix.toArray(Matrix.slice(startPoint, endPoint, store.getState().data)).map(function (cell) {\n          return getValue({\n            data: cell\n          });\n        });\n        done(values);\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var _this$props3 = this.props,\n          Table = _this$props3.Table,\n          Row = _this$props3.Row,\n          Cell = _this$props3.Cell,\n          columnLabels = _this$props3.columnLabels,\n          rowLabels = _this$props3.rowLabels,\n          DataViewer = _this$props3.DataViewer,\n          getValue = _this$props3.getValue,\n          rows = _this$props3.rows,\n          columns = _this$props3.columns,\n          onKeyPress = _this$props3.onKeyPress,\n          getBindingsForCell = _this$props3.getBindingsForCell,\n          hideColumnIndicators = _this$props3.hideColumnIndicators,\n          hideRowIndicators = _this$props3.hideRowIndicators;\n      var ColumnIndicator = this.props.ColumnIndicator || DefaultColumnIndicator;\n      var RowIndicator = this.props.RowIndicator || DefaultRowIndicator;\n      return React.createElement(\"div\", {\n        ref: this.handleRoot,\n        className: \"Spreadsheet\",\n        onKeyPress: onKeyPress,\n        onKeyDown: this.handleKeyDown,\n        onMouseMove: this.handleMouseMove\n      }, React.createElement(Table, {\n        columns: columns,\n        hideColumnIndicators: hideColumnIndicators\n      }, React.createElement(\"tr\", null, !hideRowIndicators && !hideColumnIndicators && React.createElement(\"th\", null), !hideColumnIndicators && range(columns).map(function (columnNumber) {\n        return columnLabels ? React.createElement(ColumnIndicator, {\n          key: columnNumber,\n          column: columnNumber,\n          label: columnNumber in columnLabels ? columnLabels[columnNumber] : null\n        }) : React.createElement(ColumnIndicator, {\n          key: columnNumber,\n          column: columnNumber\n        });\n      })), range(rows).map(function (rowNumber) {\n        return React.createElement(Row, {\n          key: rowNumber\n        }, !hideRowIndicators && (rowLabels ? React.createElement(RowIndicator, {\n          key: rowNumber,\n          row: rowNumber,\n          label: rowNumber in rowLabels ? rowLabels[rowNumber] : null\n        }) : React.createElement(RowIndicator, {\n          key: rowNumber,\n          row: rowNumber\n        })), range(columns).map(function (columnNumber) {\n          return React.createElement(Cell, {\n            key: columnNumber,\n            row: rowNumber,\n            column: columnNumber,\n            DataViewer: DataViewer,\n            getValue: getValue,\n            formulaParser: _this2.formulaParser\n          });\n        }));\n      })), React.createElement(ActiveCell, {\n        DataEditor: DataEditor,\n        getValue: getValue,\n        getBindingsForCell: getBindingsForCell\n      }), React.createElement(Selected, null), React.createElement(Copied, null));\n    }\n  }]);\n\n  return Spreadsheet;\n}(PureComponent);\n\nSpreadsheet.defaultProps = {\n  Table: Table,\n  Row: Row,\n\n  /** @todo enhance incoming Cell prop */\n  Cell: enhanceCell(Cell),\n  DataViewer: DataViewer,\n  DataEditor: DataEditor,\n  getValue: getValue,\n  getBindingsForCell: getBindingsForCell\n};\n\nvar mapStateToProps = function mapStateToProps(_ref5, _ref6) {\n  var data = _ref5.data,\n      mode = _ref5.mode;\n  var columnLabels = _ref6.columnLabels;\n\n  var _Matrix$getSize = Matrix.getSize(data),\n      columns = _Matrix$getSize.columns,\n      rows = _Matrix$getSize.rows;\n\n  return {\n    mode: mode,\n    rows: rows,\n    columns: columnLabels ? Math.max(columns, columnLabels.length) : columns\n  };\n};\n\nexport default connect(mapStateToProps, {\n  copy: Actions.copy,\n  cut: Actions.cut,\n  paste: Actions.paste,\n  onKeyDownAction: Actions.keyDown,\n  onKeyPress: Actions.keyPress,\n  onDragStart: Actions.dragStart,\n  onDragEnd: Actions.dragEnd\n})(Spreadsheet);"]},"metadata":{},"sourceType":"module"}